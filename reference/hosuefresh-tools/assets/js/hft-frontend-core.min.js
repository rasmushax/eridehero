window.HFT_Frontend=window.HFT_Frontend||{},function(e){"use strict";const t=!1,o="hft_geo_cache_v1.0";function n(...e){t}e.detectUserGeo=async function(){const e="US";n();try{const e=localStorage.getItem(o);if(e){const t=JSON.parse(e);if(t.expires&&t.expires>Date.now()&&t.geo)return n((t.geo,new Date(t.expires).toLocaleString())),t.geo.toUpperCase();n(),localStorage.removeItem(o)}else n()}catch(e){n()}if(n(),"undefined"==typeof hft_frontend_data||void 0===hft_frontend_data.rest_url)return n(),e;let t=hft_frontend_data.rest_url+"housefresh-tools/v1/detect-geo";try{const r=await fetch(t);if(!r.ok)throw new Error(`GEO API (WP) response not OK: ${r.status}`);const a=await r.json();n();let c=e;a&&a.country_code&&/^[A-Z]{2}$/.test(a.country_code)?(c=a.country_code.toUpperCase(),n()):n();try{const e={geo:c,expires:Date.now()+216e5,cached_at:Date.now()};localStorage.setItem(o,JSON.stringify(e)),n()}catch(e){n()}return c}catch(t){return n(),e}},e.clearGeoCache=function(){try{const e=null!==localStorage.getItem(o);return localStorage.removeItem(o),e?(n(),!0):(n(),!1)}catch(e){return n(),!1}},e.getGeoCacheInfo=function(){try{const e=localStorage.getItem(o);if(e){const t=JSON.parse(e);return{geo:t.geo,cached_at:new Date(t.cached_at).toLocaleString(),expires:new Date(t.expires).toLocaleString(),is_expired:t.expires<=Date.now(),time_remaining:Math.max(0,t.expires-Date.now())}}return null}catch(e){return n(),null}}}(window.HFT_Frontend);