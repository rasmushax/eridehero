/* =============================================
   Finder Table View
   Full-width table with dynamic columns
   ============================================= */

/* ===== TABLE VIEW LAYOUT ===== */

/* Full-width container for table view */
[data-finder-page][data-view="table"] .finder-section > .container {
    max-width: none;
    padding: 0 var(--space-6);
}

/* When in table view, hide sidebar and make content full-width */
[data-finder-page][data-view="table"] .finder-sidebar {
    display: none;
}

[data-finder-page][data-view="table"] .finder-layout {
    grid-template-columns: 1fr;
}

[data-finder-page][data-view="table"] .finder-grid {
    display: none;
}

[data-finder-page][data-view="table"] .finder-load-more {
    display: none;
}

/* Hide grid empty state in table view - table has its own empty message */
[data-finder-page][data-view="table"] .finder-empty {
    display: none;
}

/* Hide entire view toggle on mobile - tables don't work on small screens,
   so showing a single-option toggle is pointless */
@media (max-width: 900px) {
    .finder-toolbar .view-toggle {
        display: none;
    }

    /* Force grid view on mobile, even if table was selected on desktop */
    [data-finder-page][data-view="table"] .finder-sidebar {
        display: block;
    }

    [data-finder-page][data-view="table"] .finder-grid {
        display: grid;
    }

    [data-finder-page][data-view="table"] .finder-table-view {
        display: none !important;
    }

    [data-finder-page][data-view="table"] .finder-load-more {
        display: flex;
    }
}


/* ===== TABLE VIEW CONTAINER ===== */

.finder-table-view {
    display: none;
}

.finder-table-view:not([hidden]) {
    display: block;
}


/* ===== TABLE FILTERS ROW (Filter cards + Add Column button) ===== */

.finder-table-filters {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
    gap: var(--space-4);
    margin-bottom: var(--space-5);
}

/* Add Column button - styled to match filter cards */
.finder-add-column-btn {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: var(--space-2);
    min-height: 100px;
    font-family: var(--font-family);
    font-size: var(--text-sm);
    font-weight: var(--font-medium);
    color: var(--color-muted);
    background: var(--color-background);
    border: 2px dashed var(--color-border);
    border-radius: var(--radius-md);
    cursor: pointer;
    transition: all var(--transition-fast);
}

.finder-add-column-btn:hover {
    color: var(--color-primary);
    border-color: var(--color-primary);
    background: var(--color-primary-subtle);
}

.finder-add-column-btn .icon {
    width: 18px;
    height: 18px;
}


/* ===== FILTER CARDS ===== */

.filter-card {
    display: flex;
    flex-direction: column;
    background: var(--color-white);
    border: var(--border-width) solid var(--color-border);
    border-radius: var(--radius-md);
    overflow: visible; /* Allow dropdowns to overflow */
}

.filter-card-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: var(--space-2);
    padding: var(--space-2) var(--space-3);
    background: var(--color-background);
    border-bottom: var(--border-width) solid var(--color-border);
}

.filter-card-label {
    font-size: var(--text-xs);
    font-weight: var(--font-semibold);
    color: var(--color-muted);
    text-transform: uppercase;
    letter-spacing: 0.3px;
}

.filter-card-remove {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 18px;
    height: 18px;
    padding: 0;
    background: transparent;
    border: none;
    border-radius: var(--radius-sm);
    cursor: pointer;
    opacity: 0.5;
    transition: all var(--transition-fast);
}

.filter-card-remove:hover {
    opacity: 1;
    background: var(--color-border);
}

.filter-card-remove .icon {
    width: 12px;
    height: 12px;
    color: var(--color-muted);
}

/* Card body - contains standard filter components */
.filter-card-body {
    padding: var(--space-3);
}

/* No filter/data indicators */
.filter-card-no-filter,
.filter-card-no-data,
.filter-card-display-only {
    font-size: var(--text-xs);
    color: var(--color-muted);
    font-style: italic;
}

/* Filter card search input */
.filter-card-search {
    display: flex;
    align-items: center;
    gap: var(--space-2);
    padding: var(--space-2);
    margin-bottom: var(--space-2);
    background: var(--color-background);
    border: var(--border-width) solid var(--color-border);
    border-radius: var(--radius-sm);
    transition: all var(--transition-fast);
}

.filter-card-search:focus-within {
    border-color: var(--color-primary);
    background: var(--color-white);
}

.filter-card-search .icon {
    width: 14px;
    height: 14px;
    color: var(--color-muted);
    flex-shrink: 0;
}

.filter-card-search input {
    flex: 1;
    min-width: 0;
    border: none;
    background: transparent;
    font-family: var(--font-family);
    font-size: var(--text-xs);
    color: var(--color-dark);
    outline: none;
}

.filter-card-search input::placeholder {
    color: var(--color-muted);
}

.filter-card-search-clear {
    display: none;
    align-items: center;
    justify-content: center;
    padding: 0;
    background: transparent;
    border: none;
    cursor: pointer;
    opacity: 0.5;
    transition: opacity var(--transition-fast);
}

.filter-card-search:has(input:not(:placeholder-shown)) .filter-card-search-clear {
    display: flex;
}

.filter-card-search-clear:hover {
    opacity: 1;
}

.filter-card-search-clear .icon {
    width: 12px;
    height: 12px;
}


/* ===== FILTER COMPONENTS INSIDE CARDS ===== */
/* Compact overrides for standard filter styles when inside filter cards */

/* Range filter adjustments */
.filter-card-body .filter-range {
    gap: var(--space-2);
}

.filter-card-body .filter-range-distribution {
    height: 24px;
    margin-bottom: -14px;
}

.filter-card-body .filter-range-slider {
    height: 20px;
}

.filter-card-body .filter-range-handle {
    width: 16px;
    height: 16px;
}

.filter-card-body .filter-range-input-group {
    padding: var(--space-2);
}

.filter-card-body .filter-range-input {
    font-size: var(--text-xs);
}

/* Presets - more compact in cards */
.filter-card-body .filter-presets {
    gap: var(--space-1);
    margin-top: var(--space-2);
    padding-top: var(--space-2);
    border-top: var(--border-width) solid var(--color-border);
}

.filter-card-body .filter-preset {
    gap: var(--space-2);
}

.filter-card-body .filter-preset-radio {
    width: 14px;
    height: 14px;
}

.filter-card-body .filter-preset-label,
.filter-card-body .filter-preset-count {
    font-size: 10px;
}

/* Checkbox list adjustments */
.filter-card-body .filter-checkbox-list {
    gap: var(--space-1);
    max-height: 180px;
    overflow-y: auto;
}

.filter-card-body .filter-checkbox {
    gap: var(--space-2);
}

.filter-card-body .filter-checkbox-box {
    width: 16px;
    height: 16px;
}

.filter-card-body .filter-checkbox-box .icon {
    width: 10px;
    height: 10px;
}

.filter-card-body .filter-checkbox-label {
    font-size: var(--text-xs);
}

.filter-card-body .filter-checkbox-count {
    font-size: 10px;
}

.filter-card-body .filter-show-all {
    font-size: var(--text-xs);
    padding: var(--space-1) 0;
    margin-top: var(--space-1);
}

.filter-card-body .filter-show-all .icon {
    width: 12px;
    height: 12px;
}

/* Tristate adjustments */
.filter-card-body .filter-tristate {
    padding: 0;
    justify-content: center;
}

.filter-card-body .filter-tristate-control {
    width: 100%;
}

.filter-card-body .filter-tristate-btn {
    flex: 1;
    padding: var(--space-2);
    font-size: var(--text-xs);
}

/* Hide presets in table filter cards - keep it simple */
.filter-card-body .filter-presets {
    display: none;
}


/* ===== PORTALED ELEMENTS ===== */
/* Sidebar elements moved to filter cards via portal system */

/* Reset sidebar-specific wrapper styles when portaled */
.filter-item-content.is-portaled,
.filter-group-content.is-portaled {
    display: block !important; /* Override collapsed state from sidebar */
    padding: 0;
    margin: 0;
    border: none;
    background: transparent;
}

/* Hide the empty group shell in sidebar when content is portaled to table */
[data-filter-group].has-portaled-content {
    display: none;
}


/* ===== TABLE CONTAINER ===== */

.finder-table-container {
    background: var(--color-white);
    border: var(--border-width) solid var(--color-border);
    border-radius: var(--radius-lg);
    overflow-x: auto;
    /* Smooth scrolling on iOS */
    -webkit-overflow-scrolling: touch;
}

/* Custom scrollbar */
.finder-table-container::-webkit-scrollbar {
    height: 8px;
}

.finder-table-container::-webkit-scrollbar-track {
    background: var(--color-background);
    border-radius: 4px;
}

.finder-table-container::-webkit-scrollbar-thumb {
    background: var(--color-border-hover);
    border-radius: 4px;
}

.finder-table-container::-webkit-scrollbar-thumb:hover {
    background: var(--color-muted);
}


/* ===== TABLE STYLES ===== */

.finder-table {
    width: 100%;
    border-collapse: collapse;
    font-size: var(--text-sm);
    min-width: 800px; /* Minimum width for horizontal scrolling */
}

/* Table Header */
.finder-table thead {
    position: sticky;
    top: 0;
    z-index: 5;
}

.finder-table th {
    background: var(--color-background);
    font-weight: var(--font-semibold);
    font-size: var(--text-xs);
    text-transform: uppercase;
    letter-spacing: 0.5px;
    padding: var(--space-4) var(--space-5);
    text-align: left;
    white-space: nowrap;
    border-bottom: var(--border-width) solid var(--color-border);
    color: var(--color-muted);
    user-select: none;
}

/* Sortable header */
.finder-table th[data-sortable] {
    cursor: pointer;
    transition: color var(--transition-fast);
}

.finder-table th[data-sortable]:hover {
    color: var(--color-dark);
}

.finder-table-sort-icon {
    display: inline-flex;
    margin-left: var(--space-1);
    transition: opacity var(--transition-fast);
}

.finder-table-sort-icon .icon {
    width: 13px;
    height: 13px;
    display: none;
}

.finder-table-sort-icon .icon--neutral {
    display: block;
    opacity: 0.4;
}

.finder-table-sort-icon .icon--desc {
    transform: rotate(180deg);
}

.finder-table th[data-sortable]:hover .finder-table-sort-icon .icon--neutral {
    opacity: 0.7;
}

.finder-table th[data-sort-active] {
    color: var(--color-primary);
}

.finder-table th[data-sort-active] .finder-table-sort-icon .icon--neutral {
    display: none;
}

.finder-table th[data-sort-active="asc"] .finder-table-sort-icon .icon--asc,
.finder-table th[data-sort-active="desc"] .finder-table-sort-icon .icon--desc {
    display: block;
    color: var(--color-primary);
}

/* Table Body */
.finder-table td {
    padding: var(--space-4) var(--space-5);
    border-bottom: var(--border-width) solid var(--color-border);
    white-space: nowrap;
    color: var(--color-body);
    vertical-align: middle;
}

.finder-table tbody tr {
    transition: background var(--transition-fast);
}

.finder-table tbody tr:hover {
    background: var(--color-background);
}

/* Selected row */
.finder-table tbody tr.is-selected {
    background: var(--color-primary-subtle);
}

.finder-table tbody tr.is-selected:hover {
    background: var(--color-primary-light);
}

/* Last row - no bottom border */
.finder-table tbody tr:last-child td {
    border-bottom: none;
}


/* ===== PRODUCT CELL (Fixed First Column) ===== */

/* Sticky first column for product name */
.finder-table th:first-child,
.finder-table td:first-child {
    position: sticky;
    left: 0;
    z-index: 2;
    background: inherit;
    min-width: 250px;
}

.finder-table th:first-child {
    background: var(--color-background);
    z-index: 6; /* Above tbody sticky cells */
}

.finder-table td:first-child {
    background: var(--color-white);
}

.finder-table tbody tr:hover td:first-child {
    background: var(--color-background);
}

.finder-table tbody tr.is-selected td:first-child {
    background: var(--color-primary-subtle);
}

/* Shadow indicator when scrolled */
.finder-table-container.is-scrolled th:first-child,
.finder-table-container.is-scrolled td:first-child {
    box-shadow: 4px 0 8px -2px rgba(33, 39, 58, 0.08);
}

/* Product cell content */
.finder-table-product-cell {
    display: flex;
    align-items: center;
    gap: var(--space-3);
}

/* Product checkbox - matches grid card style */
.finder-table-product-checkbox {
    flex-shrink: 0;
}

.finder-table-product-checkbox input {
    position: absolute;
    opacity: 0;
    width: 0;
    height: 0;
}

.finder-table-product-checkbox-box {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 22px;
    height: 22px;
    background: var(--color-white);
    border: 1px solid var(--color-border-hover);
    border-radius: 5px;
    cursor: pointer;
    transition: all var(--transition-fast);
}

.finder-table-product-checkbox-box .icon {
    width: 14px;
    height: 14px;
    color: var(--color-white);
    opacity: 0;
    transform: scale(0.5);
    transition: all var(--transition-fast);
}

.finder-table-product-checkbox:hover .finder-table-product-checkbox-box {
    border-color: var(--color-primary);
}

.finder-table-product-checkbox input:checked + .finder-table-product-checkbox-box {
    background: var(--color-primary);
    border-color: var(--color-primary);
}

.finder-table-product-checkbox input:checked + .finder-table-product-checkbox-box .icon {
    opacity: 1;
    transform: scale(1);
}

/* Product image with overlay */
.finder-table-product-img-wrap {
    position: relative;
    width: 48px;
    height: 48px;
    flex-shrink: 0;
    border-radius: var(--radius-sm);
    overflow: hidden;
    padding: 3px;
}

.finder-table-product-img-wrap::after {
    content: "";
    display: block;
    position: absolute;
    inset: 0;
    background: var(--color-overlay-light);
    border-radius: inherit;
    pointer-events: none;
}

.finder-table-product-img {
    width: 100%;
    height: 100%;
    object-fit: contain;
}

.finder-table-product-name {
    font-weight: var(--font-medium);
    color: var(--color-dark);
    text-decoration: none;
    transition: color var(--transition-fast);
}

.finder-table-product-name:hover {
    color: var(--color-primary);
}


/* ===== CELL TYPE STYLES ===== */

/* Empty value */
.finder-table-cell--empty {
    color: var(--color-muted);
    opacity: 0.5;
}

/* Price cell */
.finder-table-cell--price {
    display: inline-flex;
    align-items: center;
    gap: var(--space-2);
    font-weight: var(--font-semibold);
    color: var(--color-dark);
}

/* Price indicator (above/below average) - matches grid card style */
.finder-table-indicator {
    display: inline-flex;
    align-items: center;
    gap: 2px;
    padding: 2px var(--space-2);
    font-size: var(--text-xs);
    font-weight: var(--font-semibold);
    border-radius: var(--radius-sm);
}

.finder-table-indicator-arrow {
    font-weight: var(--font-bold);
}

.finder-table-indicator--below {
    background: var(--color-success-light);
    color: var(--color-success);
}

.finder-table-indicator--above {
    background: var(--color-error-light);
    color: var(--color-error);
}

/* Rating cell */
.finder-table-cell--rating {
    font-weight: var(--font-semibold);
}

.finder-table-rating {
    display: inline-flex;
    align-items: center;
    gap: var(--space-1);
    padding: var(--space-1) var(--space-2);
    border-radius: var(--radius-sm);
    font-size: var(--text-xs);
}

.finder-table-rating--excellent {
    background: var(--color-success-light);
    color: var(--color-success);
}

.finder-table-rating--good {
    background: rgba(132, 204, 22, 0.1);
    color: #65a30d;
}

.finder-table-rating--average {
    background: rgba(234, 179, 8, 0.1);
    color: #ca8a04;
}

.finder-table-rating--poor {
    background: var(--color-error-light);
    color: var(--color-error);
}

/* Boolean cell */
.finder-table-cell--boolean {
    text-align: center;
}

.finder-table-bool {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    width: 20px;
    height: 20px;
    border-radius: 50%;
}

.finder-table-bool--yes {
    background: var(--color-success-light);
    color: var(--color-success);
}

.finder-table-bool--no {
    background: var(--color-error-light);
    color: var(--color-error);
}

.finder-table-bool .icon {
    width: 12px;
    height: 12px;
}

/* Array cell (e.g., suspension type) */
.finder-table-cell--array {
    max-width: 200px;
    overflow: hidden;
    text-overflow: ellipsis;
}


/* ===== TABLE FOOTER ===== */

.finder-table-footer {
    display: flex;
    justify-content: center;
    padding: var(--space-6) 0;
}

.finder-table-footer[hidden] {
    display: none;
}


/* ===== COLUMN SELECTOR MODAL CONTENT ===== */
/* Uses standard modal system - these are just the content-specific styles */

/* Column search - inside modal body */
.finder-columns-search {
    display: flex;
    align-items: center;
    gap: var(--space-3);
    margin-bottom: var(--space-5);
    padding: var(--space-3) var(--space-4);
    background: var(--color-background);
    border: var(--border-width) solid var(--color-border);
    border-radius: var(--radius-md);
    transition: all var(--transition-fast);
}

.finder-columns-search:focus-within {
    border-color: var(--color-primary);
    background: var(--color-white);
}

.finder-columns-search .icon {
    width: 18px;
    height: 18px;
    color: var(--color-muted);
    flex-shrink: 0;
}

.finder-columns-search input {
    flex: 1;
    border: none;
    background: transparent;
    font-family: var(--font-family);
    font-size: var(--text-base);
    color: var(--color-dark);
    outline: none;
}

.finder-columns-search input::placeholder {
    color: var(--color-muted);
}

/* Column groups container */
.finder-columns-groups {
    max-height: 400px;
    overflow-y: auto;
}

/* Individual group */
.finder-columns-group {
    margin-bottom: var(--space-5);
}

.finder-columns-group:last-child {
    margin-bottom: 0;
}

.finder-columns-group[hidden] {
    display: none;
}

.finder-columns-group h4 {
    font-size: var(--text-sm);
    font-weight: var(--font-semibold);
    color: var(--color-muted);
    text-transform: uppercase;
    letter-spacing: 0.5px;
    margin: 0 0 var(--space-3);
    padding-bottom: var(--space-2);
    border-bottom: var(--border-width) solid var(--color-border);
}

/* Column options grid */
.finder-columns-options {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: var(--space-2);
}

/* Individual column option - styled checkbox */
.finder-columns-option {
    display: flex;
    align-items: center;
    gap: var(--space-3);
    padding: var(--space-2) var(--space-3);
    border-radius: var(--radius-md);
    cursor: pointer;
    transition: background var(--transition-fast);
}

.finder-columns-option:hover {
    background: var(--color-background);
}

.finder-columns-option[hidden] {
    display: none;
}

.finder-columns-option input {
    position: absolute;
    opacity: 0;
    width: 0;
    height: 0;
}

.finder-columns-option-box {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 20px;
    height: 20px;
    background: var(--color-white);
    border: var(--border-width) solid var(--color-border-hover);
    border-radius: var(--radius-sm);
    flex-shrink: 0;
    transition: all var(--transition-fast);
}

.finder-columns-option-box .icon {
    width: 12px;
    height: 12px;
    color: var(--color-white);
    opacity: 0;
    transform: scale(0.5);
    transition: all var(--transition-fast);
}

.finder-columns-option:hover .finder-columns-option-box {
    border-color: var(--color-primary);
}

.finder-columns-option input:checked + .finder-columns-option-box {
    background: var(--color-primary);
    border-color: var(--color-primary);
}

.finder-columns-option input:checked + .finder-columns-option-box .icon {
    opacity: 1;
    transform: scale(1);
}

.finder-columns-option-label {
    font-size: var(--text-sm);
    color: var(--color-body);
}

.finder-columns-option input:checked ~ .finder-columns-option-label {
    color: var(--color-dark);
    font-weight: var(--font-medium);
}

/* No results in search */
.finder-columns-empty {
    text-align: center;
    padding: var(--space-8);
    color: var(--color-muted);
    font-size: var(--text-sm);
}

.finder-columns-empty[hidden] {
    display: none;
}


/* ===== RESPONSIVE ===== */

@media (max-width: 600px) {
    .finder-columns-options {
        grid-template-columns: 1fr;
    }
}
