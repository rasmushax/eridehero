var ta=Object.defineProperty;var Ms=r=>e=>{var t=r[e];if(t)return t();throw new Error("Module not found in bundle: "+e)};var P=(r,e)=>()=>(r&&(e=r(r=0)),e);var j=(r,e)=>{for(var t in e)ta(r,t,{get:e[t],enumerable:!0})};async function bt(){if(Wt)return Wt;if(nt)return nt;let r=window.erhData?.searchJsonUrl;return r?(nt=fetch(r).then(e=>{if(!e.ok)throw new Error(`Failed to load search data: ${e.status}`);return e.json()}).then(e=>(Wt=e,nt=null,Wt)).catch(e=>(console.error("[Search] Failed to load search data:",e),nt=null,[])),nt):(console.warn("[Search] searchJsonUrl not configured"),[])}async function wt(r){let e=await bt();if(!r||r.length<2)return[];let s=r.toLowerCase().trim().split(/\s+/).filter(i=>i.length>0);return e.filter(i=>{let n=i.title.toLowerCase();return s.every(o=>n.includes(o))})}function zt(r){switch(r.type||"Article"){case"Product":return{label:r.product_type||"Product"};case"Tool":return{label:"Tool"};default:return{label:"Article"}}}var Wt,nt,Ir=P(()=>{Wt=null,nt=null});function qe(r){let e=document.createElement("div");return e.textContent=r,e.innerHTML}function _s(r){return r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}var Dr=P(()=>{});var St,Us=P(()=>{St=class r{static backdrop=null;static activeDrawer=null;static MOBILE_BREAKPOINT=600;static SEARCH_THRESHOLD=8;static shouldUseDrawer(){return window.innerWidth<r.MOBILE_BREAKPOINT}static getBackdrop(){return r.backdrop||(r.backdrop=document.createElement("div"),r.backdrop.className="select-drawer-backdrop",r.backdrop.addEventListener("click",()=>{r.activeDrawer&&r.activeDrawer.close()})),r.backdrop}static showBackdrop(){let e=r.getBackdrop();e.parentNode||document.body.appendChild(e),e.offsetHeight,e.classList.add("is-visible")}static hideBackdrop(){r.getBackdrop().classList.remove("is-visible")}constructor(e,t={}){this.customSelect=e,this.select=e.select,this.options={searchThreshold:r.SEARCH_THRESHOLD,searchPlaceholder:"Search...",...t},this.isOpen=!1,this.drawerElement=null,this.optionsContainer=null,this.searchInput=null,this.emptyState=null,this.focusedIndex=-1,this.optionButtons=[],this.boundHandleKeydown=this.handleKeydown.bind(this),this.boundHandleResize=this.handleResize.bind(this),this.touchStartY=0,this.touchCurrentY=0,this.isSwiping=!1}open(){this.isOpen||(r.activeDrawer&&r.activeDrawer!==this&&r.activeDrawer.close(),this.drawerElement||this.createDrawer(),this.renderOptions(),this.isOpen=!0,r.activeDrawer=this,r.showBackdrop(),document.body.appendChild(this.drawerElement),this.drawerElement.style.transform="",this.drawerElement.offsetHeight,this.drawerElement.classList.add("is-visible"),this.lockBodyScroll(),document.addEventListener("keydown",this.boundHandleKeydown),window.addEventListener("resize",this.boundHandleResize),requestAnimationFrame(()=>{this.setInitialFocus()}))}close(){this.isOpen&&(this.isOpen=!1,r.activeDrawer=null,this.drawerElement.classList.remove("is-visible"),r.hideBackdrop(),this.unlockBodyScroll(),document.removeEventListener("keydown",this.boundHandleKeydown),window.removeEventListener("resize",this.boundHandleResize),this.searchInput&&(this.searchInput.value="",this.filterOptions("")),setTimeout(()=>{this.drawerElement?.parentNode&&this.drawerElement.parentNode.removeChild(this.drawerElement)},300),this.customSelect.trigger.focus())}createDrawer(){let e=document.createElement("div");e.className="select-drawer",e.setAttribute("role","dialog"),e.setAttribute("aria-modal","true"),this.select.options.length>this.options.searchThreshold&&e.classList.add("has-search");let i=this.getDrawerTitle(),n=`select-drawer-title-${Math.random().toString(36).substr(2,9)}`;e.setAttribute("aria-labelledby",n),e.innerHTML=`
            <div class="select-drawer-handle" data-drawer-handle></div>
            <div class="select-drawer-header">
                <h2 id="${n}" class="select-drawer-title">${i}</h2>
                <button type="button" class="select-drawer-close" data-drawer-close aria-label="Close">
                    <svg class="icon" aria-hidden="true"><use href="#icon-x"></use></svg>
                </button>
            </div>
            <div class="select-drawer-search">
                <svg class="icon" aria-hidden="true"><use href="#icon-search"></use></svg>
                <input type="text" placeholder="${this.options.searchPlaceholder}" data-drawer-search autocomplete="off">
            </div>
            <div class="select-drawer-options" role="listbox" data-drawer-options></div>
            <div class="select-drawer-empty" data-drawer-empty>No options found</div>
        `,this.drawerElement=e,this.optionsContainer=e.querySelector("[data-drawer-options]"),this.searchInput=e.querySelector("[data-drawer-search]"),this.emptyState=e.querySelector("[data-drawer-empty]"),this.bindDrawerEvents()}getDrawerTitle(){let e=this.select.dataset.drawerTitle;if(e)return e;let t=this.select.id;if(t){let s=document.querySelector(`label[for="${t}"]`);if(s)return s.textContent.trim()}return"Select option"}renderOptions(){this.optionsContainer.innerHTML="",this.optionButtons=[],this.focusedIndex=-1;let e=Array.from(this.select.options),t=0;e.forEach((i,n)=>{if(i.value===""&&n===0)return;let o=document.createElement("button");o.type="button",o.className="select-drawer-option",o.setAttribute("role","option"),o.setAttribute("data-value",i.value),o.setAttribute("aria-selected",i.selected?"true":"false"),o.textContent=i.text,i.disabled&&(o.classList.add("is-disabled"),o.setAttribute("aria-disabled","true")),i.selected&&i.value!==""&&(o.classList.add("is-selected"),this.focusedIndex=t),o.addEventListener("click",()=>{i.disabled||this.selectOption(i.value,i.text)}),this.optionsContainer.appendChild(o),this.optionButtons.push(o),t++});let s=this.optionButtons.length>this.options.searchThreshold;this.drawerElement.classList.toggle("has-search",s)}bindDrawerEvents(){this.drawerElement.querySelector("[data-drawer-close]").addEventListener("click",()=>this.close()),this.searchInput&&this.searchInput.addEventListener("input",s=>{this.filterOptions(s.target.value)});let t=this.drawerElement.querySelector("[data-drawer-handle]");t&&(t.addEventListener("touchstart",s=>this.handleTouchStart(s),{passive:!0}),t.addEventListener("touchmove",s=>this.handleTouchMove(s),{passive:!1}),t.addEventListener("touchend",()=>this.handleTouchEnd()))}filterOptions(e){let t=e.toLowerCase().trim(),s=0;this.optionButtons.forEach(i=>{let n=i.textContent.toLowerCase(),o=t===""||n.includes(t);i.hidden=!o,o&&s++}),this.emptyState.classList.toggle("is-visible",s===0),this.focusedIndex=-1,this.optionButtons.forEach(i=>i.classList.remove("is-focused"))}selectOption(e,t){this.select.value=e;let s=new Event("change",{bubbles:!0});this.select.dispatchEvent(s),this.close()}handleKeydown(e){switch(e.key){case"Escape":e.preventDefault(),this.close();break;case"ArrowDown":e.preventDefault(),this.focusNextOption();break;case"ArrowUp":e.preventDefault(),this.focusPreviousOption();break;case"Enter":case" ":if(document.activeElement===this.searchInput&&e.key===" ")return;if(this.focusedIndex>=0){e.preventDefault();let t=this.getVisibleOptions()[this.focusedIndex];t&&!t.classList.contains("is-disabled")&&t.click()}break;case"Tab":e.preventDefault(),this.searchInput&&document.activeElement!==this.searchInput?this.searchInput.focus():this.drawerElement.querySelector("[data-drawer-close]").focus();break}}getVisibleOptions(){return this.optionButtons.filter(e=>!e.hidden)}focusNextOption(){let e=this.getVisibleOptions();if(e.length===0)return;e.forEach(s=>s.classList.remove("is-focused"));let t=this.focusedIndex+1;for(;t<e.length&&e[t].classList.contains("is-disabled");)t++;t<e.length&&(this.focusedIndex=t,e[t].classList.add("is-focused"),e[t].scrollIntoView({block:"nearest"}))}focusPreviousOption(){let e=this.getVisibleOptions();if(e.length===0)return;e.forEach(s=>s.classList.remove("is-focused"));let t=this.focusedIndex-1;for(;t>=0&&e[t].classList.contains("is-disabled");)t--;t>=0&&(this.focusedIndex=t,e[t].classList.add("is-focused"),e[t].scrollIntoView({block:"nearest"}))}setInitialFocus(){if(this.searchInput&&this.drawerElement.classList.contains("has-search")){this.searchInput.focus();return}let e=this.getVisibleOptions();if(e.length>0){let t=e.findIndex(s=>s.classList.contains("is-selected"));this.focusedIndex=t>=0?t:0,e[this.focusedIndex].classList.add("is-focused"),e[this.focusedIndex].scrollIntoView({block:"nearest"})}}lockBodyScroll(){this.scrollY=window.scrollY,document.body.style.position="fixed",document.body.style.top=`-${this.scrollY}px`,document.body.style.left="0",document.body.style.right="0",document.body.style.overflow="hidden"}unlockBodyScroll(){document.body.style.position="",document.body.style.top="",document.body.style.left="",document.body.style.right="",document.body.style.overflow="",window.scrollTo(0,this.scrollY)}handleResize(){!r.shouldUseDrawer()&&this.isOpen&&this.close()}handleTouchStart(e){this.touchStartY=e.touches[0].clientY,this.touchCurrentY=this.touchStartY,this.isSwiping=!0}handleTouchMove(e){if(!this.isSwiping)return;this.touchCurrentY=e.touches[0].clientY;let t=this.touchCurrentY-this.touchStartY;if(t>0){e.preventDefault();let s=.5;this.drawerElement.style.transform=`translateY(${t*s}px)`}}handleTouchEnd(){if(!this.isSwiping)return;this.isSwiping=!1;let e=this.touchCurrentY-this.touchStartY;this.drawerElement.style.transform="",e>80&&this.close()}destroy(){this.isOpen&&this.close(),this.drawerElement=null,this.customSelect=null}}});function Yt(r="[data-custom-select]"){let e;r instanceof HTMLElement?e=r.querySelectorAll("[data-custom-select]"):e=document.querySelectorAll(r);let t=[];return e.forEach(s=>{s.closest(".custom-select")||t.push(new Et(s))}),t}var Et,Fr=P(()=>{Us();Et=class{constructor(e,t={}){this.select=e,this.options={placeholder:e.dataset.placeholder||"Select...",searchable:e.dataset.searchable==="true",...t},this.isOpen=!1,this.focusedIndex=-1,this.searchString="",this.searchTimeout=null,this.useDrawerOnMobile=e.dataset.mobileDrawer!=="false",this.drawer=null,this.init()}init(){this.createCustomSelect(),this.bindEvents(),this.setInitialValue()}createCustomSelect(){this.wrapper=document.createElement("div"),this.wrapper.className="custom-select",this.select.disabled&&this.wrapper.classList.add("is-disabled"),this.select.classList.contains("custom-select-sm")&&this.wrapper.classList.add("custom-select-sm"),this.select.classList.contains("custom-select-lg")&&this.wrapper.classList.add("custom-select-lg"),this.select.classList.contains("custom-select--inline")&&this.wrapper.classList.add("custom-select--inline"),this.select.classList.contains("custom-select--align-right")&&this.wrapper.classList.add("custom-select--align-right");let e=this.select.options[this.select.selectedIndex],t=e&&e.value!=="";this.trigger=document.createElement("button"),this.trigger.type="button",this.trigger.className="custom-select-trigger",this.trigger.setAttribute("aria-haspopup","listbox"),this.trigger.setAttribute("aria-expanded","false"),this.trigger.disabled=this.select.disabled;let s=`custom-select-listbox-${Math.random().toString(36).substr(2,9)}`;this.trigger.setAttribute("aria-controls",s);let i=document.querySelector(`label[for="${this.select.id}"]`);if(i){let n=i.id||`label-${s}`;i.id=n,this.trigger.setAttribute("aria-labelledby",n)}this.trigger.innerHTML=`
            <span class="custom-select-value ${t?"":"is-placeholder"}">${t?e.text:this.options.placeholder}</span>
            <svg class="icon" aria-hidden="true"><use href="#icon-chevron-down"></use></svg>
        `,this.dropdown=document.createElement("div"),this.dropdown.className="custom-select-dropdown",this.dropdown.id=s,this.dropdown.setAttribute("role","listbox"),this.dropdown.setAttribute("tabindex","-1"),i&&this.dropdown.setAttribute("aria-labelledby",i.id),this.optionsList=document.createElement("ul"),this.optionsList.className="custom-select-options",this.optionsList.setAttribute("role","presentation"),this.renderOptions(),this.dropdown.appendChild(this.optionsList),this.wrapper.appendChild(this.trigger),this.wrapper.appendChild(this.dropdown),this.select.parentNode.insertBefore(this.wrapper,this.select),this.wrapper.appendChild(this.select)}renderOptions(){this.optionsList.innerHTML="",this.optionElements=[],Array.from(this.select.options).forEach((t,s)=>{if(t.value===""&&s===0)return;let i=document.createElement("li");i.className="custom-select-option",i.setAttribute("role","option"),i.setAttribute("data-value",t.value),i.setAttribute("aria-selected",t.selected?"true":"false"),i.id=`${this.dropdown.id}-option-${s}`,i.textContent=t.text,t.disabled&&(i.classList.add("is-disabled"),i.setAttribute("aria-disabled","true")),t.selected&&t.value!==""&&i.classList.add("is-selected"),this.optionsList.appendChild(i),this.optionElements.push(i)})}bindEvents(){this.trigger.addEventListener("click",e=>{e.preventDefault(),this.toggle()}),this.trigger.addEventListener("keydown",e=>this.handleTriggerKeydown(e)),this.optionsList.addEventListener("click",e=>{let t=e.target.closest(".custom-select-option");t&&!t.classList.contains("is-disabled")&&this.selectOption(t)}),this.optionsList.addEventListener("mouseover",e=>{let t=e.target.closest(".custom-select-option");t&&!t.classList.contains("is-disabled")&&this.setFocusedOption(this.optionElements.indexOf(t))}),document.addEventListener("click",e=>{!this.wrapper.contains(e.target)&&this.isOpen&&this.close()}),document.addEventListener("keydown",e=>{e.key==="Escape"&&this.isOpen&&(this.close(),this.trigger.focus())}),this.select.addEventListener("change",()=>{this.syncFromNative()})}handleTriggerKeydown(e){switch(e.key){case"Enter":case" ":e.preventDefault(),this.isOpen?this.focusedIndex>=0&&this.selectOption(this.optionElements[this.focusedIndex]):this.open();break;case"ArrowDown":e.preventDefault(),this.isOpen?this.focusNextOption():this.open();break;case"ArrowUp":e.preventDefault(),this.isOpen?this.focusPreviousOption():this.open();break;case"Home":e.preventDefault(),this.isOpen&&this.setFocusedOption(0);break;case"End":e.preventDefault(),this.isOpen&&this.setFocusedOption(this.optionElements.length-1);break;case"Tab":this.isOpen&&this.close();break;default:e.key.length===1&&!e.ctrlKey&&!e.metaKey&&this.handleTypeAhead(e.key);break}}handleTypeAhead(e){this.searchTimeout&&clearTimeout(this.searchTimeout),this.searchString+=e.toLowerCase();let t=this.optionElements.findIndex(s=>!s.classList.contains("is-disabled")&&s.textContent.toLowerCase().startsWith(this.searchString));t>=0&&(this.isOpen||this.open(),this.setFocusedOption(t)),this.searchTimeout=setTimeout(()=>{this.searchString=""},500)}toggle(){this.isOpen?this.close():this.open()}open(){if(this.wrapper.classList.contains("is-disabled"))return;if(this.useDrawerOnMobile&&St.shouldUseDrawer()){this.drawer||(this.drawer=new St(this)),this.drawer.open();return}this.isOpen=!0,this.wrapper.classList.add("is-open"),this.trigger.setAttribute("aria-expanded","true");let e=this.optionElements.findIndex(t=>t.classList.contains("is-selected"));this.setFocusedOption(e>=0?e:0),e>=0&&this.scrollOptionIntoView(this.optionElements[e])}close(){if(this.drawer?.isOpen){this.drawer.close();return}this.isOpen=!1,this.wrapper.classList.remove("is-open"),this.trigger.setAttribute("aria-expanded","false"),this.clearFocusedOption()}setFocusedOption(e){for(this.clearFocusedOption();e>=0&&e<this.optionElements.length&&this.optionElements[e].classList.contains("is-disabled");)e++;if(e>=0&&e<this.optionElements.length){this.focusedIndex=e;let t=this.optionElements[e];t.classList.add("is-focused"),this.trigger.setAttribute("aria-activedescendant",t.id),this.scrollOptionIntoView(t)}}clearFocusedOption(){this.optionElements.forEach(e=>e.classList.remove("is-focused")),this.focusedIndex=-1,this.trigger.removeAttribute("aria-activedescendant")}focusNextOption(){let e=this.focusedIndex+1;for(;e<this.optionElements.length&&this.optionElements[e].classList.contains("is-disabled");)e++;e<this.optionElements.length&&this.setFocusedOption(e)}focusPreviousOption(){let e=this.focusedIndex-1;for(;e>=0&&this.optionElements[e].classList.contains("is-disabled");)e--;e>=0&&this.setFocusedOption(e)}scrollOptionIntoView(e){let t=this.dropdown,s=e.offsetTop,i=s+e.offsetHeight,n=t.scrollTop,o=n+t.clientHeight;s<n?t.scrollTop=s:i>o&&(t.scrollTop=i-t.clientHeight)}selectOption(e){let t=e.dataset.value,s=e.textContent;this.select.value=t;let i=new Event("change",{bubbles:!0});this.select.dispatchEvent(i),this.updateDisplay(s,t!==""),this.optionElements.forEach(n=>{n.classList.remove("is-selected"),n.setAttribute("aria-selected","false")}),e.classList.add("is-selected"),e.setAttribute("aria-selected","true"),this.close(),this.trigger.focus()}updateDisplay(e,t){let s=this.trigger.querySelector(".custom-select-value");s.textContent=e,s.classList.toggle("is-placeholder",!t)}setInitialValue(){let e=this.select.options[this.select.selectedIndex];e&&e.value!==""&&this.updateDisplay(e.text,!0)}syncFromNative(){let e=this.select.options[this.select.selectedIndex],t=e&&e.value!=="";this.updateDisplay(t?e.text:this.options.placeholder,t),this.optionElements.forEach(s=>{let i=s.dataset.value===this.select.value;s.classList.toggle("is-selected",i),s.setAttribute("aria-selected",i?"true":"false")})}getValue(){return this.select.value}setValue(e){this.select.value=e,this.syncFromNative()}disable(){this.select.disabled=!0,this.trigger.disabled=!0,this.wrapper.classList.add("is-disabled")}enable(){this.select.disabled=!1,this.trigger.disabled=!1,this.wrapper.classList.remove("is-disabled")}destroy(){this.wrapper.parentNode.insertBefore(this.select,this.wrapper),this.wrapper.remove()}}});function Gs(r){return r&&ra[r.toUpperCase()]||Kt}function ot(r){return Hs[r]||null}function Oe(r){return r in Hs}var Hs,Kt,ra,_r=P(()=>{Hs={US:{currency:"USD",symbol:"$",flag:"\u{1F1FA}\u{1F1F8}",label:"United States"},GB:{currency:"GBP",symbol:"\xA3",flag:"\u{1F1EC}\u{1F1E7}",label:"United Kingdom"},EU:{currency:"EUR",symbol:"\u20AC",flag:"\u{1F1EA}\u{1F1FA}",label:"Europe"},CA:{currency:"CAD",symbol:"CA$",flag:"\u{1F1E8}\u{1F1E6}",label:"Canada"},AU:{currency:"AUD",symbol:"A$",flag:"\u{1F1E6}\u{1F1FA}",label:"Australia"}},Kt="US",ra={US:"US",CA:"CA",GB:"GB",AU:"AU",NZ:"AU",DE:"EU",FR:"EU",IT:"EU",ES:"EU",NL:"EU",BE:"EU",AT:"EU",IE:"EU",PT:"EU",FI:"EU",GR:"EU",LU:"EU",SK:"EU",SI:"EU",EE:"EU",LV:"EU",LT:"EU",CY:"EU",MT:"EU",PL:"EU",CZ:"EU",HU:"EU",RO:"EU",BG:"EU",HR:"EU",DK:"EU",SE:"EU",NO:"EU",IS:"EU",CH:"EU",LI:"EU"}});function F(r){return r?String(r).replace(/[&<>"']/g,e=>({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"})[e]):""}function se(r){if(!r)return"";if(r.startsWith("http://")||r.startsWith("https://"))return r;let e=window.erhData?.siteUrl||"";return r.startsWith("/")?e+r:e+"/"+r}var fe=P(()=>{});function te(){if(!window.erhData?.restUrl)throw new Error("erhData.restUrl not available");return window.erhData.restUrl}var xe=P(()=>{});function W(r,e=null){if(!ia)return;let t="[GeoPriceService]";e?console.log(t,r,e):console.log(t,r)}async function z(){if(window.erhUserGeoData)return window.erhUserGeoData;if(Lt)return Lt;Lt=na();let e=await Lt;return Lt=null,window.erhUserGeoData=e,e}async function na(){let r=performance.now();if(window.erhData?.user?.geo){let a=window.erhData.user.geo;if(Oe(a)){let c=ot(a);return W("Using database user preference",{region:a,time_ms:(performance.now()-r).toFixed(2)}),{geo:a,region:a,currency:c.currency,symbol:c.symbol,country:a,isUserPreference:!0}}}let e=la();if(e){let a=ot(e);return W("Using manual override",{region:e,time_ms:(performance.now()-r).toFixed(2)}),{geo:e,region:e,currency:a.currency,symbol:a.symbol,country:null,isUserPreference:!1}}let t=oa();if(t)return W("Using cached region",{region:t.region,time_ms:(performance.now()-r).toFixed(2)}),{...t,isUserPreference:!1};let s=null;try{W("Calling geo detection proxy...");let a=performance.now(),c=await fetch(te()+"geo"),d=(performance.now()-a).toFixed(2);if(c.ok){let l=await c.json();s=l.country||null,W("Geo proxy response",{country:s,region:l.region,detected:l.detected,time_ms:d})}else W("Geo proxy request failed",{status:c.status,time_ms:d})}catch(a){console.error("[GeoPriceService] Geo detection failed:",a.message)}let i=s?Gs(s):Kt,n=ot(i),o={geo:i,region:i,currency:n.currency,symbol:n.symbol,country:s,isUserPreference:!1};return aa(o),W("Geo detection complete",{region:i,country:s,source:s?"geo-proxy":"default",total_time_ms:(performance.now()-r).toFixed(2)}),o}function oa(){try{let r=localStorage.getItem(Nr);if(r&&Date.now()<parseInt(r,10)){let e=localStorage.getItem(Br);if(e){let t=JSON.parse(e);return W("Found valid cached region",{region:t.region,expires_in_hours:((parseInt(r,10)-Date.now())/36e5).toFixed(1)}),t}}else r?W("Cached region expired",{expired_ago_hours:((Date.now()-parseInt(r,10))/36e5).toFixed(1)}):W("No cached region found")}catch(r){W("localStorage error",{error:r.message})}return null}function aa(r){try{localStorage.setItem(Br,JSON.stringify(r)),localStorage.setItem(Nr,String(Date.now()+24*60*60*1e3)),W("Cached region to localStorage",{region:r.region,ttl_hours:24})}catch(e){W("Failed to cache to localStorage",{error:e.message})}Vs(r.geo),r.country&&ca(r.country)}function Vs(r){let e=document.cookie.split("; ").find(i=>i.startsWith("erh_geo="));if(e){let i=e.split("=")[1];if(i===r){W("Cookie already set with correct value",{geo:r,action:"skipped"});return}W("Cookie exists with different value",{existing:i,new:r,action:"updating"})}else W("No existing cookie found",{geo:r,action:"creating"});let t=new Date;t.setFullYear(t.getFullYear()+1),document.cookie=`erh_geo=${r}; expires=${t.toUTCString()}; path=/; SameSite=Lax`,document.cookie.split("; ").find(i=>i.startsWith("erh_geo="))?W("Cookie set successfully",{geo:r,expires:t.toUTCString()}):W("WARNING: Cookie may not have been set (check browser settings)",{geo:r})}function ca(r){if(!r)return;let e=document.cookie.split("; ").find(s=>s.startsWith("erh_country="));if(e&&e.split("=")[1]===r)return;let t=new Date;t.setFullYear(t.getFullYear()+1),document.cookie=`erh_country=${r}; expires=${t.toUTCString()}; path=/; SameSite=Lax`,W("Country cookie set",{country:r,expires:t.toUTCString()})}function la(){try{let r=localStorage.getItem(Or);if(r&&Oe(r))return r}catch{}return null}function da(r){if(!Oe(r))return console.warn(`[GeoPriceService] Invalid region code: ${r}`),!1;try{localStorage.setItem(Or,r),localStorage.removeItem(Br),localStorage.removeItem(Nr),delete window.erhUserGeoData,Jt.clear(),Vs(r),document.cookie="erh_country=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/;";let e=ot(r);return window.dispatchEvent(new CustomEvent("erh:region-changed",{detail:{region:r,currency:e.currency,symbol:e.symbol}})),!0}catch(e){return console.error("[GeoPriceService] Failed to set region override:",e),!1}}async function Qt(r){if(!Oe(r))return console.warn(`[GeoPriceService] Invalid region code: ${r}`),{success:!1,method:null};if(!window.erhData?.isLoggedIn)return{success:da(r),method:"localStorage"};try{let e=await fetch(`${window.erhData.restUrl}user/preferences`,{method:"PUT",headers:{"Content-Type":"application/json","X-WP-Nonce":window.erhData.nonce},credentials:"same-origin",body:JSON.stringify({geo:r})});if(e.ok){window.erhData.user&&(window.erhData.user.geo=r),delete window.erhUserGeoData,Jt.clear(),ua("erh_geo",r,365);try{localStorage.removeItem(Or)}catch{}let t=ot(r);return window.dispatchEvent(new CustomEvent("erh:region-changed",{detail:{region:r,currency:t.currency,symbol:t.symbol}})),W("User geo preference saved to database",{region:r}),{success:!0,method:"database"}}return console.error("[GeoPriceService] Failed to save geo preference:",e.status),{success:!1,method:null}}catch(e){return console.error("[GeoPriceService] Error saving geo preference:",e),{success:!1,method:null}}}function ua(r,e,t){let s=new Date;s.setDate(s.getDate()+t),document.cookie=`${r}=${e}; expires=${s.toUTCString()}; path=/; SameSite=Lax`}async function Fe(r,e,t=null){let s=`product:${r}:${e}:${t||"native"}`,i=Jt.get(s);if(i&&Date.now()<i.expiry)return W("getProductPrices: cache hit",{productId:r,geo:e}),i.data;if(Xt.has(s))return W("getProductPrices: request in flight, waiting",{productId:r,geo:e}),Xt.get(s);let n=(async()=>{try{let o=new URLSearchParams({geo:e});t&&o.append("convert_to",t);let a=`${te()}prices/${r}?${o}`;W("getProductPrices: fetching",{url:a});let c=performance.now(),d=await fetch(a),l=(performance.now()-c).toFixed(2);if(!d.ok)throw W("getProductPrices: HTTP error",{status:d.status,fetchTime:l}),new Error(`HTTP ${d.status}`);let h=await d.json();return W("getProductPrices: success",{fetchTime:l,offersCount:h.offers?.length}),Jt.set(s,{data:h,expiry:Date.now()+sa}),h}catch(o){return W("getProductPrices: error",{error:o.message}),console.error("[GeoPriceService] Failed to fetch product prices:",o),null}finally{Xt.delete(s)}})();return Xt.set(s,n),n}function _(r,e,t=!1){if(r==null)return"";let i={USD:{symbol:"$",locale:"en-US"},EUR:{symbol:"\u20AC",locale:"de-DE"},GBP:{symbol:"\xA3",locale:"en-GB"},CAD:{symbol:"CA$",locale:"en-CA"},AUD:{symbol:"A$",locale:"en-AU"}}[e]||{symbol:e+" ",locale:"en-US"},n=r.toLocaleString(i.locale,{minimumFractionDigits:2,maximumFractionDigits:2});return t?`~${i.symbol}${n}`:`${i.symbol}${n}`}function $e(r){return{USD:"$",EUR:"\u20AC",GBP:"\xA3",CAD:"CA$",AUD:"A$"}[r]||r}function Xe(r,e){if(!r||!e)return[];let t=e.currency,s=e.geo,i=e.country,n=["DE","FR","IT","ES","NL","BE","AT","IE","PT","FI","GR","LU","SK","SI","EE","LV","LT","CY","MT","BG","HR","CZ","DK","HU","PL","RO","SE"];return r.filter(o=>{let a=o.currency||"USD",c=o.geo;if(a!==t)return W("Offer rejected: currency mismatch",{retailer:o.retailer,offerCurrency:a,userCurrency:t}),!1;if(c){let d=c.includes(",")?c.split(",").map(l=>l.trim().toUpperCase()):[c.toUpperCase()];return d.includes(s)?(W("Offer accepted: direct geo match",{retailer:o.retailer,offerGeo:c}),!0):i&&d.includes(i.toUpperCase())?(W("Offer accepted: country code match",{retailer:o.retailer,userCountry:i,offerGeo:c}),!0):s==="EU"&&d.some(h=>n.includes(h)||h==="EU")?(W("Offer accepted: EU geo match",{retailer:o.retailer,offerGeo:c}),!0):n.includes(s)&&d.includes("EU")?(W("Offer accepted: EU country accepts EU offer",{retailer:o.retailer,offerGeo:c}),!0):(W("Offer rejected: geo mismatch",{retailer:o.retailer,offerGeo:c,userGeoCode:s,userCountry:i}),!1)}return W("Offer accepted: no geo restriction, currency matched",{retailer:o.retailer}),!0})}var sa,Br,Nr,Or,ia,Jt,Xt,Lt,ne=P(()=>{_r();fe();xe();sa=60*60*1e3,Br="erh_user_region",Nr="erh_user_region_expiry",Or="erh_region_override",ia=localStorage.getItem("erh_geo_debug")==="true"||new URLSearchParams(window.location.search).has("geo_debug");Jt=new Map,Xt=new Map,Lt=null});function pa(){Pe.length===1&&(Ur=window.scrollY,document.body.style.overflow="hidden",document.body.style.position="fixed",document.body.style.top=`-${Ur}px`,document.body.style.width="100%")}function fa(){Pe.length===0&&(document.body.style.overflow="",document.body.style.position="",document.body.style.top="",document.body.style.width="",window.scrollTo(0,Ur))}function js(){document.querySelectorAll("[data-modal-trigger]:not([data-modal-initialized])").forEach(r=>{let e=r.getAttribute("data-modal-trigger");r.addEventListener("click",t=>{t.preventDefault(),le.openById(e,r)}),r.setAttribute("data-modal-initialized","true")}),document.querySelectorAll("[data-modal]").forEach(r=>{new le(r)})}var ha,Zt,Pe,Ur,le,Ue=P(()=>{ha=["a[href]","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])",'[tabindex]:not([tabindex="-1"])'].join(", "),Zt=200,Pe=[],Ur=0;le=class r{static instances=new Map;static backdrop=null;constructor(e,t={}){if(typeof e=="string"&&(e=document.querySelector(e)),!e)throw new Error("Modal: Element not found");if(r.instances.has(e))return r.instances.get(e);this.element=e,this.id=e.id,this.isOpen=!1,this.triggerElement=null,this.previouslyFocused=null,this.options={closeOnBackdrop:!0,closeOnEscape:!0,trapFocus:!0,autoFocus:!0,returnFocus:!0,beforeOpen:null,afterOpen:null,beforeClose:null,afterClose:null,...t},this._init(),r.instances.set(e,this)}_init(){this.element.setAttribute("role","dialog"),this.element.setAttribute("aria-modal","true");let e=this.element.querySelector(".modal-title");e&&(e.id||(e.id=`${this.id}-title`),this.element.setAttribute("aria-labelledby",e.id)),this._boundClose=()=>this.close(),this.closeButtons=this.element.querySelectorAll("[data-modal-close]"),this.closeButtons.forEach(t=>{t.addEventListener("click",this._boundClose)}),this.content=this.element.querySelector(".modal-content"),this._focusableElements=null}_refreshFocusableCache(){this._focusableElements=this.element.querySelectorAll(ha)}static _createBackdrop(){if(r.backdrop)return r.backdrop;let e=document.createElement("div");return e.className="modal-backdrop",e.setAttribute("aria-hidden","true"),document.body.appendChild(e),r.backdrop=e,e}static _showBackdrop(){let e=r._createBackdrop();e.offsetHeight,e.classList.add("is-visible")}static _hideBackdrop(){r.backdrop&&Pe.length===0&&r.backdrop.classList.remove("is-visible")}open(e=null){if(this.isOpen||(this.triggerElement=e,this.previouslyFocused=document.activeElement,this.options.beforeOpen&&this.options.beforeOpen(this)===!1))return;let t=new CustomEvent("modal:beforeOpen",{bubbles:!0,cancelable:!0,detail:{modal:this}});this.element.dispatchEvent(t)&&(r._showBackdrop(),Pe.push(this),this.isOpen=!0,pa(),this.element.classList.add("is-visible"),this.element.setAttribute("aria-hidden","false"),this.element.style.zIndex=1e3+Pe.length,this._refreshFocusableCache(),this.options.autoFocus&&setTimeout(()=>this._setInitialFocus(),Zt),this._bindEvents(),setTimeout(()=>{this.options.afterOpen&&this.options.afterOpen(this),this.element.dispatchEvent(new CustomEvent("modal:afterOpen",{bubbles:!0,detail:{modal:this}}))},Zt))}close(){if(!this.isOpen||this.options.beforeClose&&this.options.beforeClose(this)===!1)return;let e=new CustomEvent("modal:beforeClose",{bubbles:!0,cancelable:!0,detail:{modal:this}});if(!this.element.dispatchEvent(e))return;let t=Pe.indexOf(this);t>-1&&Pe.splice(t,1),this.isOpen=!1,this.element.classList.remove("is-visible"),this.element.setAttribute("aria-hidden","true"),this._unbindEvents(),r._hideBackdrop(),fa(),this.options.returnFocus&&this.previouslyFocused&&setTimeout(()=>{this.previouslyFocused.focus()},Zt),setTimeout(()=>{this.options.afterClose&&this.options.afterClose(this),this.element.dispatchEvent(new CustomEvent("modal:afterClose",{bubbles:!0,detail:{modal:this}}))},Zt)}toggle(e=null){this.isOpen?this.close():this.open(e)}_setInitialFocus(){let e=this.element.querySelector("[autofocus]");if(e){e.focus();return}if(this._focusableElements?.length){this._focusableElements[0].focus();return}this.content&&(this.content.setAttribute("tabindex","-1"),this.content.focus())}_handleFocusTrap(e){if(!this.options.trapFocus)return;let t=this._focusableElements;if(!t?.length)return;let s=t[0],i=t[t.length-1];e.shiftKey&&document.activeElement===s?(e.preventDefault(),i.focus()):!e.shiftKey&&document.activeElement===i&&(e.preventDefault(),s.focus())}_handleKeydown=e=>{Pe[Pe.length-1]===this&&(e.key==="Escape"&&this.options.closeOnEscape&&(e.preventDefault(),this.close()),e.key==="Tab"&&this._handleFocusTrap(e))};_handleMousedown=e=>{this._mousedownTarget=e.target};_handleBackdropClick=e=>{this.options.closeOnBackdrop&&e.target===this.element&&this._mousedownTarget===this.element&&this.close()};_bindEvents(){document.addEventListener("keydown",this._handleKeydown),this.element.addEventListener("mousedown",this._handleMousedown),this.element.addEventListener("click",this._handleBackdropClick)}_unbindEvents(){document.removeEventListener("keydown",this._handleKeydown),this.element.removeEventListener("mousedown",this._handleMousedown),this.element.removeEventListener("click",this._handleBackdropClick)}destroy(e=!1){this.isOpen&&this.close(),this.closeButtons.forEach(t=>{t.removeEventListener("click",this._boundClose)}),r.instances.delete(this.element),e&&this.element.parentNode&&this.element.parentNode.removeChild(this.element),this._focusableElements=null,this._boundClose=null}static openById(e,t=null){let s=document.getElementById(e);if(!s)return console.warn(`Modal: Element with id "${e}" not found`),null;let i=new r(s);return i.open(t),i}static closeAll(){[...Pe].reverse().forEach(e=>e.close())}static create(e={}){let{id:t=`modal-${Date.now()}`,title:s="",content:i="",size:n="md",closable:o=!0,footerContent:a="",className:c="",...d}=e,l=document.getElementById(t);if(!l){let u=`
                <div class="modal ${c}" id="${t}" data-modal aria-hidden="true">
                    <div class="modal-content modal-content--${n}">
                        ${o?`
                            <button class="modal-close" data-modal-close aria-label="Close modal">
                                <svg class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <line x1="18" y1="6" x2="6" y2="18"></line>
                                    <line x1="6" y1="6" x2="18" y2="18"></line>
                                </svg>
                            </button>
                        `:""}
                        ${s?`<h2 class="modal-title">${s}</h2>`:""}
                        <div class="modal-body">${i}</div>
                        ${a?`<div class="modal-footer">${a}</div>`:""}
                    </div>
                </div>
            `;document.body.insertAdjacentHTML("beforeend",u),l=document.getElementById(t)}let h=new r(l,d);return h.open(),h}updateContent({title:e,body:t,footer:s}){if(e!==void 0){let i=this.element.querySelector(".modal-title");i&&(i.innerHTML=e)}if(t!==void 0){let i=this.element.querySelector(".modal-body");i&&(i.innerHTML=t)}if(s!==void 0){let i=this.element.querySelector(".modal-footer");i&&(i.innerHTML=s)}}};document.readyState==="loading"?document.addEventListener("DOMContentLoaded",js):js()});var ma,Rr,Z,Ie=P(()=>{fe();ma=4e3,Rr=class{constructor(){this.container=null,this.toasts=[],this.counter=0}getContainer(){return this.container||(this.container=document.createElement("div"),this.container.className="toast-container",this.container.setAttribute("aria-live","polite"),this.container.setAttribute("aria-label","Notifications"),document.body.appendChild(this.container)),this.container}show(e={}){let{message:t="",type:s="info",duration:i=ma,action:n=null}=e,o=this.getContainer(),a=++this.counter,c=document.createElement("div");c.className=`toast toast--${s}`,c.setAttribute("role","status"),c.dataset.toastId=a;let d={success:`<svg class="toast-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path>
                <polyline points="22 4 12 14.01 9 11.01"></polyline>
            </svg>`,error:`<svg class="toast-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <circle cx="12" cy="12" r="10"></circle>
                <line x1="15" y1="9" x2="9" y2="15"></line>
                <line x1="9" y1="9" x2="15" y2="15"></line>
            </svg>`,warning:`<svg class="toast-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"></path>
                <line x1="12" y1="9" x2="12" y2="13"></line>
                <line x1="12" y1="17" x2="12.01" y2="17"></line>
            </svg>`,info:`<svg class="toast-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <circle cx="12" cy="12" r="10"></circle>
                <line x1="12" y1="16" x2="12" y2="12"></line>
                <line x1="12" y1="8" x2="12.01" y2="8"></line>
            </svg>`};c.innerHTML=`
            ${d[s]||d.info}
            <span class="toast-message">${F(t)}</span>
            ${n?`<button type="button" class="toast-action">${F(n.label)}</button>`:""}
            <button type="button" class="toast-close" aria-label="Dismiss">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <line x1="18" y1="6" x2="6" y2="18"></line>
                    <line x1="6" y1="6" x2="18" y2="18"></line>
                </svg>
            </button>
        `,o.appendChild(c);let l={id:a,element:c,dismiss:()=>this.dismiss(a)};return this.toasts.push(l),requestAnimationFrame(()=>{c.classList.add("is-visible")}),c.querySelector(".toast-close").addEventListener("click",()=>this.dismiss(a)),n&&n.onClick&&c.querySelector(".toast-action").addEventListener("click",()=>{n.onClick(),this.dismiss(a)}),i>0&&setTimeout(()=>this.dismiss(a),i),l}dismiss(e){let t=this.toasts.findIndex(i=>i.id===e);if(t===-1)return;let s=this.toasts[t];s.element.classList.remove("is-visible"),s.element.classList.add("is-leaving"),setTimeout(()=>{s.element.remove(),this.toasts.splice(t,1),this.toasts.length===0&&this.container&&(this.container.remove(),this.container=null)},200)}dismissAll(){[...this.toasts].forEach(e=>this.dismiss(e.id))}success(e,t={}){return this.show({message:e,type:"success",...t})}error(e,t={}){return this.show({message:e,type:"error",...t})}warning(e,t={}){return this.show({message:e,type:"warning",...t})}info(e,t={}){return this.show({message:e,type:"info",...t})}},Z=new Rr});function kt(){let r=document.querySelectorAll("[data-popover-trigger]");return r.length?(r.forEach(e=>{let t=e.getAttribute("data-popover-trigger"),s=document.getElementById(t);if(!s)return;s.classList.contains("popover--bottom")?s.dataset.preferredPosition="bottom":s.dataset.preferredPosition="top",e.addEventListener("click",n=>{n.preventDefault(),n.stopPropagation(),s.classList.contains("is-visible")?ct():ba(s,e)});let i=s.querySelector('[class*="popover-close"]');i&&i.addEventListener("click",()=>ct())}),document.addEventListener("click",wa),document.addEventListener("keydown",Sa),window.addEventListener("resize",Ea,{passive:!0}),window.addEventListener("scroll",La,{passive:!0,capture:!0}),{close:ct}):null}function ba(r,e){we&&we!==r&&(we.classList.remove("is-visible"),we.setAttribute("aria-hidden","true")),we=r,xt=e,Ys(r,e),requestAnimationFrame(()=>{r.classList.add("is-visible"),r.setAttribute("aria-hidden","false")})}function ct(){if(!we)return;let r=we;r.classList.remove("is-visible"),r.setAttribute("aria-hidden","true"),r.addEventListener("transitionend",function e(t){if(t.propertyName==="opacity"&&(r.removeEventListener("transitionend",e),!r.classList.contains("is-visible"))){r.style.left="",r.style.top="";let s=r.dataset.preferredPosition||"top";r.classList.remove("popover--top","popover--bottom"),r.classList.add(`popover--${s}`);let i=r.querySelector(".popover-arrow");i&&i.style.removeProperty("--arrow-offset")}}),we=null,xt=null}function Ys(r,e){let t=e.getBoundingClientRect(),s=r.getBoundingClientRect(),i={width:window.innerWidth,height:window.innerHeight},n=r.dataset.preferredPosition||"top",o={top:{x:t.left+(t.width-s.width)/2,y:t.top-s.height-at.offset},bottom:{x:t.left+(t.width-s.width)/2,y:t.bottom+at.offset}};function a(b,k){return k==="top"?b.y>=at.viewportPadding:b.y+s.height<=i.height-at.viewportPadding}let c=n;if(!a(o[n],n)){let b=n==="top"?"bottom":"top";a(o[b],b)&&(c=b)}let{x:d,y:l}=o[c],h=at.viewportPadding,u=i.width-s.width-at.viewportPadding,p=Math.max(h,Math.min(d,u)),f=t.left+t.width/2,m=p+s.width/2,g=f-m,y=s.width/2-20,v=Math.max(-y,Math.min(g,y));r.classList.remove("popover--top","popover--bottom"),r.classList.add(`popover--${c}`),r.style.left=`${p}px`,r.style.top=`${l}px`;let w=r.querySelector(".popover-arrow");w&&w.style.setProperty("--arrow-offset",`${v}px`)}function wa(r){we&&(we.contains(r.target)||xt?.contains(r.target)||ct())}function Sa(r){r.key==="Escape"&&we&&ct()}function Ea(){we&&xt&&Ys(we,xt)}function La(){we&&ct()}var at,we,xt,er=P(()=>{at={offset:8,viewportPadding:12},we=null,xt=null;document.addEventListener("DOMContentLoaded",kt)});var Zs={};j(Zs,{Gallery:()=>Ct,autoInit:()=>Qs,default:()=>Ia,initGalleries:()=>Wr,videoLightbox:()=>sr});function Wr(r=He.gallery){let e=document.querySelectorAll(`${r}:not([data-gallery-initialized])`);return Array.from(e).map(t=>new Ct(t))}function Qs(){document.readyState==="loading"?document.addEventListener("DOMContentLoaded",()=>Wr()):Wr()}var He,Qe,jr,sr,Ct,Ia,zr=P(()=>{He={gallery:"[data-gallery]",mainImage:".gallery-main img",mainContainer:".gallery-main",thumbsWrapper:".gallery-thumbs-wrapper",thumbsScroll:".gallery-thumbs-scroll",thumbs:".gallery-thumbs",thumb:".gallery-thumb",videoThumb:".gallery-video-card",arrowPrev:".gallery-arrow--prev",arrowNext:".gallery-arrow--next",lightbox:".gallery-lightbox"},Qe={active:"is-active",lightboxOpen:"lightbox-open",lightboxVisible:"is-visible",canScrollLeft:"can-scroll-left",canScrollRight:"can-scroll-right"},jr=class r{constructor(){if(r.instance)return r.instance;this.element=null,this.videoContainer=null,this.isOpen=!1,this.boundHandleKeydown=this.handleKeydown.bind(this),r.instance=this}create(){this.element||(this.element=document.createElement("div"),this.element.className="gallery-lightbox",this.element.setAttribute("role","dialog"),this.element.setAttribute("aria-modal","true"),this.element.setAttribute("aria-label","Video player"),this.element.innerHTML=`
      <div class="gallery-lightbox-backdrop"></div>
      <div class="gallery-lightbox-content">
        <button class="gallery-lightbox-close" aria-label="Close video">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <line x1="18" y1="6" x2="6" y2="18"></line>
            <line x1="6" y1="6" x2="18" y2="18"></line>
          </svg>
        </button>
        <div class="gallery-lightbox-video"></div>
      </div>
    `,document.body.appendChild(this.element),this.videoContainer=this.element.querySelector(".gallery-lightbox-video"),this.element.querySelector(".gallery-lightbox-backdrop").addEventListener("click",()=>this.close()),this.element.querySelector(".gallery-lightbox-close").addEventListener("click",()=>this.close()))}open(e){this.create(),this.videoContainer.innerHTML=`
      <iframe
        src="https://www.youtube.com/embed/${e}?autoplay=1&rel=0"
        title="Video player"
        frameborder="0"
        allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
        allowfullscreen>
      </iframe>
    `,document.body.classList.add(Qe.lightboxOpen),this.element.classList.add(Qe.lightboxVisible),this.isOpen=!0,document.addEventListener("keydown",this.boundHandleKeydown),this.element.querySelector(".gallery-lightbox-close").focus()}close(){this.isOpen&&(this.videoContainer.innerHTML="",document.body.classList.remove(Qe.lightboxOpen),this.element.classList.remove(Qe.lightboxVisible),this.isOpen=!1,document.removeEventListener("keydown",this.boundHandleKeydown))}handleKeydown(e){e.key==="Escape"&&this.close()}},sr=new jr,Ct=class{constructor(e,t={}){this.element=e,this.options={scrollAmount:160,...t},this.mainImage=this.element.querySelector(He.mainImage),this.thumbsScroll=this.element.querySelector(He.thumbsScroll),this.thumbsContainer=this.element.querySelector(He.thumbs),this.thumbs=this.element.querySelectorAll(He.thumb),this.videoThumb=this.element.querySelector(He.videoThumb),this.arrowPrev=this.element.querySelector(He.arrowPrev),this.arrowNext=this.element.querySelector(He.arrowNext),this.currentIndex=0,this.boundHandleKeydown=this.handleKeydown.bind(this),this.boundUpdateScrollState=this.updateScrollState.bind(this),this.init()}init(){if(this.videoThumb&&this.videoThumb.addEventListener("click",()=>{let e=this.videoThumb.dataset.video;e&&sr.open(e)}),!this.mainImage||!this.thumbs.length){this.element.setAttribute("data-gallery-initialized","true");return}this.thumbs.forEach((e,t)=>{e.addEventListener("click",s=>this.handleThumbClick(s,e,t))}),this.element.addEventListener("keydown",this.boundHandleKeydown),this.arrowPrev&&this.arrowNext&&this.thumbsContainer&&(this.arrowPrev.addEventListener("click",()=>this.scrollThumbs("prev")),this.arrowNext.addEventListener("click",()=>this.scrollThumbs("next")),this.thumbsContainer.addEventListener("scroll",this.boundUpdateScrollState),window.addEventListener("resize",this.boundUpdateScrollState),this.updateScrollState()),this.element.hasAttribute("tabindex")||this.element.setAttribute("tabindex","0"),this.element.setAttribute("data-gallery-initialized","true")}handleKeydown(e){if(!(!this.element.contains(document.activeElement)&&document.activeElement!==this.element))switch(e.key){case"ArrowLeft":e.preventDefault(),this.prev();break;case"ArrowRight":e.preventDefault(),this.next();break}}handleThumbClick(e,t,s){e.preventDefault();let i=t.dataset.img;i&&this.setActiveImage(i,s)}setActiveImage(e,t){this.mainImage.style.opacity="0";let s=new Image;s.onload=()=>{this.mainImage.src=e,this.mainImage.style.opacity="1"},s.src=e,this.thumbs.forEach((i,n)=>{i.classList.toggle(Qe.active,n===t)}),this.currentIndex=t,this.scrollThumbIntoView(t)}scrollThumbIntoView(e){let t=this.thumbs[e];!t||!this.thumbsContainer||t.scrollIntoView({behavior:"smooth",block:"nearest",inline:"nearest"})}next(){let e=(this.currentIndex+1)%this.thumbs.length,t=this.thumbs[e];t?.dataset.img&&this.setActiveImage(t.dataset.img,e)}prev(){let e=(this.currentIndex-1+this.thumbs.length)%this.thumbs.length,t=this.thumbs[e];t?.dataset.img&&this.setActiveImage(t.dataset.img,e)}scrollThumbs(e){if(!this.thumbsContainer)return;let t=e==="prev"?-this.options.scrollAmount:this.options.scrollAmount;this.thumbsContainer.scrollBy({left:t,behavior:"smooth"})}updateScrollState(){if(!this.thumbsContainer||!this.thumbsScroll)return;let{scrollLeft:e,scrollWidth:t,clientWidth:s}=this.thumbsContainer,i=e>1,n=e+s<t-1;this.thumbsScroll.classList.toggle(Qe.canScrollLeft,i),this.thumbsScroll.classList.toggle(Qe.canScrollRight,n)}destroy(){this.element.removeEventListener("keydown",this.boundHandleKeydown),this.thumbsContainer&&this.thumbsContainer.removeEventListener("scroll",this.boundUpdateScrollState),window.removeEventListener("resize",this.boundUpdateScrollState),this.element.removeAttribute("data-gallery-initialized")}};Qs();Ia=Ct});var ri={};j(ri,{autoInit:()=>ti,createChart:()=>Ze,default:()=>_a,setupPeriodToggles:()=>Xr});function Yr(r,e="USD"){let s={USD:{symbol:"$",locale:"en-US"},EUR:{symbol:"\u20AC",locale:"de-DE"},GBP:{symbol:"\xA3",locale:"en-GB"},CAD:{symbol:"CA$",locale:"en-CA"},AUD:{symbol:"A$",locale:"en-AU"}}[e]||{symbol:e+" ",locale:"en-US"},i=r.toLocaleString(s.locale,{minimumFractionDigits:2,maximumFractionDigits:2});return`${s.symbol}${i}`}function Ze(r,e={}){return new Kr(r,e)}function ei(r){if(r._erhChart)return;let e=r.dataset.erhChart||"default",t=window.erhData?.chartData?.[e];if(t){let s=Ze(r,t.options||{});s.setData(t.data),r._erhChart=s,t.periods&&Xr(r,s,t.periods)}}function ti(){let r=document.querySelectorAll("[data-erh-chart]");r.forEach(e=>ei(e)),window.addEventListener("erhPriceDataReady",()=>{r.forEach(e=>ei(e))})}function Xr(r,e,t){let s=r.closest(".price-intel-history")||r.parentElement,i=s?.querySelectorAll(".price-intel-chart-period button");if(!i?.length)return;let n={avgLabel:s?.querySelector("[data-period-label]"),avgValue:s?.querySelector("[data-period-avg]"),lowLabel:s?.querySelector("[data-period-low-label]"),lowValue:s?.querySelector("[data-period-low]"),lowMeta:s?.querySelector("[data-period-low-meta]")};i.forEach(o=>{o.addEventListener("click",()=>{let a=o.textContent.trim().toLowerCase(),c=t[a];c&&(i.forEach(d=>d.classList.remove("is-active")),o.classList.add("is-active"),e.update(c),Ma(a,c,n,e.options.currency))})})}function Ma(r,e,t,s="USD"){if(!e?.values?.length)return;let{avgLabel:i,avgValue:n,lowLabel:o,lowValue:a,lowMeta:c}=t,l={"3m":{avg:"3-month avg",low:"3-month low"},"6m":{avg:"6-month avg",low:"6-month low"},"1y":{avg:"1-year avg",low:"1-year low"},all:{avg:"All-time avg",low:"All-time low"}}[r]||{avg:`${r} avg`,low:`${r} low`};if(i&&n){let h=e.values.reduce((p,f)=>p+f,0),u=Math.round(h/e.values.length);i.textContent=l.avg,n.textContent=Yr(u,s)}if(o&&a){let h=Math.min(...e.values),u=e.values.indexOf(h);if(o.textContent=l.low,a.textContent=Yr(h,s),c&&e.dates&&e.stores){let p=e.dates[u]||"",f=e.stores[u]||"",m=Fa(p);c.textContent=f?`${m} \xB7 ${f}`:m}}}function Fa(r){if(!r)return"";let e=r.match(/(\w+)\s+\d+,\s+(\d+)/);return e?`${e[1]} ${e[2]}`:r}var Da,Kr,_a,ir=P(()=>{Da={height:180,margin:{top:2,right:0,bottom:2,left:0},type:"line",lineColor:"#5e2ced",areaColor:"rgba(94, 44, 237, 0.1)",barColor:"#5e2ced",gridColor:"#f3f2f5",textColor:"#6f768f",lineWidth:2,showArea:!0,showDots:!1,dotRadius:4,curveType:"linear",barRadius:4,barGap:.2,showXAxis:!0,showYAxis:!0,yAxisInside:!0,showGrid:!1,xAxisHeight:16,yAxisWidth:45,yTickCount:5,animate:!0,animationDuration:1e3,animationEasing:"ease-out",animateOnVisible:!0,showTooltip:!0,formatValue:(r,e="USD")=>Yr(r,e),formatLabel:r=>r,currency:"USD",responsive:!0};Kr=class{constructor(e,t={}){if(this.container=typeof e=="string"?document.querySelector(e):e,!this.container){console.warn("Chart container not found");return}this.options={...Da,...t},this.data=null,this.svg=null,this.tooltip=null,this.hasAnimated=!1,this.resizeObserver=null,this.intersectionObserver=null,this._init()}_init(){this._createSVG(),this.options.showTooltip&&this._createTooltip(),this.options.responsive&&this._setupResponsive(),this.options.animateOnVisible&&this.options.animate&&this._setupVisibilityObserver()}_createSVG(){let e=this.container.clientWidth,t=this.options.height;this.svg=document.createElementNS("http://www.w3.org/2000/svg","svg"),this.svg.setAttribute("width","100%"),this.svg.setAttribute("height",t),this.svg.setAttribute("viewBox",`0 0 ${e} ${t}`),this.svg.setAttribute("preserveAspectRatio","none"),this.svg.classList.add("erh-chart");let s=document.createElementNS("http://www.w3.org/2000/svg","defs");s.innerHTML=`
            <linearGradient id="areaGradient-${this._uid}" x1="0" y1="0" x2="0" y2="1">
                <stop offset="0%" stop-color="${this.options.lineColor}" stop-opacity="0.15"/>
                <stop offset="100%" stop-color="${this.options.lineColor}" stop-opacity="0"/>
            </linearGradient>
        `,this.svg.appendChild(s),this.container.appendChild(this.svg),this.width=e,this.height=t}get _uid(){return this.__uid||(this.__uid=Math.random().toString(36).substr(2,9)),this.__uid}_createTooltip(){this.tooltip=document.createElement("div"),this.tooltip.className="erh-chart-tooltip",this.tooltip.style.cssText=`
            position: absolute;
            pointer-events: none;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.15s ease, visibility 0.15s ease;
            z-index: 100;
        `,this.container.style.position="relative",this.container.appendChild(this.tooltip)}_setupResponsive(){this.resizeObserver=new ResizeObserver(()=>{this._handleResize()}),this.resizeObserver.observe(this.container)}_handleResize(){let e=this.container.clientWidth;e!==this.width&&e>0&&(this.width=e,this.svg.setAttribute("viewBox",`0 0 ${this.width} ${this.height}`),this.data&&this._render(!1))}_setupVisibilityObserver(){this.intersectionObserver=new IntersectionObserver(e=>{e.forEach(t=>{t.isIntersecting&&!this.hasAnimated&&this.data&&(this._render(!0),this.hasAnimated=!0)})},{threshold:.2}),this.intersectionObserver.observe(this.container)}setData(e){return this.data=e,this.options.animateOnVisible&&this.options.animate&&!this.hasAnimated?this:(this._render(this.options.animate&&!this.hasAnimated),this.hasAnimated=!0,this)}update(e){return this.data=e,this._render(!1),this}_render(e=!1){if(!this.data||!this.data.values||!this.data.values.length)return;let t=this.svg.querySelector("defs");this.svg.innerHTML="",t&&this.svg.appendChild(t);let{xScale:s,yScale:i,chartArea:n}=this._calculateScales();this.options.type==="line"?this._renderLineChart(s,i,n,e):this.options.type==="bar"&&this._renderBarChart(s,i,n,e),this.options.showXAxis&&this._renderXAxis(s,n),this.options.showYAxis&&this._renderYAxis(i,n),this.options.showGrid&&this._renderGrid(i,n),this.options.showTooltip&&this._addInteractionLayer(s,i,n)}_calculateScales(){let{margin:e,showYAxis:t,yAxisInside:s,yAxisWidth:i,showXAxis:n,xAxisHeight:o}=this.options,a={left:e.left+(t&&!s?i:0),right:this.width-e.right,top:e.top,bottom:this.height-e.bottom-(n?o:0)};a.width=a.right-a.left,a.height=a.bottom-a.top;let c=this.data.values,d=Math.min(...c),l=Math.max(...c),u=(l-d)*.07||l*.07;this._yMin=d-u,this._yMax=l+u;let p=m=>c.length<=1?a.left+a.width/2:a.left+m/(c.length-1)*a.width,f=m=>{let g=this._yMax-this._yMin;return a.bottom-(m-this._yMin)/g*a.height};return this._scales={xScale:p,yScale:f,chartArea:a,minVal:d,maxVal:l},{xScale:p,yScale:f,chartArea:a}}_renderLineChart(e,t,s,i){let{values:n}=this.data,{lineColor:o,lineWidth:a,showArea:c,showDots:d,dotRadius:l,curveType:h}=this.options,u="",p=n.map((g,y)=>({x:e(y),y:t(g)}));h==="smooth"&&p.length>2?u=this._smoothPath(p):u=p.map((g,y)=>`${y===0?"M":"L"} ${g.x} ${g.y}`).join(" ");let f=document.createElementNS("http://www.w3.org/2000/svg","g");if(f.classList.add("erh-chart-content"),c){let g=document.createElementNS("http://www.w3.org/2000/svg","path"),y=`${u} L ${p[p.length-1].x} ${s.bottom} L ${p[0].x} ${s.bottom} Z`;g.setAttribute("d",y),g.setAttribute("fill",`url(#areaGradient-${this._uid})`),g.classList.add("erh-chart-area"),i&&(g.style.opacity="0",g.style.transition=`opacity ${this.options.animationDuration}ms ${this.options.animationEasing}`,setTimeout(()=>g.style.opacity="1",50)),f.appendChild(g)}let m=document.createElementNS("http://www.w3.org/2000/svg","path");if(m.setAttribute("d",u),m.setAttribute("fill","none"),m.setAttribute("stroke",o),m.setAttribute("stroke-width",a),m.setAttribute("stroke-linecap","round"),m.setAttribute("stroke-linejoin","round"),m.classList.add("erh-chart-line"),i){let g=m.getTotalLength?m.getTotalLength():this._estimatePathLength(p);m.style.strokeDasharray=g,m.style.strokeDashoffset=g,m.style.transition=`stroke-dashoffset ${this.options.animationDuration}ms ${this.options.animationEasing}`,requestAnimationFrame(()=>{m.style.strokeDashoffset="0"})}if(f.appendChild(m),d){let g=document.createElementNS("http://www.w3.org/2000/svg","g");g.classList.add("erh-chart-dots"),p.forEach((y,v)=>{let w=document.createElementNS("http://www.w3.org/2000/svg","circle");w.setAttribute("cx",y.x),w.setAttribute("cy",y.y),w.setAttribute("r",l),w.setAttribute("fill",o),w.classList.add("erh-chart-dot"),i&&(w.style.opacity="0",w.style.transition="opacity 0.2s ease",setTimeout(()=>{w.style.opacity="1"},v/p.length*this.options.animationDuration+this.options.animationDuration*.5)),g.appendChild(w)}),f.appendChild(g)}this.svg.appendChild(f)}_smoothPath(e){if(e.length<2)return"";let t=`M ${e[0].x} ${e[0].y}`;for(let s=0;s<e.length-1;s++){let i=e[Math.max(0,s-1)],n=e[s],o=e[s+1],a=e[Math.min(e.length-1,s+2)],c=n.x+(o.x-i.x)/6,d=n.y+(o.y-i.y)/6,l=o.x-(a.x-n.x)/6,h=o.y-(a.y-n.y)/6;t+=` C ${c} ${d}, ${l} ${h}, ${o.x} ${o.y}`}return t}_estimatePathLength(e){let t=0;for(let s=1;s<e.length;s++){let i=e[s].x-e[s-1].x,n=e[s].y-e[s-1].y;t+=Math.sqrt(i*i+n*n)}return t}_renderBarChart(e,t,s,i){let{values:n}=this.data,{barColor:o,barRadius:a,barGap:c}=this.options,d=s.width/n.length*(1-c),l=s.width/n.length*c,h=document.createElementNS("http://www.w3.org/2000/svg","g");h.classList.add("erh-chart-bars"),n.forEach((u,p)=>{let f=s.left+p*(d+l)+l/2,m=t(u),g=s.bottom-m,y=document.createElementNS("http://www.w3.org/2000/svg","rect");y.setAttribute("x",f),y.setAttribute("width",d),y.setAttribute("fill",o),y.setAttribute("rx",a),y.classList.add("erh-chart-bar"),i?(y.setAttribute("y",s.bottom),y.setAttribute("height",0),y.style.transition=`y ${this.options.animationDuration}ms ${this.options.animationEasing},
                                       height ${this.options.animationDuration}ms ${this.options.animationEasing}`,setTimeout(()=>{y.setAttribute("y",m),y.setAttribute("height",g)},p*50)):(y.setAttribute("y",m),y.setAttribute("height",g)),h.appendChild(y)}),this.svg.appendChild(h)}_renderXAxis(e,t){let{dates:s}=this.data,{textColor:i,xAxisHeight:n}=this.options,o=document.createElementNS("http://www.w3.org/2000/svg","g");if(o.classList.add("erh-chart-x-axis"),!s||s.length<2){this.svg.appendChild(o);return}let a=Math.max(4,Math.min(10,Math.floor(t.width/70))),c=s.length,d=t.width/a,l=d/2,h=this._parseDate(s[0]),u=this._parseDate(s[s.length-1]),p=this._daysBetween(h,u);for(let f=0;f<a;f++){let m=t.left+l+d*f,g=Math.round((m-t.left)/t.width*(c-1)),y=Math.max(0,Math.min(c-1,g)),v=e(y),w=s[y],b=this._formatDateLabel(w,p),k=document.createElementNS("http://www.w3.org/2000/svg","text");k.setAttribute("x",v),k.setAttribute("y",t.bottom+n-4),k.setAttribute("text-anchor","middle"),k.setAttribute("fill",i),k.setAttribute("font-size","11"),k.textContent=b,o.appendChild(k)}this.svg.appendChild(o)}_parseDate(e){let t=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],s=e.match(/(\w+)\s+(\d+),\s+(\d+)/);return s?{month:t.indexOf(s[1]),day:parseInt(s[2]),year:parseInt(s[3])}:null}_daysBetween(e,t){if(!e||!t)return 0;let s=new Date(e.year,e.month,e.day),i=new Date(t.year,t.month,t.day);return Math.abs((i-s)/(1e3*60*60*24))}_formatDateLabel(e,t){let s=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],i=this._parseDate(e);return i?t<=90?`${i.day} ${s[i.month]}`:t<=180?s[i.month]:`${s[i.month]} '${String(i.year).slice(-2)}`:e}_renderYAxis(e,t){let{textColor:s,yAxisWidth:i,yAxisInside:n,yTickCount:o}=this.options,a=document.createElementNS("http://www.w3.org/2000/svg","g");a.classList.add("erh-chart-y-axis"),this._generateTicks(this._yMin,this._yMax,o).forEach(d=>{let l=e(d);if(l>t.bottom-12||l<t.top+2)return;let h=document.createElementNS("http://www.w3.org/2000/svg","text");n?(h.setAttribute("x",t.left+8),h.setAttribute("y",l+4),h.setAttribute("text-anchor","start")):(h.setAttribute("x",i-8),h.setAttribute("y",l+4),h.setAttribute("text-anchor","end")),h.setAttribute("fill",s),h.setAttribute("font-size","11"),h.setAttribute("opacity","0.7"),h.textContent=this.options.formatValue(Math.round(d),this.options.currency),a.appendChild(h)}),this.svg.appendChild(a)}_renderGrid(e,t){let{gridColor:s}=this.options,{minVal:i,maxVal:n}=this._scales,o=document.createElementNS("http://www.w3.org/2000/svg","g");o.classList.add("erh-chart-grid"),this._generateTicks(i,n,4).forEach(d=>{let l=e(d),h=document.createElementNS("http://www.w3.org/2000/svg","line");h.setAttribute("x1",t.left),h.setAttribute("x2",t.right),h.setAttribute("y1",l),h.setAttribute("y2",l),h.setAttribute("stroke",s),h.setAttribute("stroke-dasharray","2,4"),o.appendChild(h)});let c=this.svg.querySelector(".erh-chart-content, .erh-chart-bars");c?this.svg.insertBefore(o,c):this.svg.appendChild(o)}_generateTicks(e,t,s){let n=(t-e)/(s-1),o=[];for(let a=0;a<s;a++)o.push(Math.round(e+n*a));return o}_addInteractionLayer(e,t,s){let{values:i,labels:n}=this.data,o=document.createElementNS("http://www.w3.org/2000/svg","rect");o.setAttribute("x",s.left),o.setAttribute("y",s.top),o.setAttribute("width",s.width),o.setAttribute("height",s.height),o.setAttribute("fill","transparent"),o.classList.add("erh-chart-overlay"),o.style.cursor="crosshair";let a=document.createElementNS("http://www.w3.org/2000/svg","line");a.setAttribute("y1",s.top),a.setAttribute("y2",s.bottom),a.setAttribute("stroke",this.options.lineColor),a.setAttribute("stroke-width","1"),a.setAttribute("stroke-dasharray","4,4"),a.style.opacity="0",a.style.transition="opacity 0.15s ease",a.classList.add("erh-chart-hover-line");let c=document.createElementNS("http://www.w3.org/2000/svg","circle");c.setAttribute("r",5),c.setAttribute("fill","#fff"),c.setAttribute("stroke",this.options.lineColor),c.setAttribute("stroke-width","2"),c.style.opacity="0",c.style.transition="opacity 0.15s ease",c.classList.add("erh-chart-hover-dot"),this.svg.appendChild(a),this.svg.appendChild(c),this.svg.appendChild(o),o.addEventListener("mousemove",d=>{let l=this.svg.getBoundingClientRect(),h=d.clientX-l.left,u=Math.round((h-s.left)/s.width*(i.length-1)),p=Math.max(0,Math.min(i.length-1,u)),f=e(p),m=t(i[p]);a.setAttribute("x1",f),a.setAttribute("x2",f),a.style.opacity="0.5",c.setAttribute("cx",f),c.setAttribute("cy",m),c.style.opacity="1",this._showTooltip(f,m,p,l)}),o.addEventListener("mouseleave",()=>{a.style.opacity="0",c.style.opacity="0",this._hideTooltip()})}_showTooltip(e,t,s,i){if(!this.tooltip)return;let n=this.data.values[s],o=this.options.formatValue(n,this.options.currency),a=this.data.dates?.[s]||this.data.labels?.[s]||"",c=this.options.formatLabel(a),d=this.data.stores?.[s]||"",l=`<div class="erh-chart-tooltip-value">${o}</div>`;d&&(l+=`<div class="erh-chart-tooltip-store">at ${d}</div>`),c&&(l+=`<div class="erh-chart-tooltip-date">${c}</div>`),this.tooltip.innerHTML=l;let h=this.tooltip.getBoundingClientRect(),u=e-h.width/2,p=t-h.height-12;u=Math.max(0,Math.min(this.width-h.width,u)),p<0&&(p=t+12),this.tooltip.style.left=`${u}px`,this.tooltip.style.top=`${p}px`,this.tooltip.style.visibility="visible",this.tooltip.style.opacity="1"}_hideTooltip(){this.tooltip&&(this.tooltip.style.opacity="0",this.tooltip.style.visibility="hidden")}destroy(){this.resizeObserver&&this.resizeObserver.disconnect(),this.intersectionObserver&&this.intersectionObserver.disconnect(),this.svg&&this.svg.remove(),this.tooltip&&this.tooltip.remove()}};_a={create:Ze,autoInit:ti,setupPeriodToggles:Xr}});function ii(){document.addEventListener("click",r=>{let e=r.target.closest('[data-auth-trigger="login"], .btn-login'),t=r.target.closest('[data-auth-trigger="signup"], .btn-signup');e&&(r.preventDefault(),$t.open({initialState:"signin"})),t&&(r.preventDefault(),$t.open({initialState:"signup"}))})}var si,nr,Jr,$t,ni=P(()=>{Ue();Ie();xe();si=te(),nr="erh_pending_action",Jr=class{constructor(){this.modal=null,this.currentState="signin",this.onSuccessCallback=null,this.isSubmitting=!1}open(e={}){let{initialState:t="signin",onSuccess:s=null}=e;this.currentState=t,this.onSuccessCallback=s,this.modal||this.createModal(),this.renderState(t),this.modal.open()}openForAction(e,t={}){sessionStorage.setItem(nr,JSON.stringify({action:e,data:t})),this.open({onSuccess:()=>{}})}close(){this.modal&&this.modal.close()}createModal(){let e=document.createElement("div");e.className="modal auth-modal",e.id="auth-modal",e.setAttribute("role","dialog"),e.setAttribute("aria-modal","true"),e.innerHTML=`
            <div class="modal-content modal-content--sm">
                <button class="modal-close" data-modal-close aria-label="Close">
                    <svg class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <line x1="18" y1="6" x2="6" y2="18"></line>
                        <line x1="6" y1="6" x2="18" y2="18"></line>
                    </svg>
                </button>
                <div class="auth-modal-body"></div>
            </div>
        `,document.body.appendChild(e),this.modal=new le(e),this.bodyEl=e.querySelector(".auth-modal-body"),e.addEventListener("click",t=>{let s=t.target.closest("[data-auth-switch]");s&&(t.preventDefault(),this.renderState(s.dataset.authSwitch));let i=t.target.closest("[data-social-provider]");i&&this.handleSocialLogin(i.dataset.socialProvider)}),e.addEventListener("submit",t=>{t.preventDefault();let s=t.target;s.dataset.authForm&&this.handleFormSubmit(s.dataset.authForm,s)})}renderState(e){this.currentState=e;let t={signin:this.getSignInHTML(),signup:this.getSignUpHTML(),forgot:this.getForgotHTML(),"forgot-sent":this.getForgotSentHTML()};this.bodyEl.innerHTML=t[e]||t.signin;let s=this.bodyEl.querySelector(".auth-modal-title");s&&(s.id="auth-modal-title",this.modal.element.setAttribute("aria-labelledby","auth-modal-title")),setTimeout(()=>{let i=this.bodyEl.querySelector('input:not([type="hidden"])');i&&i.focus()},100)}getSignInHTML(){return`
            <div class="auth-modal-header">
                <h2 class="auth-modal-title">Welcome back</h2>
                <p class="auth-modal-subtitle">Sign in to your account to continue</p>
            </div>

            <div class="auth-modal-social">
                <button type="button" class="auth-social-btn" data-social-provider="google">
                    <svg class="auth-social-icon" viewBox="0 0 24 24">
                        <path d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z" fill="#4285F4"/>
                        <path d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z" fill="#34A853"/>
                        <path d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z" fill="#FBBC05"/>
                        <path d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z" fill="#EA4335"/>
                    </svg>
                    Continue with Google
                </button>
                <button type="button" class="auth-social-btn" data-social-provider="facebook">
                    <svg class="auth-social-icon" viewBox="0 0 24 24" fill="#1877F2">
                        <path d="M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z"/>
                    </svg>
                    Continue with Facebook
                </button>
                <button type="button" class="auth-social-btn" data-social-provider="reddit">
                    <svg class="auth-social-icon" viewBox="0 0 24 24" fill="#FF4500">
                        <path d="M12 0A12 12 0 0 0 0 12a12 12 0 0 0 12 12 12 12 0 0 0 12-12A12 12 0 0 0 12 0zm5.01 4.744c.688 0 1.25.561 1.25 1.249a1.25 1.25 0 0 1-2.498.056l-2.597-.547-.8 3.747c1.824.07 3.48.632 4.674 1.488.308-.309.73-.491 1.207-.491.968 0 1.754.786 1.754 1.754 0 .716-.435 1.333-1.01 1.614a3.111 3.111 0 0 1 .042.52c0 2.694-3.13 4.87-7.004 4.87-3.874 0-7.004-2.176-7.004-4.87 0-.183.015-.366.043-.534A1.748 1.748 0 0 1 4.028 12c0-.968.786-1.754 1.754-1.754.463 0 .898.196 1.207.49 1.207-.883 2.878-1.43 4.744-1.487l.885-4.182a.342.342 0 0 1 .14-.197.35.35 0 0 1 .238-.042l2.906.617a1.214 1.214 0 0 1 1.108-.701zM9.25 12C8.561 12 8 12.562 8 13.25c0 .687.561 1.248 1.25 1.248.687 0 1.248-.561 1.248-1.249 0-.688-.561-1.249-1.249-1.249zm5.5 0c-.687 0-1.248.561-1.248 1.25 0 .687.561 1.248 1.249 1.248.688 0 1.249-.561 1.249-1.249 0-.687-.562-1.249-1.25-1.249zm-5.466 3.99a.327.327 0 0 0-.231.094.33.33 0 0 0 0 .463c.842.842 2.484.913 2.961.913.477 0 2.105-.056 2.961-.913a.361.361 0 0 0 .029-.463.33.33 0 0 0-.464 0c-.547.533-1.684.73-2.512.73-.828 0-1.979-.196-2.512-.73a.326.326 0 0 0-.232-.095z"/>
                    </svg>
                    Continue with Reddit
                </button>
            </div>

            <div class="auth-modal-divider">
                <span>or continue with email</span>
            </div>

            <form class="auth-modal-form" data-auth-form="signin">
                <div class="auth-modal-field">
                    <label for="signin-email" class="auth-modal-label">Email address</label>
                    <input type="email" id="signin-email" name="email" class="auth-modal-input" placeholder="you@example.com" required>
                </div>

                <div class="auth-modal-field">
                    <div class="auth-modal-label-row">
                        <label for="signin-password" class="auth-modal-label">Password</label>
                        <a href="#" class="auth-modal-forgot" data-auth-switch="forgot">Forgot password?</a>
                    </div>
                    <input type="password" id="signin-password" name="password" class="auth-modal-input" placeholder="Enter your password" required>
                </div>

                <div class="auth-modal-error" data-auth-error hidden></div>

                <button type="submit" class="btn btn-primary btn-block auth-modal-submit">
                    <span class="auth-modal-submit-text">Sign in</span>
                    <span class="auth-modal-submit-loading" hidden>
                        <svg class="spinner" viewBox="0 0 24 24"><circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="3" fill="none" stroke-dasharray="31.4" stroke-linecap="round"/></svg>
                    </span>
                </button>
            </form>

            <p class="auth-modal-toggle">
                Don't have an account? <a href="#" data-auth-switch="signup">Create one for free</a>
            </p>
        `}getSignUpHTML(){return`
            <a href="#" class="auth-modal-back" data-auth-switch="signin">
                <svg width="20" height="20" viewBox="0 0 20 20" fill="none">
                    <path d="M12.5 15L7.5 10L12.5 5" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
                Back to sign in
            </a>

            <div class="auth-modal-header">
                <h2 class="auth-modal-title">Create your account</h2>
                <p class="auth-modal-subtitle">Join thousands of riders tracking prices</p>
            </div>

            <div class="auth-modal-social">
                <button type="button" class="auth-social-btn" data-social-provider="google">
                    <svg class="auth-social-icon" viewBox="0 0 24 24">
                        <path d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z" fill="#4285F4"/>
                        <path d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z" fill="#34A853"/>
                        <path d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z" fill="#FBBC05"/>
                        <path d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z" fill="#EA4335"/>
                    </svg>
                    Continue with Google
                </button>
                <button type="button" class="auth-social-btn" data-social-provider="facebook">
                    <svg class="auth-social-icon" viewBox="0 0 24 24" fill="#1877F2">
                        <path d="M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z"/>
                    </svg>
                    Continue with Facebook
                </button>
                <button type="button" class="auth-social-btn" data-social-provider="reddit">
                    <svg class="auth-social-icon" viewBox="0 0 24 24" fill="#FF4500">
                        <path d="M12 0A12 12 0 0 0 0 12a12 12 0 0 0 12 12 12 12 0 0 0 12-12A12 12 0 0 0 12 0zm5.01 4.744c.688 0 1.25.561 1.25 1.249a1.25 1.25 0 0 1-2.498.056l-2.597-.547-.8 3.747c1.824.07 3.48.632 4.674 1.488.308-.309.73-.491 1.207-.491.968 0 1.754.786 1.754 1.754 0 .716-.435 1.333-1.01 1.614a3.111 3.111 0 0 1 .042.52c0 2.694-3.13 4.87-7.004 4.87-3.874 0-7.004-2.176-7.004-4.87 0-.183.015-.366.043-.534A1.748 1.748 0 0 1 4.028 12c0-.968.786-1.754 1.754-1.754.463 0 .898.196 1.207.49 1.207-.883 2.878-1.43 4.744-1.487l.885-4.182a.342.342 0 0 1 .14-.197.35.35 0 0 1 .238-.042l2.906.617a1.214 1.214 0 0 1 1.108-.701zM9.25 12C8.561 12 8 12.562 8 13.25c0 .687.561 1.248 1.25 1.248.687 0 1.248-.561 1.248-1.249 0-.688-.561-1.249-1.249-1.249zm5.5 0c-.687 0-1.248.561-1.248 1.25 0 .687.561 1.248 1.249 1.248.688 0 1.249-.561 1.249-1.249 0-.687-.562-1.249-1.25-1.249zm-5.466 3.99a.327.327 0 0 0-.231.094.33.33 0 0 0 0 .463c.842.842 2.484.913 2.961.913.477 0 2.105-.056 2.961-.913a.361.361 0 0 0 .029-.463.33.33 0 0 0-.464 0c-.547.533-1.684.73-2.512.73-.828 0-1.979-.196-2.512-.73a.326.326 0 0 0-.232-.095z"/>
                    </svg>
                    Continue with Reddit
                </button>
            </div>

            <div class="auth-modal-divider">
                <span>or continue with email</span>
            </div>

            <form class="auth-modal-form" data-auth-form="signup">
                <div class="auth-modal-field">
                    <label for="signup-email" class="auth-modal-label">Email address</label>
                    <input type="email" id="signup-email" name="email" class="auth-modal-input" placeholder="you@example.com" required>
                </div>

                <div class="auth-modal-field">
                    <label for="signup-password" class="auth-modal-label">Create password</label>
                    <input type="password" id="signup-password" name="password" class="auth-modal-input" placeholder="At least 8 characters" minlength="8" required>
                </div>

                <div class="auth-modal-error" data-auth-error hidden></div>

                <button type="submit" class="btn btn-primary btn-block auth-modal-submit">
                    <span class="auth-modal-submit-text">Create account</span>
                    <span class="auth-modal-submit-loading" hidden>
                        <svg class="spinner" viewBox="0 0 24 24"><circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="3" fill="none" stroke-dasharray="31.4" stroke-linecap="round"/></svg>
                    </span>
                </button>
            </form>

            <p class="auth-modal-legal">
                By creating an account, you agree to our <a href="/terms">Terms</a> and <a href="/privacy">Privacy Policy</a>.
            </p>
        `}getForgotHTML(){return`
            <a href="#" class="auth-modal-back" data-auth-switch="signin">
                <svg width="20" height="20" viewBox="0 0 20 20" fill="none">
                    <path d="M12.5 15L7.5 10L12.5 5" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
                Back to sign in
            </a>

            <div class="auth-modal-header">
                <h2 class="auth-modal-title">Reset your password</h2>
                <p class="auth-modal-subtitle">Enter your email and we'll send you a reset link</p>
            </div>

            <form class="auth-modal-form" data-auth-form="forgot">
                <div class="auth-modal-field">
                    <label for="forgot-email" class="auth-modal-label">Email address</label>
                    <input type="email" id="forgot-email" name="email" class="auth-modal-input" placeholder="you@example.com" required>
                </div>

                <div class="auth-modal-error" data-auth-error hidden></div>

                <button type="submit" class="btn btn-primary btn-block auth-modal-submit">
                    <span class="auth-modal-submit-text">Send reset link</span>
                    <span class="auth-modal-submit-loading" hidden>
                        <svg class="spinner" viewBox="0 0 24 24"><circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="3" fill="none" stroke-dasharray="31.4" stroke-linecap="round"/></svg>
                    </span>
                </button>
            </form>
        `}getForgotSentHTML(){return`
            <div class="auth-modal-success">
                <div class="auth-modal-success-icon">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path>
                        <polyline points="22 4 12 14.01 9 11.01"></polyline>
                    </svg>
                </div>
                <h2 class="auth-modal-title">Check your email</h2>
                <p class="auth-modal-subtitle">We've sent a password reset link to your email address. The link will expire in 24 hours.</p>
                <button type="button" class="btn btn-secondary btn-block" data-modal-close>Done</button>
            </div>
        `}async handleFormSubmit(e,t){if(this.isSubmitting)return;let s=t.querySelector(".auth-modal-submit"),i=t.querySelector(".auth-modal-submit-text"),n=t.querySelector(".auth-modal-submit-loading"),o=t.querySelector("[data-auth-error]"),a=new FormData(t),c=Object.fromEntries(a);this.isSubmitting=!0,s.disabled=!0,i.hidden=!0,n.hidden=!1,o.hidden=!0;try{let d;switch(e){case"signin":d="auth/login";break;case"signup":d="auth/register";break;case"forgot":d="auth/forgot-password";break}let l=await fetch(`${si}${d}`,{method:"POST",headers:{"Content-Type":"application/json","X-WP-Nonce":window.erhData?.nonce||""},body:JSON.stringify(c)}),h=await l.json();if(!l.ok)throw new Error(h.message||"Something went wrong");e==="forgot"?this.renderState("forgot-sent"):this.handleAuthSuccess(e,h.needsOnboarding||!1)}catch(d){o.textContent=d.message,o.hidden=!1}finally{this.isSubmitting=!1,s.disabled=!1,i.hidden=!1,n.hidden=!0}}handleSocialLogin(e){let i=(window.innerWidth-500)/2+window.screenX,n=(window.innerHeight-600)/2+window.screenY,o=window.open(`${si}auth/social/${e}`,"auth-popup",`width=500,height=600,left=${i},top=${n},popup=1`),a=d=>{d.origin===window.location.origin&&(d.data?.type==="auth-success"?(window.removeEventListener("message",a),o?.close(),this.handleAuthSuccess("social",d.data.needsOnboarding)):d.data?.type==="auth-error"&&(window.removeEventListener("message",a),o?.close(),Z.error(d.data.message||"Authentication failed")))};window.addEventListener("message",a);let c=setInterval(()=>{o?.closed&&(clearInterval(c),window.removeEventListener("message",a))},500)}handleAuthSuccess(e,t=!1){this.close(),Z.success(e==="signup"?"Account created!":"Signed in successfully"),setTimeout(()=>{if(t){let s=window.erhData?.siteUrl||"",i=encodeURIComponent(window.location.href);window.location.href=`${s}/email-preferences/?redirect=${i}`}else window.location.reload()},500)}checkPendingAction(){let e=sessionStorage.getItem(nr);if(!e)return null;try{let{action:t,data:s}=JSON.parse(e);return sessionStorage.removeItem(nr),{action:t,data:s}}catch{return sessionStorage.removeItem(nr),null}}},$t=new Jr;document.readyState==="loading"?document.addEventListener("DOMContentLoaded",ii):ii()});function ai(){if(!window.erhData?.isLoggedIn)return;let r=$t.checkPendingAction();r?.action==="price-alert"&&setTimeout(()=>{oe.open(r.data)},500)}var or,oi,Qr,oe,_e=P(()=>{Ue();Ie();fe();ni();ne();xe();or=te(),oi={US:"united-states.svg",GB:"united-kingdom.svg",EU:"european-union.svg",CA:"canada.svg",AU:"australia.svg"},Qr=class{constructor(){this.modal=null,this.productData=null,this.existingTracker=null,this.isSubmitting=!1,this.isDeleting=!1,this.alertType="target",this.userGeo=null,this.emailAlertsEnabled=!1}async open(e={}){let{productId:t,productName:s,productImage:i,currentPrice:n,currency:o}=e;if(!t){console.error("[PriceAlert] Product ID is required");return}if(!window.erhData?.isLoggedIn){$t.openForAction("price-alert",{productId:t,productName:s,productImage:i,currentPrice:n,currency:o});return}this.userGeo=await z();let a=o||this.userGeo.currency;this.productData={productId:t,productName:s,productImage:i,currentPrice:n,currency:a,symbol:$e(a)},this.modal||this.createModal(),this.renderLoading(),this.modal.open();try{let c=await fetch(`${or}products/${t}/tracker`,{headers:{"X-WP-Nonce":window.erhData?.nonce||""}});if(c.ok){let d=await c.json();this.existingTracker=d.tracker||null,this.emailAlertsEnabled=d.email_alerts_enabled??!1}else c.status===404&&(this.existingTracker=null,this.emailAlertsEnabled=!1)}catch(c){console.error("[PriceAlert] Failed to fetch tracker:",c),this.existingTracker=null,this.emailAlertsEnabled=!1}this.emailAlertsEnabled?this.renderForm():this.renderPermissionRequest()}close(){this.modal&&this.modal.close()}createModal(){let e=document.createElement("div");e.className="modal price-alert-modal",e.id="price-alert-modal",e.setAttribute("role","dialog"),e.setAttribute("aria-modal","true"),e.innerHTML=`
            <div class="modal-content modal-content--sm">
                <button class="modal-close" data-modal-close aria-label="Close">
                    <svg class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <line x1="18" y1="6" x2="6" y2="18"></line>
                        <line x1="6" y1="6" x2="18" y2="18"></line>
                    </svg>
                </button>
                <div class="price-alert-modal-body"></div>
            </div>
        `,document.body.appendChild(e),this.modal=new le(e),this.bodyEl=e.querySelector(".price-alert-modal-body"),e.addEventListener("click",t=>{let s=t.target.closest("[data-alert-type]");s&&this.setAlertType(s.dataset.alertType);let i=t.target.closest("[data-suggestion]");i&&this.applySuggestion(i.dataset.suggestion),t.target.closest("[data-delete-tracker]")&&this.confirmDelete(),t.target.closest("[data-confirm-delete]")&&this.deleteTracker(),t.target.closest("[data-cancel-delete]")&&this.renderForm();let c=t.target.closest("[data-continue-to-form]");c&&!c.disabled&&this.handleEnableAlerts(c)}),e.addEventListener("change",t=>{let s=t.target.closest("[data-enable-alerts]");if(s){let i=e.querySelector("[data-continue-to-form]");i&&(i.disabled=!s.checked)}}),e.addEventListener("submit",t=>{t.preventDefault(),this.handleSubmit(t.target)})}renderLoading(){this.bodyEl.innerHTML=`
            <div class="price-alert-loading">
                <svg class="spinner" viewBox="0 0 24 24">
                    <circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="3" fill="none" stroke-dasharray="31.4" stroke-linecap="round"/>
                </svg>
            </div>
        `}renderPermissionRequest(){let{productName:e,productImage:t,currentPrice:s,symbol:i}=this.productData,n=!!this.existingTracker;this.bodyEl.innerHTML=`
            <div class="price-alert-header">
                <h2 class="price-alert-title">Enable price alerts</h2>
            </div>

            <div class="price-alert-product">
                ${t?`<img src="${t}" alt="" class="price-alert-product-img">`:""}
                <div class="price-alert-product-info">
                    <span class="price-alert-product-name">${F(e||"Product")}</span>
                    <span class="price-alert-product-price">
                        Current price: ${i}${this.formatPriceValue(s)}
                    </span>
                </div>
            </div>

            <div class="price-alert-permission">
                <p class="price-alert-permission-text">
                    ${n?"You've disabled price alert emails in your settings. Re-enable them to continue receiving notifications for this tracker.":"To track prices and get notified when they drop, enable email notifications."}
                </p>

                <label class="price-alert-permission-toggle">
                    <input type="checkbox" data-enable-alerts>
                    <span class="price-alert-permission-checkbox">
                        <svg class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <polyline points="20 6 9 17 4 12"></polyline>
                        </svg>
                    </span>
                    <span class="price-alert-permission-label">
                        <strong>I want to receive price alert emails</strong>
                        <span>We'll notify you when this product's price drops.</span>
                    </span>
                </label>

                <div class="price-alert-permission-actions">
                    <button type="button" class="btn btn-primary btn-block" data-continue-to-form disabled>
                        <span class="price-alert-permission-btn-text">Continue</span>
                        <span class="price-alert-permission-btn-loading" hidden>
                            <svg class="spinner" viewBox="0 0 24 24"><circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="3" fill="none" stroke-dasharray="31.4" stroke-linecap="round"/></svg>
                        </span>
                    </button>
                </div>
            </div>
        `}async handleEnableAlerts(e){let t=e.querySelector(".price-alert-permission-btn-text"),s=e.querySelector(".price-alert-permission-btn-loading");e.disabled=!0,t&&(t.style.visibility="hidden"),s&&(s.hidden=!1);try{if(!(await fetch(`${or}user/preferences`,{method:"PUT",headers:{"Content-Type":"application/json","X-WP-Nonce":window.erhData?.nonce||""},body:JSON.stringify({price_tracker_emails:!0})})).ok)throw new Error("Failed to enable notifications");this.emailAlertsEnabled=!0,this.renderForm()}catch(i){Z.error(i.message),e.disabled=!1,t&&(t.style.visibility=""),s&&(s.hidden=!0)}}renderForm(){let e=!!this.existingTracker,{productName:t,productImage:s,currentPrice:i,symbol:n}=this.productData,o=this.userGeo?.geo||"US",a,c,d,l="";if(e){let m=this.existingTracker.geo||"US",g=this.existingTracker.currency||"USD";c=$e(g);let v=this.existingTracker.live_price&&(!this.existingTracker.live_currency||this.existingTracker.live_currency===g)?this.existingTracker.live_price:this.existingTracker.current_price||this.existingTracker.start_price;if(d=v?parseFloat(v):null,m!==o){let b={US:"US",GB:"UK",EU:"EU",CA:"Canada",AU:"Australia"}[m]||m,k=oi[m]||oi.US;l=`
                    <div class="price-alert-geo-notice">
                        <svg class="icon price-alert-geo-notice-icon" aria-hidden="true"><use href="#icon-info"></use></svg>
                        <span>You're tracking <img src="${(window.erhData?.themeUrl||"")+"/assets/images/countries/"+k}" alt="" class="price-alert-geo-flag"> <strong>${b}</strong> prices for this product. To track prices in your current region, delete this alert and create a new one.</span>
                    </div>
                `}}else c=n||"$",d=i;let h=c,u="",p="";e?this.existingTracker.target_price?(this.alertType="target",u=this.existingTracker.target_price):this.existingTracker.price_drop&&(this.alertType="drop",p=this.existingTracker.price_drop):(this.alertType="target",u=d?Math.max(0,d-50).toFixed(0):"");let f="";if(e&&this.existingTracker.start_price&&d){let m=this.existingTracker.start_price-d;m!==0&&(f=`<svg class="icon price-alert-change-icon" aria-hidden="true"><use href="#icon-${m>0?"arrow-down":"arrow-up"}"></use></svg> ${h}${this.formatPriceValue(Math.abs(m))} since you started tracking`)}this.bodyEl.innerHTML=`
            <div class="price-alert-header">
                <h2 class="price-alert-title">${e?"Edit price alert":"Set price alert"}</h2>
            </div>

            ${l}

            <div class="price-alert-product">
                ${s?`<img src="${s}" alt="" class="price-alert-product-img">`:""}
                <div class="price-alert-product-info">
                    <span class="price-alert-product-name">${F(t||"Product")}</span>
                    <span class="price-alert-product-price">
                        Current price: ${h}${this.formatPriceValue(d)}
                        ${f?`<span class="price-alert-price-change">${f}</span>`:""}
                    </span>
                </div>
            </div>

            <form class="price-alert-form">
                <div class="price-alert-type-label">Alert me when price:</div>

                <div class="price-alert-toggle">
                    <button type="button" class="price-alert-toggle-btn ${this.alertType==="target"?"is-active":""}" data-alert-type="target">
                        Reaches target
                    </button>
                    <button type="button" class="price-alert-toggle-btn ${this.alertType==="drop"?"is-active":""}" data-alert-type="drop">
                        Drops by amount
                    </button>
                </div>

                <div class="price-alert-input-group" data-input-group="target" ${this.alertType!=="target"?"hidden":""}>
                    <label class="price-alert-label">Target price</label>
                    <div class="price-alert-input-wrapper">
                        <span class="price-alert-input-prefix">${h}</span>
                        <input type="number" name="target_price" class="price-alert-input" placeholder="0.00" min="0.01" step="0.01" value="${u}">
                    </div>
                    <div class="price-alert-suggestions">
                        ${i?`
                            <button type="button" class="price-alert-suggestion" data-suggestion="${Math.max(0,i-50)}">-${h}50</button>
                            <button type="button" class="price-alert-suggestion" data-suggestion="${Math.max(0,i-100)}">-${h}100</button>
                            <button type="button" class="price-alert-suggestion" data-suggestion="${Math.max(0,i-150)}">-${h}150</button>
                        `:""}
                    </div>
                </div>

                <div class="price-alert-input-group" data-input-group="drop" ${this.alertType!=="drop"?"hidden":""}>
                    <label class="price-alert-label">Drop amount</label>
                    <div class="price-alert-input-wrapper">
                        <span class="price-alert-input-prefix">${h}</span>
                        <input type="number" name="price_drop" class="price-alert-input" placeholder="0.00" min="0.01" step="0.01" value="${p}">
                    </div>
                    <div class="price-alert-suggestions">
                        <button type="button" class="price-alert-suggestion" data-suggestion="50">${h}50</button>
                        <button type="button" class="price-alert-suggestion" data-suggestion="100">${h}100</button>
                        <button type="button" class="price-alert-suggestion" data-suggestion="150">${h}150</button>
                    </div>
                </div>

                <div class="price-alert-error" data-error hidden></div>

                <button type="submit" class="btn btn-primary btn-block price-alert-submit">
                    <span class="price-alert-submit-text">${e?"Update alert":"Create alert"}</span>
                    <span class="price-alert-submit-loading" hidden>
                        <svg class="spinner" viewBox="0 0 24 24"><circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="3" fill="none" stroke-dasharray="31.4" stroke-linecap="round"/></svg>
                    </span>
                </button>

                ${e?`
                    <button type="button" class="btn btn-error btn-block" data-delete-tracker>
                        Delete this alert
                    </button>
                `:""}
            </form>
        `}renderDeleteConfirmation(){let{productName:e}=this.productData;this.bodyEl.innerHTML=`
            <div class="price-alert-confirm-delete">
                <div class="price-alert-confirm-icon">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M3 6h18"></path>
                        <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path>
                    </svg>
                </div>
                <h3 class="price-alert-confirm-title">Delete price alert?</h3>
                <p class="price-alert-confirm-text">
                    You'll no longer receive notifications when the price of <strong>${F(e||"this product")}</strong> drops.
                </p>
                <div class="price-alert-confirm-actions">
                    <button type="button" class="btn btn-secondary" data-cancel-delete>Cancel</button>
                    <button type="button" class="btn btn-error" data-confirm-delete>
                        <span class="price-alert-delete-text">Delete</span>
                        <span class="price-alert-delete-loading" hidden>
                            <svg class="spinner" viewBox="0 0 24 24"><circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="3" fill="none" stroke-dasharray="31.4" stroke-linecap="round"/></svg>
                        </span>
                    </button>
                </div>
            </div>
        `}setAlertType(e){this.alertType=e,this.bodyEl.querySelectorAll(".price-alert-toggle-btn").forEach(s=>{s.classList.toggle("is-active",s.dataset.alertType===e)}),this.bodyEl.querySelectorAll("[data-input-group]").forEach(s=>{s.hidden=s.dataset.inputGroup!==e});let t=this.bodyEl.querySelector(`[data-input-group="${e}"] input`);t&&t.focus()}applySuggestion(e){let s=this.bodyEl.querySelector(`[data-input-group="${this.alertType}"]`)?.querySelector("input");s&&(s.value=e,s.focus())}async handleSubmit(e){if(this.isSubmitting)return;let t=new FormData(e),s=e.querySelector(".price-alert-submit"),i=e.querySelector(".price-alert-submit-text"),n=e.querySelector(".price-alert-submit-loading"),o=e.querySelector("[data-error]"),a=this.alertType==="target"?t.get("target_price"):t.get("price_drop"),c=parseFloat(a);if(!a||a.trim()===""||isNaN(c)||c<=0){o.textContent="Please enter a valid amount greater than zero.",o.hidden=!1;return}let d=this.productData.currentPrice;if(this.alertType==="target"&&d&&c>=d){o.textContent=`Target price must be lower than ${this.productData.symbol}${this.formatPriceValue(d)}.`,o.hidden=!1;return}if(this.alertType==="drop"&&d&&c>=d){o.textContent="Drop amount must be less than the current price.",o.hidden=!1;return}this.isSubmitting=!0,s.disabled=!0,i.style.visibility="hidden",n.hidden=!1,o.hidden=!0;try{let l=this.alertType==="target"?"target_price":"price_drop",h={product_id:this.productData.productId,tracker_type:l,geo:this.userGeo?.geo||"US",currency:this.productData.currency||this.userGeo?.currency||"USD",...this.alertType==="target"?{target_price:c}:{price_drop:c}},u=!!this.existingTracker,p=u?`user/trackers/${this.existingTracker.id}`:"user/trackers",f=await fetch(`${or}${p}`,{method:u?"PUT":"POST",headers:{"Content-Type":"application/json","X-WP-Nonce":window.erhData?.nonce||""},body:JSON.stringify(h)}),m=await f.json();if(!f.ok)throw new Error(m.message||"Failed to save alert");this.close(),Z.success(u?"Price alert updated":"Price alert created"),window.dispatchEvent(new CustomEvent("priceAlert:saved",{detail:{productId:this.productData.productId,tracker:m.tracker}}))}catch(l){o.textContent=l.message,o.hidden=!1}finally{this.isSubmitting=!1,s.disabled=!1,i.style.visibility="",n.hidden=!0}}confirmDelete(){this.renderDeleteConfirmation()}async deleteTracker(){if(this.isDeleting||!this.existingTracker)return;let e=this.bodyEl.querySelector("[data-confirm-delete]"),t=e?.querySelector(".price-alert-delete-text"),s=e?.querySelector(".price-alert-delete-loading");this.isDeleting=!0,e&&(e.disabled=!0),t&&(t.style.visibility="hidden"),s&&(s.hidden=!1);try{let i=await fetch(`${or}user/trackers/${this.existingTracker.id}`,{method:"DELETE",headers:{"X-WP-Nonce":window.erhData?.nonce||""}});if(!i.ok){let n=await i.json();throw new Error(n.message||"Failed to delete alert")}this.close(),Z.success("Price alert deleted"),window.dispatchEvent(new CustomEvent("priceAlert:deleted",{detail:{productId:this.productData.productId}}))}catch(i){Z.error(i.message),this.renderForm()}finally{this.isDeleting=!1}}formatPriceValue(e){return e==null?"--":e.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})}},oe=new Qr;document.readyState==="loading"?document.addEventListener("DOMContentLoaded",ai):ai()});function dt(r,e,t={}){let{threshold:s=Ba}=t;if(!e||e<=0||!r)return null;let i=(r-e)/e*100;return Math.abs(i)<=s?{percent:0,type:"neutral",text:"",shouldShow:!1}:i<0?{percent:Math.abs(Math.round(i)),type:"below",text:`${Math.abs(Math.round(i))}% below avg`,shouldShow:!0}:{percent:Math.round(i),type:"above",text:`${Math.round(i)}% above avg`,shouldShow:!0}}function ci(r,e={}){let{isBest:t=!1,currency:s="USD",classPrefix:i="price-intel"}=e,n=t?`${i}-retailer-row--best`:"",o=r.in_stock?`${i}-retailer-stock--in`:`${i}-retailer-stock--out`,a=r.in_stock?"check":"x",c=r.in_stock?"In stock":"Out of stock",d=F(r.retailer),l=r.logo_url&&String(r.logo_url).startsWith("http")?r.logo_url:"",h=l?`<img src="${l}" alt="${d}" class="${i}-retailer-logo">`:`<span class="${i}-retailer-logo-text">${d}</span>`,u=t?`<span class="${i}-retailer-badge">Best price</span>`:"";return`
        <a href="${se(r.tracked_url||r.url)||"#"}" class="${i}-retailer-row ${n}" target="_blank" rel="sponsored noopener">
            ${h}
            <div class="${i}-retailer-info">
                <span class="${i}-retailer-name">${d}</span>
                <span class="${i}-retailer-stock ${o}">
                    <svg class="icon" aria-hidden="true"><use href="#icon-${a}"></use></svg>
                    ${c}
                </span>
            </div>
            <div class="${i}-retailer-price">
                <span class="${i}-retailer-amount">${_(r.price,s)}</span>
                ${u}
            </div>
            <svg class="icon ${i}-retailer-arrow" aria-hidden="true"><use href="#icon-external-link"></use></svg>
        </a>
    `}function li(r){let e=Math.abs(Math.round(r||0));if(e===0)return null;let t=r>0;return{percent:e,type:t?"below":"above",text:`${e}%`,icon:t?"arrow-down":"arrow-up"}}var Ba,At=P(()=>{ne();fe();Ba=3});var pi={};j(pi,{default:()=>Oa,initPriceIntel:()=>Zr});function me(r,e=null){Na&&console.log("[PriceIntel]",r,e||"")}function Zr(){document.querySelectorAll("[data-price-intel]").forEach(e=>{new cr(e)})}async function ui(){let r=document.querySelectorAll("[data-alternatives]");if(r.length===0)return;let e=await z(),t=e.geo,s=e.currency;r.forEach(i=>{try{let n=JSON.parse(i.dataset.alternatives);if(!n||!Array.isArray(n))return;let o=i.querySelector(".discontinued-alternatives-grid");if(!o)return;o.innerHTML=n.map(a=>{let d=(a.pricing||{})[t]||{},l=d.current_price,h=d.avg_6m,u=s,p="";if(l&&h&&h>0){let y=Math.round((l-h)/h*100);y<-5?p=`
                            <span class="discontinued-alternative-indicator discontinued-alternative-indicator--below">
                                <svg class="icon" aria-hidden="true"><use href="#icon-arrow-down"></use></svg>${Math.abs(y)}%
                            </span>`:y>10&&(p=`
                            <span class="discontinued-alternative-indicator discontinued-alternative-indicator--above">
                                <svg class="icon" aria-hidden="true"><use href="#icon-arrow-up"></use></svg>${y}%
                            </span>`)}let f=l?`
                    <div class="discontinued-alternative-price-row">
                        <span class="discontinued-alternative-price">${_(l,u)}</span>
                        ${p}
                    </div>`:"",m=a.image?`<img src="${a.image}" alt="" class="discontinued-alternative-img" loading="lazy">`:'<div class="discontinued-alternative-img discontinued-alternative-img--placeholder"></div>',g=a.specs?`<span class="discontinued-alternative-specs">${a.specs}</span>`:"";return`
                    <a href="${a.url}" class="discontinued-alternative-card">
                        <div class="discontinued-alternative-img-wrap">
                            ${m}
                            ${f}
                        </div>
                        <div class="discontinued-alternative-info">
                            <span class="discontinued-alternative-name">${a.name}</span>
                            ${g}
                        </div>
                    </a>`}).join("")}catch(n){console.error("[PriceIntel] Failed to parse alternatives data:",n)}})}async function hi(){let r=document.querySelectorAll("[data-successor]");if(r.length===0)return;let e=await z(),t=e.geo,s=e.currency;r.forEach(i=>{try{let n=JSON.parse(i.dataset.successor);if(!n||!n.pricing)return;let o=i.querySelector("[data-successor-price]");if(!o)return;let d=(n.pricing[t]||{}).current_price,l=s;d?o.textContent=_(d,l):o.style.display="none"}catch(n){console.error("[PriceIntel] Failed to parse successor data:",n)}})}function di(){Zr(),ui(),hi()}var Na,ar,cr,Oa,fi=P(()=>{ne();ir();_e();At();fe();Na=localStorage.getItem("erh_geo_debug")==="true"||new URLSearchParams(window.location.search).has("geo_debug");ar={"3m":"3-month","6m":"6-month","1y":"12-month",all:"All-time"};cr=class{constructor(e){this.el=e,this.productId=e.dataset.productId,this.userGeo=null,this.data=null,this.prices=[],this.priceHistory=null,this.currentPeriod="6m",this.bestPriceLink=e.querySelector("[data-best-price-link]"),this.bestPriceEl=e.querySelector("[data-best-price]"),this.bestRetailerLogo=e.querySelector("[data-best-retailer-logo]"),this.priceVerdict=e.querySelector("[data-price-verdict]"),this.buyCta=e.querySelector("[data-buy-cta]"),this.buyCtaText=e.querySelector("[data-buy-cta-text]"),this.buyCtaIcon=e.querySelector("[data-buy-cta-icon]"),this.buyCtaSpinner=e.querySelector("[data-buy-cta-spinner]"),this.updatedTime=e.querySelector("[data-updated-time]"),this.retailerList=e.querySelector("[data-retailer-list]"),this.priceHistorySection=e.querySelector("[data-price-history]"),this.periodButtons=e.querySelector("[data-period-buttons]"),this.chartContainer=e.querySelector("[data-erh-chart]"),this.chartSkeleton=e.querySelector("[data-chart-skeleton]"),this.periodLabel=e.querySelector("[data-period-label]"),this.periodAvg=e.querySelector("[data-period-avg]"),this.periodLowLabel=e.querySelector("[data-period-low-label]"),this.periodLow=e.querySelector("[data-period-low]"),this.periodLowMeta=e.querySelector("[data-period-low-meta]"),this.noPricesEl=e.querySelector("[data-no-prices]"),this.regionNotice=e.querySelector("[data-region-notice]"),this.regionNoticeText=e.querySelector("[data-region-notice-text]"),this.priceAlertBtn=e.querySelector("[data-price-alert-trigger]"),this.productName="",this.productImage="",this.currentPrice=0,this.currentCurrency="USD",this.init()}async init(){try{me("Initializing",{productId:this.productId}),this.extractProductInfo(),this.setupPriceAlertButton(),this.userGeo=await z(),me("Got user geo",this.userGeo),await this.fetchPriceData(),this.setupPeriodButtons(),me("Init complete")}catch(e){me("Init error",{error:e.message,stack:e.stack}),this.showNoPrices()}}extractProductInfo(){let e=this.el.closest("section");if(e){let t=e.querySelector(".section-product-name"),s=e.querySelector(".section-product-img");this.productName=t?.textContent?.trim()||"",this.productImage=s?.src||s?.getAttribute("data-src")||""}if(!this.productName){let t=document.querySelector(".review-header-title, h1");this.productName=t?.textContent?.trim()||""}if(!this.productImage){let t=document.querySelector(".gallery-main-img");t&&(this.productImage=t.src||t.getAttribute("data-src")||"")}if(!this.productImage){let t=document.querySelector('meta[property="og:image"]');this.productImage=t?.content||""}}setupPriceAlertButton(){this.priceAlertBtn&&this.priceAlertBtn.addEventListener("click",e=>{e.preventDefault(),e.stopPropagation(),oe.open({productId:parseInt(this.productId,10),productName:this.productName,productImage:this.productImage,currentPrice:this.currentPrice,currency:this.currentCurrency})})}async fetchPriceData(){try{me("Fetching price data",{productId:this.productId,geo:this.userGeo.geo});let e=await Fe(parseInt(this.productId,10),this.userGeo.geo);if(!e)throw me("No data returned from API"),new Error("No data returned");if(me("API response",{offers:e.offers?.length,hasHistory:!!e.history}),this.data=e,!e.offers||e.offers.length===0){me("No offers in response",{hasFallback:!!e.fallback}),e.fallback&&e.fallback.offers?.length>0?this.showReferencePricing(e.fallback):this.showNoPrices();return}if(me("Filtering offers",{totalOffers:e.offers.length,userGeo:this.userGeo}),this.prices=Xe(e.offers,this.userGeo),me("Filtered offers",{count:this.prices.length,offers:this.prices}),this.prices.length===0){me("No offers after geo filtering",{hasFallback:!!e.fallback}),e.fallback&&e.fallback.offers?.length>0?this.showReferencePricing(e.fallback):this.showNoPrices();return}me("Rendering prices"),this.renderPrices(),e.history&&e.history.data&&e.history.data.length>0&&!e.history.used_fallback?(me("Rendering price history",{points:e.history.data.length}),this.priceHistory={history:e.history.data,currency_symbol:e.history.currency_symbol,statistics:e.history.statistics,used_fallback:!1,available_geos:e.history.available_geos},this.renderPriceHistory()):(me("No local price history",{usedFallback:e.history?.used_fallback}),this.showNoPriceHistory())}catch(e){me("fetchPriceData error",{error:e.message,stack:e.stack}),this.showNoPrices()}}renderPrices(){if(this.prices.length===0){this.showNoPrices();return}let e=this.prices[0],t=e.currency||"USD",s=$e(t);this.currentPrice=e.price||0,this.currentCurrency=t,this.updateHeroPrice(e,t),this.bestPriceEl&&(this.bestPriceEl.textContent=_(e.price,t)),this.bestPriceLink&&(this.bestPriceLink.href=se(e.tracked_url||e.url)||"#"),this.bestRetailerLogo&&(e.logo_url?this.bestRetailerLogo.innerHTML=`<img src="${e.logo_url}" alt="${e.retailer}" class="price-intel-retailer-logo">`:this.bestRetailerLogo.innerHTML=`<span class="price-intel-retailer-name">${e.retailer}</span>`),this.buyCta&&(this.buyCta.href=se(e.tracked_url||e.url)||"#"),this.buyCtaText&&(this.buyCtaText.textContent=`Buy at ${e.retailer}`,this.buyCtaText.style.display=""),this.buyCtaIcon&&(this.buyCtaIcon.style.display=""),this.buyCtaSpinner&&(this.buyCtaSpinner.style.display="none"),this.updatedTime&&e.last_updated&&(this.updatedTime.textContent=`Updated ${this.formatTimeAgo(e.last_updated)}`),this.renderRetailerList()}renderRetailerList(){if(!this.retailerList||this.prices.length===0)return;let t=this.prices[0].currency||"USD",s=this.prices.map((i,n)=>ci(i,{isBest:n===0,currency:t,classPrefix:"price-intel"})).join("");this.retailerList.innerHTML=s}updateHeroPrice(e,t){let s=document.querySelector("[data-hero-price]");if(!s)return;let i=s.querySelector(".hero-price-amount"),n=s.querySelector(".hero-price-stores");if(i&&e?.price){i.textContent=_(e.price,t),s.classList.add("has-price");let o=this.prices.filter(a=>a.in_stock===!0).length;n&&o>0&&(n.textContent=o===1?"at 1 store":`at ${o} stores`)}else i&&(i.textContent="See prices",s.classList.add("no-price"))}renderPriceHistory(){if(!this.priceHistory||!this.priceHistory.history||this.priceHistory.history.length===0){this.hidePriceHistory();return}let e=this.priceHistory.history,t=this.priceHistory.currency_symbol||"$";if(e.length===0){this.hidePriceHistory();return}this.chartSkeleton&&this.chartSkeleton.remove(),this.priceHistory.used_fallback&&this.regionNotice&&this.showRegionNotice("Showing US price history. Local price history not yet available.");let s=this.prepareChartData(e);this.initChart(s,t),this.updateStatsFromServer(t)}hidePriceHistory(){this.priceHistorySection&&(this.priceHistorySection.style.display="none")}prepareChartData(e){let t=new Date,s={"3m":90,"6m":180,"1y":365,all:1/0},i={};return Object.keys(s).forEach(n=>{let o=s[n],a=o===1/0?new Date(0):new Date(t-o*24*60*60*1e3),c=e.filter(d=>new Date(d.x||d.date)>=a);i[n]={values:c.map(d=>d.y),dates:c.map(d=>this.formatChartDate(d.x||d.date)),stores:c.map(d=>d.domain||""),raw:c}}),i}initChart(e,t){if(!this.chartContainer)return;let s=e[this.currentPeriod];!s||s.values.length===0||(this.chart=Ze(this.chartContainer,{currency:this.currentCurrency,lineColor:"#5e2ced",areaColor:"rgba(94, 44, 237, 0.1)",showYAxis:!0,yAxisInside:!0,showXAxis:!0,animate:!0}),this.chart&&this.chart.setData(s))}updateStatsFromServer(e){let t=this.priceHistory.statistics;if(!t){let s=this.prepareChartData(this.priceHistory.history);this.updateStats(s,e);return}if(this.periodLabel&&(this.periodLabel.textContent=`${ar[this.currentPeriod]} avg`),this.periodAvg&&(this.periodAvg.textContent=_(t.average,this.currentCurrency)),this.periodLowLabel&&(this.periodLowLabel.textContent=`${ar[this.currentPeriod]} low`),this.periodLow&&(this.periodLow.textContent=_(t.lowest,this.currentCurrency)),this.periodLowMeta&&t.lowest_date){let s=this.formatChartDate(t.lowest_date),i=t.lowest_store||"";this.periodLowMeta.textContent=i?`${s} \xB7 ${i}`:s}this.updatePriceVerdict(t.average,e)}updateStats(e,t){let s=e[this.currentPeriod];if(!s||s.values.length===0)return;let i=s.values,n=i.reduce((c,d)=>c+d,0)/i.length,o=Math.min(...i),a=i.indexOf(o);if(this.periodLabel&&(this.periodLabel.textContent=`${ar[this.currentPeriod]} avg`),this.periodAvg&&(this.periodAvg.textContent=_(n,this.currentCurrency)),this.periodLowLabel&&(this.periodLowLabel.textContent=`${ar[this.currentPeriod]} low`),this.periodLow&&(this.periodLow.textContent=_(o,this.currentCurrency)),this.periodLowMeta&&s.dates[a]){let c=s.stores[a]||"",d=s.dates[a];this.periodLowMeta.textContent=c?`${d} \xB7 ${c}`:d}this.updatePriceVerdict(n,t)}updatePriceVerdict(e,t){if(!this.priceVerdict||this.prices.length===0)return;let s=this.prices[0].price,i=dt(s,e);if(!i||!i.shouldShow){this.priceVerdict.style.display="none";return}let n=i.type==="below"?"arrow-down":"arrow-up";this.priceVerdict.style.display="",this.priceVerdict.innerHTML=`<svg class="icon price-intel-verdict-icon" aria-hidden="true"><use href="#icon-${n}"></use></svg> ${i.text}`,this.priceVerdict.classList.remove("price-intel-verdict--high","price-intel-verdict--low"),this.priceVerdict.classList.add(`price-intel-verdict--${i.type==="below"?"low":"high"}`)}setupPeriodButtons(){if(!this.periodButtons)return;let e=this.periodButtons.querySelectorAll("button");e.forEach(t=>{t.addEventListener("click",()=>{let s=t.dataset.period;if(s&&(e.forEach(i=>{i.classList.remove("is-active"),i.setAttribute("aria-selected","false")}),t.classList.add("is-active"),t.setAttribute("aria-selected","true"),this.currentPeriod=s,this.priceHistory&&this.priceHistory.history)){let i=this.prepareChartData(this.priceHistory.history),n=i[s],o=this.priceHistory.currency_symbol||"$";this.chart&&n&&this.chart.setData(n),this.updateStats(i,o)}})})}showNoPrices(){let e=this.el.querySelector(".price-intel-header"),t=this.el.querySelector(".price-intel-retailers"),s=this.el.querySelector("[data-price-history]");e&&(e.style.display="none"),t&&(t.style.display="none"),s&&(s.style.display="none"),this.updateHeroPriceNoData(),this.noPricesEl&&(this.noPricesEl.innerHTML=`
                <div class="price-intel-no-data">
                    <div class="price-intel-no-data-icon">
                        <svg class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <circle cx="12" cy="12" r="10"></circle>
                            <path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"></path>
                            <line x1="12" y1="17" x2="12.01" y2="17"></line>
                        </svg>
                    </div>
                    <h3 class="price-intel-no-data-title">No pricing available for your region</h3>
                    <p class="price-intel-no-data-text">We don't track retailers for this product in your region yet.</p>
                </div>
            `,this.noPricesEl.style.display="")}updateHeroPriceNoData(){let e=document.querySelector("[data-hero-price]");e&&(e.style.display="none")}showReferencePricing(e){me("Showing reference pricing",e);let t=this.el.querySelector(".price-intel-header"),s=this.el.querySelector(".price-intel-retailers"),i=this.el.querySelector("[data-price-history]");t&&(t.style.display="none"),s&&(s.style.display="none"),i&&(i.style.display="none"),this.updateHeroPriceNoData();let n=this.getRegionName(),o=this.getRegionNameForGeo(e.geo),a=e.offers.slice(0,4).map(c=>{let d=_(c.price,e.currency),l=se(c.tracked_url||c.url)||"#",h=c.logo_url?`<img src="${c.logo_url}" alt="${c.retailer}" class="price-intel-reference-card-logo">`:`<span class="price-intel-reference-card-name">${c.retailer}</span>`,u=c.in_stock!==!1;return`
                <a href="${l}" class="price-intel-reference-card" target="_blank" rel="sponsored noopener">
                    ${h}
                    <span class="price-intel-reference-card-price">${d}</span>
                    <span class="price-intel-reference-card-stock ${u?"price-intel-reference-card-stock--in":"price-intel-reference-card-stock--out"}">
                        <svg class="icon" aria-hidden="true"><use href="#icon-${u?"check":"x"}"></use></svg>
                        ${u?"In stock":"Out of stock"}
                    </span>
                </a>
            `}).join("");this.noPricesEl&&(this.noPricesEl.innerHTML=`
                <div class="price-intel-no-data">
                    <div class="price-intel-no-data-icon">
                        <svg class="icon" aria-hidden="true"><use href="#icon-info"></use></svg>
                    </div>
                    <h3 class="price-intel-no-data-title">No ${n} pricing available</h3>
                    <p class="price-intel-no-data-text">We don't track retailers for this product in your region yet.</p>

                    <div class="price-intel-reference">
                        <div class="price-intel-reference-header">
                            <span class="price-intel-reference-title">${o} Prices</span>
                            <span class="price-intel-reference-warning">
                                <svg class="icon" aria-hidden="true"><use href="#icon-info"></use></svg>
                                These retailers may not ship to your region
                            </span>
                        </div>
                        <div class="price-intel-reference-cards">
                            ${a}
                        </div>
                    </div>
                </div>
            `,this.noPricesEl.style.display="")}getRegionName(){return this.getRegionNameForGeo(this.userGeo?.geo)}getRegionNameForGeo(e){return{US:"US",GB:"UK",EU:"EU",CA:"Canadian",AU:"Australian"}[e]||e||"regional"}showRegionNotice(e){this.regionNotice&&this.regionNoticeText&&(this.regionNoticeText.textContent=e,this.regionNotice.style.display="")}showNoPriceHistory(){if(!this.priceHistorySection)return;this.chartSkeleton&&this.chartSkeleton.remove(),this.periodButtons&&(this.periodButtons.style.display="none");let e=this.priceHistorySection.querySelector(".price-intel-stats");e&&e.querySelectorAll(".price-intel-stat:not(.price-intel-stat--action)").forEach(i=>{i.style.display="none"}),this.regionNotice&&(this.regionNotice.style.display="none");let t=this.priceHistorySection.querySelector(".price-intel-chart-visual");t&&(t.innerHTML=`
                <div class="price-intel-no-history">
                    <svg class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M3 3v5h5"></path>
                        <path d="M3.05 13A9 9 0 1 0 6 5.3L3 8"></path>
                        <path d="M12 7v5l4 2"></path>
                    </svg>
                    <span>No price history available for your region</span>
                </div>
            `)}formatChartDate(e){return new Date(e).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})}formatTimeAgo(e){let t=new Date(e),i=Math.floor((new Date-t)/1e3);return i<60?"just now":i<3600?`${Math.floor(i/60)}m ago`:i<86400?`${Math.floor(i/3600)}h ago`:i<604800?`${Math.floor(i/86400)}d ago`:t.toLocaleDateString("en-US",{month:"short",day:"numeric"})}};document.readyState==="loading"?document.addEventListener("DOMContentLoaded",di):di();Oa={initPriceIntel:Zr,PriceIntelComponent:cr,initAlternatives:ui,initSuccessorPricing:hi}});var Si={};j(Si,{default:()=>Ha,destroy:()=>vi,hide:()=>wi,init:()=>yi,show:()=>bi});function mi(){if(!Q||!qt)return;qt.getBoundingClientRect().bottom<-50&&dr?(Q.classList.add(lr.visible),Q.setAttribute("aria-hidden","false")):(Q.classList.remove(lr.visible),Q.setAttribute("aria-hidden","true"))}function gi(){es||(window.requestAnimationFrame(()=>{mi(),es=!1}),es=!0)}async function Ua(){if(!Q)return;let r=Q.dataset.productId;if(r)try{let e=await z(),{geo:t,currency:s}=e,i=await Fe(parseInt(r,10),t);if(!i||!i.offers||i.offers.length===0)return;let n=Xe(i.offers,e);if(n.length===0)return;let o=n[0],a=Q.querySelector(De.price);a&&(a.textContent=_(o.price,o.currency||s));let c=Q.querySelector(De.verdict),d=Q.querySelector(De.verdictText),l=Q.querySelector(De.verdictIcon);if(c&&d&&i.history?.statistics?.average){let p=dt(o.price,i.history.statistics.average);if(p&&p.shouldShow){if(d.textContent=p.text,c.setAttribute("data-verdict-type",p.type),l){let f=p.type==="below"?"arrow-down":"arrow-up";l.querySelector("use")?.setAttribute("href",`#icon-${f}`)}c.style.display=""}}let h=Q.querySelector(De.buyLink),u=Q.querySelector(De.retailer);h&&(o.tracked_url||o.url)&&(h.href=se(o.tracked_url||o.url),u&&o.retailer&&(u.textContent=`Buy at ${o.retailer}`)),Ae.currentPrice=o.price,Ae.currentCurrency=o.currency||s,dr=!0}catch(e){console.error("Failed to load sticky bar price data:",e)}}function Ra(){if(!Q)return;Ae.id=parseInt(Q.dataset.productId,10)||0,Ae.name=Q.dataset.productName||"";let r=Q.querySelector(".sticky-buy-bar-img");Ae.image=r?.src||"";let e=Q.querySelector(De.trackPriceBtn);e&&e.addEventListener("click",s=>{s.preventDefault(),s.stopPropagation(),oe.open({productId:Ae.id,productName:Ae.name,productImage:Ae.image,currentPrice:Ae.currentPrice,currency:Ae.currentCurrency})});let t=Q.querySelector(De.compareLink);if(t&&Ae.id){let s=t.href,i=s.includes("?")?"&":"?";t.href=`${s}${i}products=${Ae.id}`}}function yi(r={}){let e={bar:r.barSelector||De.bar,priceSection:r.priceSectionSelector||De.priceSection};Q=document.querySelector(e.bar),qt=document.querySelector(e.priceSection),!(!Q||!qt)&&(Ra(),Ua(),window.addEventListener("scroll",gi,{passive:!0}),mi())}function vi(){window.removeEventListener("scroll",gi),Q=null,qt=null,dr=!1}function bi(){Q&&dr&&(Q.classList.add(lr.visible),Q.setAttribute("aria-hidden","false"))}function wi(){Q&&(Q.classList.remove(lr.visible),Q.setAttribute("aria-hidden","true"))}var De,lr,Q,qt,es,dr,Ae,Ha,Ei=P(()=>{ne();_e();At();fe();De={bar:"#sticky-buy-bar",priceSection:"#prices",price:"[data-sticky-price]",verdict:"[data-sticky-verdict]",verdictText:"[data-sticky-verdict-text]",verdictIcon:"[data-sticky-verdict-icon]",buyLink:"[data-sticky-buy-link]",retailer:"[data-sticky-retailer]",trackPriceBtn:'[data-modal-trigger="price-alert-modal"]',compareLink:'.sticky-buy-bar-link[href*="compare"]'},lr={visible:"is-visible"},Q=null,qt=null,es=!1,dr=!1,Ae={id:0,name:"",image:"",currentPrice:0,currentCurrency:"USD"};Ha={init:yi,destroy:vi,show:bi,hide:wi}});var ki={};j(ki,{default:()=>ja,initToc:()=>xi});function xi(r,e={}){let t=typeof r=="string"?document.querySelector(r):r;if(!t)return null;let s={...Va,...e},i=document.querySelector(".header"),n=t.querySelectorAll(s.linkSelector);if(!n.length)return null;let o=new Map;if(n.forEach(I=>{let O=I.getAttribute("href");if(!O||!O.startsWith("#"))return;let K=O.slice(1),ie=document.getElementById(K);if(ie){let ge=I.closest("li"),pe=ge?.parentElement?.closest("li"),ve=ge?.parentElement?.classList.contains("toc-list");o.set(K,{element:ie,link:I,parentItem:ge,parentGroup:pe?.querySelector(':scope > a[href^="#"]')?pe:null,text:I.textContent.trim(),isTopLevel:ve})}}),!o.size)return null;let a=null,c=!1,d=!1,l=!1,h=!1,u=null,p=null;function f(){return window.innerWidth<=s.mobileBreakpoint}function m(){return u||(u=document.createElement("button"),u.className="toc-toggle",u.setAttribute("aria-expanded","false"),u.setAttribute("aria-controls","toc-list"),u.innerHTML=`
            <svg class="icon" aria-hidden="true"><use href="#icon-list"></use></svg>
            <span class="toc-toggle-label">On this page</span>
            <svg class="icon toc-toggle-chevron" aria-hidden="true"><use href="#icon-chevron-down"></use></svg>
        `,u.addEventListener("click",k),u)}function g(){if(d)return;if(d=!0,i?.classList.contains(Ga)){t.classList.add("toc--mobile"),u||m(),t.contains(u)||t.insertBefore(u,t.firstChild);let O=t.querySelector(".toc-list");O&&(O.id="toc-list"),b(),G()}w()}function y(){d&&(d=!1,t.classList.remove("toc--mobile","is-hidden","is-open"),u&&t.contains(u)&&u.remove(),l=!1,p&&(p.disconnect(),p=null))}function v(){if(!f()){y();return}let I=window.scrollY>=700;if(I&&!t.classList.contains("toc--mobile")){i?.classList.contains(Li)?(t.style.transition="none",t.classList.add("toc--mobile","is-hidden"),requestAnimationFrame(()=>{t.style.transition=""})):t.classList.add("toc--mobile"),u||m(),t.contains(u)||t.insertBefore(u,t.firstChild);let K=t.querySelector(".toc-list");K&&(K.id="toc-list"),G()}else!I&&t.classList.contains("toc--mobile")&&!h&&(h=!0,t.classList.add("is-hidden"),l=!1,setTimeout(()=>{window.scrollY<700&&t.classList.remove("toc--mobile","is-hidden","is-open"),h=!1},300));t.classList.contains("toc--mobile")&&!h&&b(),d=f()}function w(){!i||p||(p=new MutationObserver(()=>{v()}),p.observe(i,{attributes:!0,attributeFilter:["class"]}))}function b(){if(!i)return;let I=i.classList.contains(Li);t.classList.toggle("is-hidden",I),I&&l&&q()}function k(){l=!l,t.classList.toggle("is-open",l),u&&u.setAttribute("aria-expanded",l),l&&t.querySelector(".toc-list > li > .toc-link")?.focus()}function q(){l&&(l=!1,t.classList.remove("is-open"),u&&u.setAttribute("aria-expanded","false"))}function G(){if(!u||!a)return;let I=o.get(a);if(I){let O=I.text;if(!I.isTopLevel&&I.parentGroup){let ie=I.parentGroup.querySelector(':scope > a[href^="#"]');ie&&(O=ie.textContent.trim())}let K=u.querySelector(".toc-toggle-label");K&&(K.textContent=O)}}function ee(){n.forEach(I=>{I.classList.remove(s.activeClass)}),t.querySelectorAll(`.${s.parentActiveClass}`).forEach(I=>{I.classList.remove(s.parentActiveClass)})}function re(I){if(I===a)return;ee();let O=o.get(I);if(O){if(O.link.classList.add(s.activeClass),s.expandParent&&O.parentGroup){O.parentGroup.classList.add(s.parentActiveClass);let K=O.parentGroup.querySelector(':scope > a[href^="#"]');K&&K.classList.add(s.activeClass)}s.expandParent&&O.parentItem&&O.parentItem.querySelector("ul")&&O.parentItem.classList.add(s.parentActiveClass),a=I,d&&G()}}function M(){let I=window.scrollY+s.offset,O=null,K=-1/0;if(o.forEach((ie,ge)=>{let ve=ie.element.getBoundingClientRect().top+window.scrollY;ve<=I&&ve>K&&(K=ve,O=ge)}),!O&&window.scrollY<s.offset*2){let ie=o.entries().next().value;ie&&(O=ie[0])}return O}function E(){c||(c=!0,requestAnimationFrame(()=>{let I=M();I&&re(I),f()&&v(),c=!1}))}function S(I){let O=I.target.closest(s.linkSelector);if(!O)return;let K=O.getAttribute("href");if(!K||!K.startsWith("#"))return;let ie=document.getElementById(K.slice(1));if(!ie)return;I.preventDefault(),d&&l&&q();let ge=d?48:0,pe=ie.getBoundingClientRect().top+window.scrollY-s.offset-ge+20;window.scrollTo({top:pe,behavior:"smooth"}),history.pushState(null,"",K),re(K.slice(1))}function x(I){d&&l&&!t.contains(I.target)&&q()}function A(I){!d||!l||I.key==="Escape"&&(q(),u?.focus())}function U(){f()?(p||w(),v()):y()}window.addEventListener("scroll",E,{passive:!0}),t.addEventListener("click",S),document.addEventListener("click",x),document.addEventListener("keydown",A);let Y;return window.addEventListener("resize",()=>{clearTimeout(Y),Y=setTimeout(U,100)}),E(),f()&&(w(),v()),{refresh(){E()},destroy(){window.removeEventListener("scroll",E),t.removeEventListener("click",S),document.removeEventListener("click",x),document.removeEventListener("keydown",A),p&&p.disconnect(),ee(),y()}}}var Ga,Li,Va,ja,Ci=P(()=>{Ga="header--fixed",Li="header--hidden",Va={offset:100,mobileBreakpoint:890,activeClass:"is-active",parentActiveClass:"is-active",expandParent:!0,linkSelector:'a[href^="#"]',throttleMs:50};ja=xi});var $i={};j($i,{initArchiveFilter:()=>ts});function ts(){let r=document.querySelector("[data-archive-filters]"),e=document.querySelector("[data-archive-grid]"),t=document.querySelector("[data-archive-empty]");if(!r||!e)return;let s=r.querySelectorAll("[data-filter]"),i=e.querySelectorAll("[data-category]");function n(a){let c=[...s].find(h=>h.dataset.filter===a),d=c?a:"all",l=c||r.querySelector('[data-filter="all"]');s.forEach(h=>h.classList.remove("is-active")),l&&l.classList.add("is-active"),Wa(d,i,t)}s.forEach(a=>{a.addEventListener("click",()=>{let c=a.dataset.filter;c==="all"?history.pushState(null,"",window.location.pathname):history.pushState(null,"",`#${c}`),n(c)})}),window.addEventListener("hashchange",()=>{let a=window.location.hash.slice(1);n(a||"all")});let o=window.location.hash.slice(1);o&&n(o)}function Wa(r,e,t){let s=0;e.forEach(i=>{let n=i.dataset.category?i.dataset.category.split(" "):[];if(r==="all"||n.includes(r)){let a=s*25;i.hidden=!1,i.style.opacity="0",i.style.transform="translateY(8px)",requestAnimationFrame(()=>{setTimeout(()=>{i.style.transition="opacity 0.15s ease, transform 0.15s ease",i.style.opacity="1",i.style.transform="translateY(0)"},a)}),s++}else i.hidden=!0,i.style.opacity="",i.style.transform="",i.style.transition=""}),t&&(t.hidden=s>0)}var Ai=P(()=>{document.readyState==="loading"?document.addEventListener("DOMContentLoaded",ts):ts()});var qi={};j(qi,{initArchiveSort:()=>rs});function rs(){document.querySelectorAll("[data-archive-sort]").forEach(e=>{let s=(document.querySelector("main")||document).querySelector("[data-archive-grid]");s&&e.addEventListener("change",()=>{let i=e.value;za(s,i)})})}function za(r,e){let t=Array.from(r.querySelectorAll(".archive-card"));t.length!==0&&(t.sort((s,i)=>{switch(e){case"rating":let n=parseFloat(s.dataset.rating)||0;return(parseFloat(i.dataset.rating)||0)-n;case"newest":let a=new Date(s.dataset.date)||0;return(new Date(i.dataset.date)||0)-a;case"oldest":let d=new Date(s.dataset.date)||0,l=new Date(i.dataset.date)||0;return d-l;default:return 0}}),t.forEach(s=>{s.style.opacity="0",s.style.transform="translateY(8px)"}),setTimeout(()=>{t.forEach(s=>{r.appendChild(s)}),t.forEach((s,i)=>{let n=i*25;setTimeout(()=>{s.style.transition="opacity 0.15s ease, transform 0.15s ease",s.style.opacity="1",s.style.transform="translateY(0)"},n)}),setTimeout(()=>{t.forEach(s=>{s.style.opacity="",s.style.transform="",s.style.transition=""})},t.length*25+200)},100))}var Ti=P(()=>{document.readyState==="loading"?document.addEventListener("DOMContentLoaded",rs):rs()});var Pi={};j(Pi,{initSearchPage:()=>Ya});function Ya(){let r=document.querySelector("[data-search-page]");if(!r)return null;let e=r.querySelector("[data-search-input]"),t=r.querySelector("[data-search-clear]"),s=r.querySelector("[data-search-filters]"),i=r.querySelector("[data-search-results]"),n=r.querySelector("[data-search-empty]"),o=r.querySelector("[data-search-loading]"),a=r.querySelector("[data-empty-text]"),c=r.querySelectorAll("[data-filter]"),d=r.querySelector("[data-count-all]"),l=r.querySelector("[data-count-product]"),h=r.querySelector("[data-count-article]"),u=r.querySelector("[data-count-tool]"),p=null,f=[],m="all",g=!1;function y(){g||(g=!0,bt())}function v(){o?.removeAttribute("hidden"),i?.setAttribute("hidden",""),n?.setAttribute("hidden",""),s?.setAttribute("hidden","")}function w(E=!1,S=""){o?.setAttribute("hidden",""),i?.setAttribute("hidden",""),n?.removeAttribute("hidden"),s?.setAttribute("hidden",""),E&&a?a.textContent=`No results found for "${S}"`:a&&(a.textContent="Start typing to search products, reviews, and guides.")}function b(){o?.setAttribute("hidden",""),n?.setAttribute("hidden",""),i?.removeAttribute("hidden"),s?.removeAttribute("hidden")}function k(E){let S={all:E.length,Product:0,Article:0,Tool:0};E.forEach(x=>{S[x.type]!==void 0&&S[x.type]++}),d&&(d.textContent=S.all),l&&(l.textContent=S.Product),h&&(h.textContent=S.Article),u&&(u.textContent=S.Tool),c.forEach(x=>{let A=x.dataset.filter;A==="all"||S[A]>0?x.removeAttribute("hidden"):x.setAttribute("hidden","")})}function q(E){if(!i)return;let S=m==="all"?E:E.filter(A=>A.type===m);if(S.length===0){i.innerHTML="";return}let x="";S.forEach(A=>{let U=zt(A),Y=A.type==="Product",I=A.image||A.thumbnail;x+=`
                <a class="archive-card" href="${qe(A.url)}">
                    <div class="archive-card-img${Y?" archive-card-img--product":""}">
                        <img src="${qe(I)}" alt="" loading="lazy">
                        <span class="archive-card-tag">${qe(U.label)}</span>
                    </div>
                    <h3 class="archive-card-title">${qe(A.title)}</h3>
                </a>
            `}),i.innerHTML=x}async function G(E){t&&(t.hidden=!E);let S=new URL(window.location);if(E?S.searchParams.set("q",E):S.searchParams.delete("q"),window.history.replaceState({},"",S),!E||E.length<2){f=[],w(!1);return}v();try{f=await wt(E),f.length===0?w(!0,E):(m="all",c.forEach(x=>{let A=x.dataset.filter==="all";x.classList.toggle("is-active",A),x.setAttribute("aria-pressed",A)}),k(f),b(),q(f))}catch(x){console.error("[SearchPage] Error:",x),w(!0,E)}}function ee(E){clearTimeout(p),p=setTimeout(()=>G(E),200)}function re(E){m=E,c.forEach(S=>{let x=S.dataset.filter===E;S.classList.toggle("is-active",x),S.setAttribute("aria-pressed",x)}),f.length>0&&q(f)}e&&(e.addEventListener("focus",y),e.addEventListener("input",E=>ee(E.target.value)),e.addEventListener("keydown",E=>{E.key==="Escape"&&(e.value="",G(""))})),t&&t.addEventListener("click",()=>{e&&(e.value="",e.focus()),G("")}),c.forEach(E=>{E.addEventListener("click",()=>{re(E.dataset.filter)})});let M=window.erhData?.searchQuery||"";if(M){let E=i&&!i.hasAttribute("hidden")&&i.children.length>0;y(),E||v(),wt(M).then(S=>{f=S,S.length===0?w(!0,M):(m="all",c.forEach(x=>{let A=x.dataset.filter==="all";x.classList.toggle("is-active",A),x.setAttribute("aria-pressed",A)}),k(f),b(),q(f)),t&&(t.hidden=!1)}).catch(()=>{E||w(!0,M)})}else w(!1);return{search:G,setFilter:re}}var Ii=P(()=>{Ir();Dr()});function Be(r,e=0){return r.toLocaleString("en-US",{minimumFractionDigits:e,maximumFractionDigits:e})}function ut(r,e=1){return r.toFixed(e)+"%"}function Ka(r,e=0){let t=parseFloat(r?.value);return isNaN(t)?e:t}function ur(r){let e=r.querySelectorAll("[data-input]"),t={};return e.forEach(s=>{let i=s.dataset.input;t[i]=Ka(s)}),t}function ht(r,e){Object.entries(e).forEach(([t,s])=>{let i=r.querySelector(`[data-result="${t}"]`);i&&(i.textContent=s,i.classList.remove("result-value--loading"))})}function Xa(r,e=150){let t=null;return function(...s){clearTimeout(t),t=setTimeout(()=>r.apply(this,s),e)}}function Tt(r,e,t){return Math.min(Math.max(r,e),t)}function hr(r,e,t=150){let s=Xa(e,t);r.addEventListener("input",i=>{i.target.matches("[data-input]")&&s()}),r.addEventListener("change",i=>{i.target.matches("[data-input]")&&e()})}var Pt=P(()=>{});var Di={};j(Di,{init:()=>Ja});function pr(r){if(r==null||isNaN(r)||r===0)return"--";let e=r.toFixed(2).replace(/\.?0+$/,"");return Be(parseFloat(e))}function Ja(r){let e=r.querySelectorAll("[data-calc-tab]"),t=r.querySelectorAll("[data-calc-panel]"),s=r.querySelector("[data-calculator-reset]"),i="wh",n={wh:"Wh",ah:"Ah"};function o(u){i=u,e.forEach(p=>{let f=p.dataset.calcTab===u;p.classList.toggle("is-active",f),p.setAttribute("aria-selected",f)}),t.forEach(p=>{let f=p.dataset.calcPanel===u;p.hidden=!f}),a()}function a(){let u=r.querySelector(`[data-calc-panel="${i}"]`);if(!u)return;let p=u.querySelector('[data-result="value"]');if(!p)return;let f=null,m="";if(i==="wh"){let g=parseFloat(u.querySelector('[data-input="ah"]')?.value)||0,y=parseFloat(u.querySelector('[data-input="voltage"]')?.value)||0;g>0&&y>0?(f=g*y,n.wh==="kWh"?(f=f/1e3,m="kWh"):m="Wh",p.textContent=pr(f)+" "+m):p.textContent="--"}else if(i==="ah"){let g=parseFloat(u.querySelector('[data-input="wh"]')?.value)||0,y=parseFloat(u.querySelector('[data-input="voltage"]')?.value)||0;g>0&&y>0?(f=g/y,n.ah==="mAh"?(f=f*1e3,m="mAh"):m="Ah",p.textContent=pr(f)+" "+m):p.textContent="--"}else if(i==="voltage"){let g=parseFloat(u.querySelector('[data-input="wh"]')?.value)||0,y=parseFloat(u.querySelector('[data-input="ah"]')?.value)||0;g>0&&y>0?(f=g/y,p.textContent=pr(f)+" V"):p.textContent="--"}f!==null&&l(f,m||"V")}function c(){r.querySelectorAll("[data-unit-toggle]").forEach(u=>{let p=u.querySelectorAll("[data-unit]");p.forEach(f=>{f.addEventListener("click",()=>{let m=u.dataset.unitToggle,g=f.dataset.unit;p.forEach(y=>y.classList.remove("is-active")),f.classList.add("is-active"),n[m]=g,a()})})})}let d;function l(u,p){clearTimeout(d),d=setTimeout(()=>{let f=r.querySelector("[aria-live]"),m={wh:"Capacity",ah:"Charge",voltage:"Voltage"};f&&(f.textContent=`${m[i]}: ${pr(u)} ${p}.`)},500)}function h(){t.forEach(p=>{p.querySelectorAll('input[type="number"]').forEach(m=>{m.value=""});let f=p.querySelector('[data-result="value"]');f&&(f.textContent="--")}),n.wh="Wh",n.ah="Ah",r.querySelectorAll("[data-unit-toggle]").forEach(p=>{p.querySelectorAll("[data-unit]").forEach((m,g)=>{m.classList.toggle("is-active",g===0)})});let u=r.querySelector("[aria-live]");u&&(u.textContent="Calculator reset.")}e.forEach(u=>{u.addEventListener("click",()=>o(u.dataset.calcTab)),u.addEventListener("keydown",p=>{let f=Array.from(e),m=f.indexOf(u),g=m;if(p.key==="ArrowRight"?g=(m+1)%f.length:p.key==="ArrowLeft"&&(g=(m-1+f.length)%f.length),g!==m){p.preventDefault();let y=f[g];y.focus(),o(y.dataset.calcTab)}})}),t.forEach(u=>{u.querySelectorAll('input[type="number"]').forEach(p=>{p.addEventListener("input",a)})}),s&&s.addEventListener("click",h),c(),o("wh")}var Mi=P(()=>{Pt()});var _i={};j(_i,{init:()=>Za});function Qa(r,e,t,s,i){let n;switch(e){case"kWh":n=r*1e3/t;break;case"Wh":n=r/t;break;case"Ah":default:n=r;break}let o=n*(1-i/100),a=s>0?o/s:0,c=Math.floor(a),d=Math.round((a-c)*60);return{hours:d===60?c+1:c,minutes:d===60?0:d,totalMinutes:Math.round(a*60),capacityAh:n,remainingCapacity:o}}function Fi(r,e){if(r===0&&e===0)return"--";let t=[];return r>0&&t.push(`${r} ${r===1?"hour":"hours"}`),(e>0||r===0)&&t.push(`${e} ${e===1?"min":"mins"}`),t.join(" ")}function Za(r){let e=r.querySelector("[data-voltage-group]"),t=r.querySelector('[data-input="capacityUnit"]'),s=r.querySelector("[data-calculator-reset]");function i(){let d=t?.value||"Wh",l=d==="Wh"||d==="kWh";if(e){e.style.display=l?"":"none";let h=e.querySelector('[data-input="voltage"]');h&&(h.required=l)}}function n(){let d=ur(r),l=d.capacity||0,h=t?.value||"Wh",u=d.voltage||48,p=d.current||0,f=Tt(d.soc||0,0,100);if(!l||!p||(h==="Wh"||h==="kWh")&&!u){ht(r,{"charging-time":"--","remaining-capacity":"--"});return}let g=Qa(l,h,u,p,f);ht(r,{"charging-time":Fi(g.hours,g.minutes),"remaining-capacity":Be(g.remainingCapacity.toFixed(2))+" Ah"}),a(g.hours,g.minutes)}let o;function a(d,l){clearTimeout(o),o=setTimeout(()=>{let h=r.querySelector("[aria-live]");h&&(d>0||l>0)&&(h.textContent=`Estimated charging time: ${Fi(d,l)}.`)},500)}function c(){let d=r.querySelector('[data-input="capacity"]'),l=r.querySelector('[data-input="voltage"]'),h=r.querySelector('[data-input="current"]'),u=r.querySelector('[data-input="soc"]');d&&(d.value=It.capacity),l&&(l.value=It.voltage),h&&(h.value=It.current),u&&(u.value=It.soc),t&&(t.value=It.capacityUnit,t.dispatchEvent(new Event("change",{bubbles:!0}))),i(),n();let p=r.querySelector("[aria-live]");p&&(p.textContent="Calculator reset to default values.")}t&&t.addEventListener("change",()=>{i(),n()}),s&&s.addEventListener("click",c),i(),hr(r,n),n()}var It,Bi=P(()=>{Pt();It={capacity:500,capacityUnit:"Wh",voltage:48,current:2,soc:0}});var Oi={};j(Oi,{init:()=>sc});function ec(r,e,t,s,i){let n=e>0?Se.calendarBase*Math.sqrt(e):0,o=Se.dodFactors[i]||1,a=t*Se.cycleRate*o,c=s-Se.optimalTempC,d=1+Math.max(0,c*Se.tempPenaltyPerC),l=(n+a)*d*Se.overlapFactor,h=Tt(l,0,Se.maxLoss),u=100-h,p=r*(u/100),f=[];for(let m=1;m<=5;m++){let g=e+m,y=t+m*Se.cyclesPerYear,v=Se.calendarBase*Math.sqrt(g),w=y*Se.cycleRate*o,b=(v+w)*d*Se.overlapFactor,q=100-Tt(b,0,Se.maxLoss),G=r*(q/100);f.push({year:g,percent:q,capacity:G})}return{currentPercent:u,currentCapacity:p,calendarLoss:n*Se.overlapFactor,cycleLoss:a*d*Se.overlapFactor,tempFactor:d,totalLoss:h,projections:f}}function tc(r){return r>=90?{label:"Excellent",class:"success"}:r>=80?{label:"Good",class:"success"}:r>=70?{label:"Fair",class:"warning"}:{label:"Poor",class:"error"}}function Ni(r){return(r-32)*5/9}function rc(r){return r*9/5+32}function sc(r){let e=!0,t=r.querySelector('[data-input="temp"]'),s=r.querySelectorAll("[data-temp-unit]"),i=r.querySelector("[data-temp-unit-label]"),n=r.querySelector("[data-calculator-reset]");function o(h){if(e===h)return;let u=parseFloat(t?.value)||(e?21:70),p=h?Ni(u):rc(u);e=h,t&&(t.value=Math.round(p),t.min=h?-10:14,t.max=h?45:113),i&&(i.textContent=h?"\xB0C":"\xB0F"),s.forEach(f=>{let m=f.dataset.tempUnit==="c";f.classList.toggle("is-active",m===h),f.setAttribute("aria-pressed",m===h)}),a()}function a(){let h=ur(r),u=h.capacity||500,p=h.age||0,f=h.cycles||0,m=h.temp||21;e||(m=Ni(m));let y=r.querySelector('[data-input="dod"]')?.value||"moderate",v=ec(u,p,f,m,y),w=tc(v.currentPercent);ht(r,{"current-percent":ut(v.currentPercent,0),"current-capacity":Be(Math.round(v.currentCapacity))+" Wh","health-status":w.label,"calendar-loss":ut(v.calendarLoss,1),"cycle-loss":ut(v.cycleLoss,1),"total-loss":ut(v.totalLoss,1)}),v.projections.forEach((k,q)=>{ht(r,{[`year${q+1}-age`]:`Year ${k.year}`,[`year${q+1}-capacity`]:Be(Math.round(k.capacity))+" Wh",[`year${q+1}-percent`]:ut(k.percent,0)})});let b=r.querySelector('[data-result="health-status"]');b&&(b.className=`result-value result-value--${w.class}`),d(v.currentPercent,w.label)}let c;function d(h,u){clearTimeout(c),c=setTimeout(()=>{let p=r.querySelector("[aria-live]");p&&(p.textContent=`Battery health: ${Math.round(h)}%, status ${u}.`)},500)}function l(){let h=r.querySelector('[data-input="capacity"]'),u=r.querySelector('[data-input="age"]'),p=r.querySelector('[data-input="cycles"]'),f=r.querySelector('[data-input="dod"]');h&&(h.value=Dt.capacity),u&&(u.value=Dt.age),p&&(p.value=Dt.cycles),f&&(f.value=Dt.dod,f.dispatchEvent(new Event("change",{bubbles:!0}))),e?t&&(t.value=Dt.temp):o(!0),a();let m=r.querySelector("[aria-live]");m&&(m.textContent="Calculator reset to default values.")}n&&n.addEventListener("click",l),s.forEach(h=>{h.addEventListener("click",()=>{o(h.dataset.tempUnit==="c")}),h.addEventListener("keydown",u=>{if(u.key==="ArrowLeft"||u.key==="ArrowRight"){u.preventDefault();let p=Array.from(s),f=p.indexOf(h),m=u.key==="ArrowRight"?(f+1)%p.length:(f-1+p.length)%p.length,g=p[m];g.focus(),o(g.dataset.tempUnit==="c")}})}),hr(r,a),a()}var Se,Dt,Ui=P(()=>{Pt();Se={calendarBase:2.3,cycleRate:.015,optimalTempC:21,tempPenaltyPerC:.02,dodFactors:{conservative:.6,moderate:1,full:1.8,extreme:2.5},overlapFactor:.85,maxLoss:40,cyclesPerYear:250};Dt={capacity:500,age:0,cycles:0,temp:21,dod:"moderate"}});var Ri={};j(Ri,{enumLabel:()=>Te,initLawsMap:()=>Mt});function ic(r,e=""){return`<svg class="${e}" aria-hidden="true"><use xlink:href="#${r}"></use></svg>`}function Te(r){return r==null||r===""?"N/A":typeof r=="boolean"?r?"Yes":"No":String(r).replace(/_/g," ").replace(/\b\w/g,e=>e.toUpperCase())}function nc(r,e){let t;return(...s)=>{clearTimeout(t),t=setTimeout(()=>r(...s),e)}}function Mt(r,e){let t=window.erhData?.lawsData;if(!t||!Object.keys(t).length)return;let{classificationMap:s,buildInfoBoxItems:i}=e,n=r.querySelector("#us-map"),o=r.querySelector("#map-container"),a=r.querySelector("#info-box"),c=r.querySelector("#state-search"),d=r.querySelector("#suggestions-box"),l=r.querySelector("#desktop-toc-list"),h=r.querySelector("#mobile-toc-list"),u=r.querySelector("#back-to-top-btn"),p=r.querySelector("#toc-mobile-btn"),f=r.querySelector("#mobile-toc-popup"),m=r.querySelector(".close-mobile-toc"),g=r.querySelector("#map-hint"),y=null,v=-1;function w(){if(n)for(let[$,T]of Object.entries(t)){let N=n.querySelector(`#${$}`);if(!N)continue;let ae=s[T.classification];ae&&N.classList.add(ae.cssClass)}}function b(){if(n)for(let[$,T]of Object.entries(t)){let N=n.querySelector(`#${$}`);if(!N)continue;let ae=document.createElementNS("http://www.w3.org/2000/svg","title");ae.textContent=`${T.name}: ${s[T.classification]?.label||"No data"}`,N.prepend(ae)}}function k(){g&&!g.classList.contains("hidden")&&g.classList.add("hidden")}function q($){let T=t[$];if(!T||!a)return;y&&n?.querySelector(`#${y}`)?.classList.remove("active-state"),n?.querySelector(`#${$}`)?.classList.add("active-state"),y=$;let N=L=>`<svg class="info-icon" aria-hidden="true"><use xlink:href="#${L}"></use></svg>`,ae=i(T,s);a.innerHTML=`
            <div class="info-header-row">
                <span class="state-name">${T.name}</span>
                <button class="close-info-box" aria-label="Close">&times;</button>
            </div>
            <div class="info-grid-container">
                ${ae.map(L=>`
                    <div class="info-grid-item">
                        <span class="item-header">${N(L.icon)} <span>${L.label}</span></span>
                        <span class="item-value">${L.statusIcon?ic(L.statusIcon,`status-icon ${L.statusColor||""}`):""}${L.value}</span>
                    </div>
                `).join("")}
            </div>
            <div class="details-link-container">
                <a href="#${$}-details" class="details-link">
                    View full details <svg><use xlink:href="#chevron"></use></svg>
                </a>
            </div>
        `,G($),a.classList.add("visible"),history.replaceState(null,"",`#${$}-details`),k(),a.querySelector(".close-info-box")?.addEventListener("click",ee),a.querySelector(".details-link")?.addEventListener("click",L=>{L.preventDefault(),ee(),r.querySelector(`#${$}-details`)?.scrollIntoView({behavior:"smooth",block:"start"})})}function G($){if(!a||!n||!o)return;if(window.innerWidth<=991){a.style.left="",a.style.top="",a.style.transform="";return}let T=n.querySelector(`#${$}`);if(!T)return;let N=o.getBoundingClientRect(),ae=T.getBoundingClientRect(),L=ae.left+ae.width/2-N.left,C=ae.top-N.top,D=140;L=Math.max(D+10,Math.min(L,N.width-D-10)),a.style.left=`${L}px`,a.style.top=`${C}px`,a.style.transform="translate(-50%, -100%)"}function ee(){a&&(a.classList.remove("visible"),y&&(n?.querySelector(`#${y}`)?.classList.remove("active-state"),y=null))}function re(){n&&n.addEventListener("click",$=>{let T=$.target;for(;T&&T!==n;){if(T.id&&t[T.id]){q(T.id);return}T=T.parentElement}})}function M(){if(n){for(let[$,T]of Object.entries(t)){let N=n.querySelector(`#${$}`);N&&(N.setAttribute("tabindex","0"),N.setAttribute("role","button"),N.setAttribute("aria-label",`${T.name}: ${s[T.classification]?.label||"No data"}`))}n.addEventListener("keydown",$=>{if($.key!=="Enter"&&$.key!==" ")return;let T=$.target;for(;T&&T!==n;){if(T.id&&t[T.id]){$.preventDefault(),q(T.id);return}T=T.parentElement}})}}let E=Object.entries(t).map(([$,T])=>({id:$,name:T.name,text:`${T.name} ${$}`.toLowerCase()}));function S(){!c||!d||(c.addEventListener("input",nc(x,100)),c.addEventListener("keydown",A),c.addEventListener("focus",()=>{c.value.trim().length>=1&&x()}))}function x(){let $=c.value.trim().toLowerCase();if(v=-1,$.length<1){O();return}let T=E.filter(N=>N.text.includes($)).slice(0,8);if(!T.length){d.innerHTML='<div class="suggestion-item no-results">No matches found</div>',d.style.display="block";return}d.innerHTML=T.map((N,ae)=>{let L=`${N.name} (${N.id})`;return`<div class="suggestion-item" data-index="${ae}" data-state="${N.id}">${U(L,$)}</div>`}).join(""),d.style.display="block",d.querySelectorAll(".suggestion-item[data-state]").forEach(N=>{N.addEventListener("click",()=>I(N.dataset.state))})}function A($){let T=d.querySelectorAll(".suggestion-item[data-state]");T.length&&($.key==="ArrowDown"?($.preventDefault(),v=Math.min(v+1,T.length-1),Y(T)):$.key==="ArrowUp"?($.preventDefault(),v=Math.max(v-1,0),Y(T)):$.key==="Enter"?($.preventDefault(),v>=0&&T[v]&&I(T[v].dataset.state)):$.key==="Escape"&&(O(),c.blur()))}function U($,T){let N=$.toLowerCase().indexOf(T);return N===-1?$:$.slice(0,N)+"<strong>"+$.slice(N,N+T.length)+"</strong>"+$.slice(N+T.length)}function Y($){$.forEach((T,N)=>{T.classList.toggle("suggestion-highlight",N===v)}),$[v]?.scrollIntoView({block:"nearest"})}function I($){O(),c.value=t[$]?.name||"",q($),setTimeout(()=>{r.querySelector(`#${$}-details`)?.scrollIntoView({behavior:"smooth",block:"start"})},300)}function O(){d&&(d.style.display="",d.innerHTML="",v=-1)}function K(){[l,h].forEach($=>{$&&$.addEventListener("click",T=>{let N=T.target.closest(".toc-link");N&&(T.preventDefault(),pe(),r.querySelector(N.getAttribute("href"))?.scrollIntoView({behavior:"smooth",block:"start"}))})})}function ie(){if(!l)return;let $=r.querySelectorAll('#details-container section[id$="-details"]');if(!$.length)return;let T=new IntersectionObserver(N=>{for(let ae of N){if(!ae.isIntersecting)continue;let L=ae.target.id.replace("-details","");l.querySelectorAll(".toc-link").forEach(C=>{C.classList.toggle("active-toc-link",C.dataset.state===L)}),l.querySelector(".active-toc-link")?.scrollIntoView({block:"nearest",behavior:"smooth"})}},{rootMargin:"-20% 0px -70% 0px"});$.forEach(N=>T.observe(N))}function ge(){u&&(window.addEventListener("scroll",()=>{u.classList.toggle("visible",window.scrollY>600)},{passive:!0}),u.addEventListener("click",()=>{window.scrollTo({top:0,behavior:"smooth"})})),p&&f&&p.addEventListener("click",()=>{f.classList.toggle("visible")}),m&&m.addEventListener("click",pe)}function pe(){f?.classList.remove("visible")}function ve(){document.addEventListener("click",$=>{a?.classList.contains("visible")&&!a.contains($.target)&&!$.target.closest("#us-map")&&ee(),d?.style.display==="block"&&!d.contains($.target)&&$.target!==c&&O(),f?.classList.contains("visible")&&!f.contains($.target)&&$.target!==p&&!p?.contains($.target)&&pe()})}window.addEventListener("resize",()=>{y&&a?.classList.contains("visible")&&G(y)},{passive:!0}),w(),b(),re(),M(),S(),K(),ie(),ge(),ve(),requestAnimationFrame(()=>r.classList.add("js-ready"));let Ke=window.location.hash;if(Ke){let $=Ke.match(/^#([A-Z]{2})-details$/);if($&&t[$[1]]){let T=$[1];q(T),setTimeout(()=>{r.querySelector(`#${T}-details`)?.scrollIntoView({behavior:"smooth",block:"start"})},300)}}}var fr=P(()=>{});var Hi={};j(Hi,{init:()=>dc});function ac(r){return r.class3?.maxSpeedMph?r.class3.maxSpeedMph:r.general?.maxSpeedMph?r.general.maxSpeedMph:r.class2?.maxSpeedMph?r.class2.maxSpeedMph:r.class1?.maxSpeedMph?r.class1.maxSpeedMph:null}function cc(r){if(r.general?.helmetRequired!=null)return Te(r.general.helmetRequired);let e=[r.class1,r.class2,r.class3].filter(Boolean).map(s=>s.helmetRequired).filter(s=>s!=null);if(!e.length)return"N/A";let t=[...new Set(e)];return t.length===1?Te(t[0]):"Varies by Class"}function lc(r,e){let t=e[r.classification]||{},s=ac(r);return[{icon:"legal",label:"Status",value:t.label||"Unknown",statusIcon:t.icon,statusColor:t.iconColor},{icon:"tachometer-fast",label:"Top Speed",value:s!=null?`${s} MPH`:"N/A"},{icon:"idbadge",label:"License",value:Te(r.licenseRequired)},{icon:"memo",label:"Registration",value:Te(r.registrationRequired)},{icon:"motorcycle-helmet",label:"Helmet",value:cc(r)},{icon:"auction",label:"DUI",value:Te(r.duiApplies)}]}function dc(r){Mt(r,{classificationMap:oc,buildInfoBoxItems:lc})}var oc,Gi=P(()=>{fr();oc={three_class:{cssClass:"state-legal",label:"Three-Class System",icon:"check-circle",iconColor:"icon-green"},bicycle_equivalent:{cssClass:"state-legal",label:"Bicycle Equivalent",icon:"check-circle",iconColor:"icon-green"},custom_definition:{cssClass:"state-conditional",label:"Custom Definition",icon:"interrogation",iconColor:"icon-orange"},no_specific_law:{cssClass:"state-no-law",label:"No Specific Law",icon:"cross-circle",iconColor:"icon-muted"}}});var Vi={};j(Vi,{init:()=>pc});function hc(r,e){let t=e[r.classification]||{};return[{icon:"legal",label:"Status",value:t.label||"Unknown",statusIcon:t.icon,statusColor:t.iconColor},{icon:"age-alt",label:"Min Age",value:r.minAge!=null?`${r.minAge} yrs`:"N/A"},{icon:"tachometer-fast",label:"Max Speed",value:r.maxSpeedMph!=null?`${r.maxSpeedMph} MPH`:"N/A"},{icon:"motorcycle-helmet",label:"Helmet",value:Te(r.helmetRequired)},{icon:"walking",label:"Sidewalk",value:Te(r.sidewalkRiding)},{icon:"road",label:"Street",value:Te(r.streetRiding)}]}function pc(r){Mt(r,{classificationMap:uc,buildInfoBoxItems:hc})}var uc,ji=P(()=>{fr();uc={specific_escooter:{cssClass:"state-legal",label:"Legal",icon:"check-circle",iconColor:"icon-green"},local_rule:{cssClass:"state-conditional",label:"Varies by Location",icon:"interrogation",iconColor:"icon-orange"},unclear_or_local:{cssClass:"state-conditional",label:"Unclear / Local",icon:"interrogation",iconColor:"icon-orange"},prohibited:{cssClass:"state-prohibited",label:"Prohibited",icon:"cross-circle",iconColor:"icon-red"}}});var zi={};j(zi,{init:()=>Ec});function gc(r){return r>=10&&r<=30?1:r<10?r<0?Math.max(.6,.8+r*.005):1-(10-r)*.02:Math.max(.75,1-(r-30)*.034)}function yc(r){return 1.65-.65*(r/fc)}function vc(r){return{slow:1.15,medium:1,fast:.85}[r]||1}function bc(r){return-.008*Math.log(r)+.0899}function wc(r){return Math.max(.5,1-r*.0365/100)}function Sc(r){let{weightKg:e,tempC:t,speed:s,motorW:i,batteryWh:n,cycles:o}=r,a=bc(i),c=gc(t),d=yc(e),l=vc(s),h=wc(o),u=a*n*c*d*l*h;return{rangeMiles:Math.max(0,u),rangeKm:Math.max(0,u/mc),factors:{baseEfficiency:a,tempFactor:c,weightFactor:d,speedFactor:l,cycleFactor:h}}}function Wi(r){return!r||r<=0?"--":Be(Math.round(r*10)/10)}function Ec(r){let e=!1,t=r.querySelectorAll("[data-unit-system]"),s=r.querySelector('[data-input="weight"]'),i=r.querySelector('[data-label="weight"]'),n=r.querySelector('[data-unit="weight"]'),o=r.querySelector('[data-input="temp"]'),a=r.querySelector('[data-label="temp"]'),c=r.querySelector('[data-unit="temp"]'),d=r.querySelector('[data-input="speed"]'),l=r.querySelector('[data-input="motor"]'),h=r.querySelector('[data-input="battery"]'),u=r.querySelector('[data-input="cycles"]'),p=r.querySelector('[data-result="range"]'),f=r.querySelector('[data-result="unit"]'),m=r.querySelector("[data-calculator-reset]"),g={temp:r.querySelector('[data-factor="temp"]'),weight:r.querySelector('[data-factor="weight"]'),speed:r.querySelector('[data-factor="speed"]'),cycles:r.querySelector('[data-factor="cycles"]')};function y(){i&&(i.textContent=e?"Rider Weight (kg)":"Rider Weight (lbs)"),n&&(n.textContent=e?"kg":"lbs"),s&&(s.placeholder=e?"e.g. 75":"e.g. 165",s.min=e?22:50,s.max=e?200:440),a&&(a.textContent=e?"Temperature (\xB0C)":"Temperature (\xB0F)"),c&&(c.textContent=e?"\xB0C":"\xB0F"),o&&(o.placeholder=e?"e.g. 20":"e.g. 68"),f&&(f.textContent=e?"km":"miles")}function v(){let M=parseFloat(s?.value)||0,E=parseFloat(o?.value)||0;return e||(M=M*ss,E=(E-32)/1.8),{weightKg:M,tempC:E,speed:d?.value||"medium",motorW:parseFloat(l?.value)||0,batteryWh:parseFloat(h?.value)||0,cycles:parseFloat(u?.value)||0}}function w(M){return M.weightKg>0&&M.motorW>0&&M.batteryWh>0}function b(M){if(g.temp&&M){let E=Math.round(M.tempFactor*100);g.temp.textContent=E===100?"Optimal":`${E}%`,g.temp.className=E===100?"factor-value factor-value--good":"factor-value factor-value--warn"}if(g.weight&&M){let E=Math.round(M.weightFactor*100);g.weight.textContent=`${E}%`,g.weight.className=E>=100?"factor-value factor-value--good":"factor-value factor-value--neutral"}if(g.speed&&M){let E=Math.round(M.speedFactor*100);g.speed.textContent=E>100?`+${E-100}%`:E<100?`${E-100}%`:"Baseline"}if(g.cycles&&M){let E=Math.round(M.cycleFactor*100);g.cycles.textContent=E===100?"100%":`${E}%`,g.cycles.className=E>=90?"factor-value factor-value--good":"factor-value factor-value--warn"}}function k(){let M=v();if(!w(M)){p&&(p.textContent="--"),b(null);return}let E=Sc(M);if(p){let S=e?E.rangeKm:E.rangeMiles;p.textContent=Wi(S)}b(E.factors),G(e?E.rangeKm:E.rangeMiles)}let q;function G(M){clearTimeout(q),q=setTimeout(()=>{let E=r.querySelector("[aria-live]");if(E&&M>0){let S=e?"kilometers":"miles";E.textContent=`Estimated range: ${Wi(M)} ${S}.`}},500)}function ee(){s&&(s.value=""),o&&(o.value=""),d&&(d.value="medium"),l&&(l.value=""),h&&(h.value=""),u&&(u.value="1"),p&&(p.textContent="--"),Object.values(g).forEach(E=>{E&&(E.textContent="--")});let M=r.querySelector("[aria-live]");M&&(M.textContent="Calculator reset.")}function re(M){let S=M.currentTarget.dataset.unitSystem,x=S==="metric";if(x!==e){if(s&&s.value){let A=parseFloat(s.value);x?s.value=Math.round(A*ss):s.value=Math.round(A/ss)}if(o&&o.value){let A=parseFloat(o.value);x?o.value=Math.round((A-32)/1.8):o.value=Math.round(A*1.8+32)}}e=x,t.forEach(A=>{A.classList.toggle("is-active",A.dataset.unitSystem===S)}),y(),k()}t.forEach(M=>{M.addEventListener("click",re)}),[s,o,l,h,u].forEach(M=>{M&&M.addEventListener("input",k)}),d&&d.addEventListener("change",k),m&&m.addEventListener("click",ee),y()}var fc,ss,mc,Yi=P(()=>{Pt();fc=79,ss=.453592,mc=.621371});var Lc,is=P(()=>{Lc=Ms({"./calculators/battery-capacity-calculator.js":()=>Promise.resolve().then(()=>(Mi(),Di)),"./calculators/battery-charging-time-calculator.js":()=>Promise.resolve().then(()=>(Bi(),_i)),"./calculators/battery-degradation-calculator.js":()=>Promise.resolve().then(()=>(Ui(),Oi)),"./calculators/electric-bike-laws-by-state.js":()=>Promise.resolve().then(()=>(Gi(),Hi)),"./calculators/electric-scooter-laws-by-state.js":()=>Promise.resolve().then(()=>(ji(),Vi)),"./calculators/electric-scooter-range-calculator.js":()=>Promise.resolve().then(()=>(Yi(),zi)),"./calculators/laws-map.js":()=>Promise.resolve().then(()=>(fr(),Ri))})});var Ki={};j(Ki,{initCalculator:()=>xc});function xc(){let r=document.querySelector("[data-calculator]");if(!r)return null;let e=r.dataset.calculator;return e?(Lc(`./calculators/${e}.js`).then(t=>{typeof t.init=="function"?t.init(r):console.warn(`[Calculator] Module "${e}" has no init function`)}).catch(t=>{console.error(`[Calculator] Failed to load "${e}":`,t)}),{type:e}):(console.warn("[Calculator] No calculator type specified"),null)}var Xi=P(()=>{is()});var Ji={};j(Ji,{initContactForm:()=>kc});function kc(){let r=document.getElementById("erh-contact-form");if(!r)return;let e=document.getElementById("contact-submit"),t=e?.querySelector(".btn-text"),s=e?.querySelector(".btn-loading"),i=document.getElementById("contact-success"),n=document.getElementById("contact-error"),o={name:r.querySelector('[name="name"]'),email:r.querySelector('[name="email"]'),topic:r.querySelector('[name="topic"]'),message:r.querySelector('[name="message"]')},a={name:y=>y.trim()?y.length>100?"Name is too long":null:"Please enter your name",email:y=>y.trim()?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(y)?null:"Please enter a valid email address":"Please enter your email",topic:y=>y?null:"Please select a topic",message:y=>y.trim()?y.trim().length<10?"Message is too short (minimum 10 characters)":y.length>5e3?"Message is too long (maximum 5000 characters)":null:"Please enter a message"};function c(y){return y.closest(".custom-select")||y}function d(y){let v=y.closest(".custom-select");return v?v.querySelector(".custom-select-trigger"):y}function l(y,v){let w=r.querySelector(`[data-error="${y}"]`),b=o[y];w&&(w.textContent=v,w.hidden=!1),b&&(c(b).classList.add("is-error"),b.setAttribute("aria-invalid","true"))}function h(y){let v=r.querySelector(`[data-error="${y}"]`),w=o[y];v&&(v.textContent="",v.hidden=!0),w&&(c(w).classList.remove("is-error"),w.removeAttribute("aria-invalid"))}function u(){Object.keys(o).forEach(h),n&&(n.hidden=!0,n.querySelector("p").textContent="")}function p(y){n&&(n.querySelector("p").textContent=y,n.hidden=!1,n.scrollIntoView({behavior:"smooth",block:"center"}))}function f(){let y=!0,v=null;return u(),Object.entries(a).forEach(([w,b])=>{let k=o[w];if(!k)return;let q=b(k.value);q&&(l(w,q),v||(v=k),y=!1)}),v&&d(v)?.focus(),y}function m(y){e&&(e.disabled=y),t&&(t.hidden=y),s&&(s.hidden=!y)}function g(){r.reset(),r.querySelectorAll('.form-group, .form-row, button[type="submit"]').forEach(y=>{y.style.display="none"}),i&&(i.hidden=!1)}Object.entries(o).forEach(([y,v])=>{if(!v)return;let w=v.tagName==="SELECT"?"change":"blur";v.addEventListener(w,()=>{let b=a[y];if(!b)return;let k=b(v.value);k?l(y,k):h(y)}),v.tagName!=="SELECT"&&v.addEventListener("input",()=>{h(y)})}),r.addEventListener("submit",async y=>{if(y.preventDefault(),!!f()){m(!0),u();try{let v=new FormData(r),w=Object.fromEntries(v.entries()),b=te(),k=await fetch(b+"contact",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(w)}),q,G=k.headers.get("content-type");if(G&&G.includes("application/json"))q=await k.json();else throw new Error("Server error. Please try again later.");if(!k.ok)throw new Error(q.message||"Something went wrong. Please try again.");g()}catch(v){p(v.message||"Failed to send message. Please try again.")}finally{m(!1)}}})}var Qi=P(()=>{xe()});var Zi={};j(Zi,{initFinderTabs:()=>Cc});function Cc(){let r=document.querySelectorAll(".finder-type");if(!r.length)return null;function e(t){r.forEach(s=>s.classList.remove("active")),t.classList.add("active")}return r.forEach(t=>{t.addEventListener("click",()=>e(t)),t.addEventListener("keydown",s=>{let i=Array.from(r),n=i.indexOf(t),o;switch(s.key){case"ArrowLeft":s.preventDefault(),o=n>0?n-1:i.length-1,i[o].focus(),e(i[o]);break;case"ArrowRight":s.preventDefault(),o=n<i.length-1?n+1:0,i[o].focus(),e(i[o]);break;case"Home":s.preventDefault(),i[0].focus(),e(i[0]);break;case"End":s.preventDefault(),i[i.length-1].focus(),e(i[i.length-1]);break}})}),{selectType:t=>{let s=document.querySelector(`.finder-type[data-type="${t}"]`);s&&e(s)},getSelectedType:()=>{let t=document.querySelector(".finder-type.active");return t?t.dataset.type:null}}}var en=P(()=>{});var mr,tn=P(()=>{Ue();fe();mr=class{constructor(e){this.finder=e,this.container=e.container,this.tableView=this.container.querySelector("[data-finder-table-view]"),this.tableEl=this.container.querySelector("[data-finder-table]"),this.tableHead=this.container.querySelector("[data-table-head]"),this.tableBody=this.container.querySelector("[data-table-body]"),this.tableContainer=this.container.querySelector(".finder-table-container"),this.filterCardsEl=this.container.querySelector("[data-active-columns]"),this.loadMoreBtn=this.container.querySelector("[data-table-load-more]"),this.tableFooter=this.container.querySelector("[data-table-footer]"),this.columnModalEl=document.getElementById("columns-modal"),this.columnModal=this.columnModalEl?new le(this.columnModalEl):null,this.columnSearch=document.querySelector("[data-columns-search]"),this.columnGroupsEl=document.querySelector("[data-columns-groups]"),this.columnGroups=e.filterConfig.columnGroups||{},this.columnConfig=e.filterConfig.columnConfig||{},this.rangeConfig=e.filterConfig.ranges||{},this.setConfig=e.filterConfig.sets||{},this.tristateConfig=e.filterConfig.tristates||{},this.defaultColumns=e.filterConfig.defaultTableColumns||["price","top_speed","motor_power","battery","weight","weight_limit"],this.rangesData=e.pageConfig.ranges||{},this.visibleColumns=new Set,this.sortColumn=null,this.sortDirection="desc",this.displayLimit=50,this.displayStep=50,this.currentLimit=this.displayLimit,this.initialized=!1,this.portaledFilters=new Map,this.initColumnsFromURL()}init(){this.initialized||(this.bindEvents(),this.buildColumnModal(),this.buildTable(),this.initialized=!0)}getSidebarFilterElement(e){let t=this.columnConfig[e];if(!t?.filterKey||!t?.filterType)return null;let{filterKey:s,filterType:i}=t,n=this.finder.sidebar;if(!n)return null;switch(i){case"range":return n.querySelector(`[data-range-filter="${s}"]`);case"set":{let o=n.querySelector(`[data-filter-list="${s}"]`);if(!o)return null;let a=o.closest("[data-filter-item]");if(a)return a.querySelector(".filter-item-content");let c=o.closest("[data-filter-group]");return c?c.querySelector(".filter-group-content"):null}case"tristate":return n.querySelector(`[data-tristate-filter="${s}"]`);default:return null}}portalFilterToCard(e,t){let s=this.getSidebarFilterElement(e);if(!s)return!1;let i=s.parentNode;this.portaledFilters.set(e,{element:s,originalParent:i,nextSibling:s.nextSibling}),t.appendChild(s),s.classList.add("is-portaled");let n=i.closest("[data-filter-group]");return n&&n.classList.add("has-portaled-content"),!0}returnFilterToSidebar(e){let t=this.portaledFilters.get(e);if(!t)return;let{element:s,originalParent:i,nextSibling:n}=t;s.classList.remove("is-portaled"),n?i.insertBefore(s,n):i.appendChild(s);let o=i.closest("[data-filter-group]");o&&o.classList.remove("has-portaled-content"),this.portaledFilters.delete(e)}returnAllFiltersToSidebar(){for(let e of this.portaledFilters.keys())this.returnFilterToSidebar(e)}initColumnsFromURL(){let t=new URLSearchParams(window.location.search).get("cols");if(t){let s=t.split(",").filter(i=>this.columnConfig[i]);if(s.length>0){this.visibleColumns=new Set(s);return}}this.visibleColumns=new Set(this.defaultColumns)}bindEvents(){this.columnSearch?.addEventListener("input",t=>this.handleColumnSearch(t.target.value)),this.loadMoreBtn?.addEventListener("click",()=>this.loadMore()),this.tableContainer?.addEventListener("scroll",()=>{this.tableContainer.classList.toggle("is-scrolled",this.tableContainer.scrollLeft>0)}),this.filterCardsEl?.addEventListener("click",t=>{t.target.closest("[data-add-column]")&&this.openColumnModal()}),window.matchMedia("(max-width: 900px)").addEventListener("change",t=>{t.matches?this.portaledFilters.size>0&&this.returnAllFiltersToSidebar():this.container.dataset.view==="table"&&this.initialized&&this.buildFilterCards()})}buildTable(){this.buildFilterCards(),this.buildHeader(),this.renderRows(),this.updateLoadMoreButton()}buildFilterCards(){if(!this.filterCardsEl)return;this.returnAllFiltersToSidebar(),this.filterCardsEl.innerHTML="",this.visibleColumns.forEach(t=>{let s=this.createFilterCard(t);s&&this.filterCardsEl.appendChild(s)});let e=document.createElement("button");e.type="button",e.className="finder-add-column-btn",e.setAttribute("data-add-column",""),e.innerHTML=`
            <svg class="icon"><use href="#icon-plus"></use></svg>
            Add Column
        `,this.filterCardsEl.appendChild(e)}createFilterCard(e){let t=this.columnConfig[e];if(!t||!this.getFilterType(e))return null;let i=t.label||e,n=document.createElement("div");n.className="filter-card",n.dataset.filterCard=e;let o=document.createElement("div");o.className="filter-card-header",o.innerHTML=`
            <span class="filter-card-label">${F(i)}</span>
            <button type="button" class="filter-card-remove" data-remove-column="${e}" aria-label="Remove ${F(i)}">
                <svg class="icon"><use href="#icon-x"></use></svg>
            </button>
        `,o.querySelector("[data-remove-column]").addEventListener("click",()=>{this.toggleColumn(e,!1)});let a=document.createElement("div");return a.className="filter-card-body",this.portalFilterToCard(e,a)?(n.appendChild(o),n.appendChild(a),n):null}getFilterInfo(e){let t=this.columnConfig[e];return!t?.filterKey||!t?.filterType?null:{filterKey:t.filterKey,filterType:t.filterType}}getFilterType(e){return this.columnConfig[e]?.filterType||null}buildHeader(){if(!this.tableHead)return;let e=this.getColumnDefinitions(),t="<tr>";t+="<th>Product</th>",e.forEach(s=>{let i=s.sortable!==!1,o=this.sortColumn===s.columnKey?`data-sort-active="${this.sortDirection}"`:"";t+=`<th ${i?"data-sortable":""} data-column="${s.columnKey}" ${o}>
                ${s.label}
                ${i?`<span class="finder-table-sort-icon">
                    <svg class="icon icon--neutral"><use href="#icon-sort"></use></svg>
                    <svg class="icon icon--asc"><use href="#icon-sort-up"></use></svg>
                    <svg class="icon icon--desc"><use href="#icon-sort-up"></use></svg>
                </span>`:""}
            </th>`}),t+="</tr>",this.tableHead.innerHTML=t,this.tableHead.querySelectorAll("th[data-sortable]").forEach(s=>{s.addEventListener("click",()=>this.handleSort(s.dataset.column))})}getColumnDefinitions(){return Array.from(this.visibleColumns).map(e=>{let t=this.columnConfig[e]||{};return{columnKey:e,key:t.key||e,label:t.label||e,type:t.type||"text",prefix:t.prefix||"",suffix:t.suffix||"",round:t.round,sortable:t.sortable!==!1,sortDir:t.sort_dir||"desc"}})}renderRows(){if(!this.tableBody)return;let e=this.finder.filteredProducts.slice(0,this.currentLimit),t=this.getColumnDefinitions();if(e.length===0){this.tableBody.innerHTML=`<tr><td colspan="${t.length+1}" class="finder-table-cell--empty" style="text-align: center; padding: 48px;">No products match your filters</td></tr>`;return}let s="";e.forEach(i=>{let o=this.finder.comparisonBar.isSelected(i.id)?"is-selected":"";s+=`<tr class="${o}" data-product-id="${i.id}">`,s+=`<td>${this.renderProductCell(i)}</td>`,t.forEach(a=>{s+=`<td>${this.renderCell(a,i)}</td>`}),s+="</tr>"}),this.tableBody.innerHTML=s,this.tableBody.addEventListener("change",i=>{let n=i.target.closest("[data-table-compare]");if(!n)return;this.finder.comparisonBar.handleCheckboxChange(n),n.closest("tr")?.classList.toggle("is-selected",n.checked),this.syncSelectionWithGrid()})}renderProductCell(e){let t=this.finder.comparisonBar.isSelected(e.id),s=e.thumbnail||"";return`
            <div class="finder-table-product-cell">
                <label class="finder-table-product-checkbox">
                    <input type="checkbox" value="${e.id}" data-table-compare ${t?"checked":""}>
                    <span class="finder-table-product-checkbox-box">
                        <svg class="icon"><use href="#icon-check"></use></svg>
                    </span>
                </label>
                ${s?`
                    <div class="finder-table-product-img-wrap">
                        <img src="${s}" alt="" class="finder-table-product-img" loading="lazy">
                    </div>
                `:""}
                <a href="${e.url}" class="finder-table-product-name">${F(e.name)}</a>
            </div>
        `}renderCell(e,t){let s=t[e.key];if(e.type==="currency"&&e.key==="price")return this.renderPriceCell(t);if(s==null||s==="")return'<span class="finder-table-cell--empty">-</span>';switch(e.type){case"currency":return this.renderCurrencyCell(s);case"rating":return this.renderRatingCell(s);case"boolean":return this.renderBooleanCell(s);case"array":return this.renderArrayCell(s);case"number":return this.renderNumberCell(s,e);case"text":default:return e.suffix||e.prefix?this.renderNumberCell(s,e):F(String(s))}}renderPriceCell(e){let t=e.price;if(t==null)return'<span class="finder-table-cell--empty">-</span>';let s=this.finder.formatProductPrice({price:t}),i=this.getPriceIndicator(e);return`<span class="finder-table-cell--price">${s}${i}</span>`}getPriceIndicator(e){let t=e.price_indicator;return t==null?"":t<-5?`<span class="finder-table-indicator finder-table-indicator--below">
                <svg class="icon finder-table-indicator-icon" aria-hidden="true"><use href="#icon-arrow-down"></use></svg>${Math.abs(t)}%
            </span>`:t>10?`<span class="finder-table-indicator finder-table-indicator--above">
                <svg class="icon finder-table-indicator-icon" aria-hidden="true"><use href="#icon-arrow-up"></use></svg>${t}%
            </span>`:""}renderCurrencyCell(e){return`<span class="finder-table-cell--price">${this.finder.formatProductPrice({price:e})}</span>`}renderRatingCell(e){let t=parseFloat(e);if(isNaN(t))return F(String(e));let s="average";return t>=9?s="excellent":t>=8?s="good":t<6&&(s="poor"),`<span class="finder-table-rating finder-table-rating--${s}">${t.toFixed(1)}</span>`}renderBooleanCell(e){let t=e===!0||e==="Yes"||e==="yes"||e==="1"||e===1;return`<span class="finder-table-cell--boolean">
            <span class="finder-table-bool finder-table-bool--${t?"yes":"no"}">
                <svg class="icon"><use href="#icon-${t?"check":"x"}"></use></svg>
            </span>
        </span>`}renderArrayCell(e){return Array.isArray(e)?`<span class="finder-table-cell--array">${F(e.join(", "))}</span>`:F(String(e))}renderNumberCell(e,t){let s=parseFloat(e);return isNaN(s)?`${t.prefix||""}${F(String(e))}${t.suffix||""}`:(t.round!==void 0&&(s=t.round===0?Math.round(s):parseFloat(s.toFixed(t.round))),`${t.prefix||""}${s}${t.suffix||""}`)}handleSort(e){let t=this.columnConfig[e]||{},s=t.key||e,i=t.sort_dir||"desc",n=i==="desc"?"asc":"desc";this.sortColumn===e?this.sortDirection===i?this.sortDirection=n:(this.sortColumn=null,this.sortDirection="desc"):(this.sortColumn=e,this.sortDirection=i),this.sortColumn?this.sortProducts(s):this.finder.sortFilteredProducts(),this.buildHeader(),this.renderRows(),this.updateLoadMoreButton()}sortProducts(e){let t=this.sortDirection;this.finder.filteredProducts.sort((s,i)=>{let n=s[e],o=i[e];if(n==null&&o==null)return 0;if(n==null)return t==="asc"?1:-1;if(o==null)return t==="asc"?-1:1;let a=parseFloat(n),c=parseFloat(o);if(!isNaN(a)&&!isNaN(c))return t==="asc"?a-c:c-a;let d=String(n).toLowerCase(),l=String(o).toLowerCase();return t==="asc"?d.localeCompare(l):l.localeCompare(d)})}toggleColumn(e,t){t?this.visibleColumns.add(e):(this.visibleColumns.delete(e),this.clearFilterForColumn(e)),!t&&this.sortColumn===e&&(this.sortColumn=null,this.sortDirection="desc"),this.buildTable(),this.updateURL(),this.updateModalCheckboxes()}clearFilterForColumn(e){let t=this.getFilterInfo(e);if(!t)return;let{filterKey:s,filterType:i}=t;switch(i){case"range":{(this.rangeConfig[s]||{}).filterMode==="contains"?this.finder.filters[s]={value:null}:this.finder.filters[s]={min:null,max:null};break}case"tristate":{this.finder.filters[s]="any";break}case"set":{let n=Object.keys(this.setConfig).find(o=>this.setConfig[o].selector===s||o===s+"s"||o===s);n&&this.finder.filters[n]&&this.finder.filters[n].clear();break}}this.finder.applyFilters()}updateURL(){this.finder.updateURL()}buildColumnModal(){if(!this.columnGroupsEl)return;let e="";Object.entries(this.columnGroups).forEach(([t,s])=>{let i=s.columns.filter(n=>this.columnConfig[n]?.filterKey);i.length!==0&&(e+=`
                <div class="finder-columns-group" data-column-group="${t}">
                    <h4>${s.label}</h4>
                    <div class="finder-columns-options">
                        ${i.map(n=>{let o=this.columnConfig[n]||{},a=this.visibleColumns.has(n)?"checked":"";return`
                                <label class="finder-columns-option" data-column-option="${n}">
                                    <input type="checkbox" value="${n}" data-column-toggle ${a}>
                                    <span class="finder-columns-option-box">
                                        <svg class="icon"><use href="#icon-check"></use></svg>
                                    </span>
                                    <span class="finder-columns-option-label">${o.label||n}</span>
                                </label>
                            `}).join("")}
                    </div>
                </div>
            `)}),e+='<p class="finder-columns-empty" hidden>No specs match your search</p>',this.columnGroupsEl.innerHTML=e,this.columnGroupsEl.addEventListener("change",t=>{if(t.target.matches("[data-column-toggle]")){let s=t.target.value;this.toggleColumn(s,t.target.checked)}})}updateModalCheckboxes(){this.columnGroupsEl&&this.columnGroupsEl.querySelectorAll("[data-column-toggle]").forEach(e=>{e.checked=this.visibleColumns.has(e.value)})}openColumnModal(){this.columnModal&&(this.columnModal.open(),setTimeout(()=>this.columnSearch?.focus(),200))}closeColumnModal(){this.columnModal&&(this.columnModal.close(),this.columnSearch&&(this.columnSearch.value="",this.handleColumnSearch("")))}handleColumnSearch(e){let t=e.toLowerCase().trim(),s=this.columnGroupsEl?.querySelectorAll("[data-column-group]")||[],i=this.columnGroupsEl?.querySelector(".finder-columns-empty"),n=!1;s.forEach(o=>{let a=o.querySelectorAll("[data-column-option]"),c=!1;a.forEach(d=>{let l=d.querySelector("span")?.textContent?.toLowerCase()||"",h=!t||l.includes(t);d.hidden=!h,h&&(c=!0)}),o.hidden=!c,c&&(n=!0)}),i&&(i.hidden=n)}loadMore(){this.currentLimit+=this.displayStep,this.renderRows(),this.updateLoadMoreButton()}updateLoadMoreButton(){let e=this.finder.filteredProducts.length,t=this.currentLimit<e;this.loadMoreBtn&&(this.loadMoreBtn.hidden=!t),this.tableFooter&&(this.tableFooter.hidden=e===0||!t)}updateData(){if(this.initialized){if(this.currentLimit=this.displayLimit,this.sortColumn){let t=(this.columnConfig[this.sortColumn]||{}).key||this.sortColumn;this.sortProducts(t)}this.buildFilterCards(),this.renderRows(),this.updateLoadMoreButton()}}show(){this.initialized?this.updateData():this.init(),this.tableView.hidden=!1}hide(){this.returnAllFiltersToSidebar(),this.tableView.hidden=!0,this.closeColumnModal()}syncSelectionWithGrid(){this.finder.grid?.querySelectorAll("[data-compare-select]").forEach(e=>{e.checked=this.finder.comparisonBar.isSelected(e.value)})}syncSelectionFromGrid(){this.tableBody&&this.tableBody.querySelectorAll("[data-table-compare]").forEach(e=>{let t=e.value,s=this.finder.comparisonBar.isSelected(t);e.checked=s,e.closest("tr")?.classList.toggle("is-selected",s)})}}});var rn,pt,ns=P(()=>{rn={maxCompare:4,placeholderImage:"/wp-content/themes/erh-theme/assets/images/placeholder.svg"},pt=class{constructor(e){this.container=e.container,this.grid=e.grid,this.getProductById=e.getProductById,this.maxCompare=e.maxCompare||rn.maxCompare,this.bar=this.container.querySelector("[data-comparison-bar]"),this.bar&&(this.productsEl=this.bar.querySelector("[data-comparison-products]"),this.countEl=this.bar.querySelector("[data-comparison-count]"),this.clearBtn=this.bar.querySelector("[data-comparison-clear]"),this.compareLink=this.bar.querySelector("[data-comparison-link]"),this.selectedProducts=new Set,this.bindEvents())}bindEvents(){this.clearBtn?.addEventListener("click",()=>{this.clear()}),this.compareLink?.addEventListener("click",e=>{if(this.selectedProducts.size<2){e.preventDefault();return}let t=Array.from(this.selectedProducts).join(","),s=window.erhData?.siteUrl||"";this.compareLink.href=`${s}/compare/?products=${t}`})}handleCheckboxChange(e){let t=e.value;if(e.checked){if(this.selectedProducts.size>=this.maxCompare)return e.checked=!1,!1;this.selectedProducts.add(t)}else this.selectedProducts.delete(t);return this.update(),!0}toggleProduct(e){let t=String(e);return this.selectedProducts.has(t)?(this.selectedProducts.delete(t),!1):this.selectedProducts.size>=this.maxCompare?!1:(this.selectedProducts.add(t),!0)}isSelected(e){return this.selectedProducts.has(String(e))}getCount(){return this.selectedProducts.size}getSelectedIds(){return Array.from(this.selectedProducts)}update(){if(!this.bar)return;let e=this.selectedProducts.size;this.countEl&&(this.countEl.textContent=e),e>0?(this.bar.classList.add("is-visible"),this.bar.hidden=!1):(this.bar.classList.remove("is-visible"),setTimeout(()=>{this.selectedProducts.size===0&&(this.bar.hidden=!0)},300)),this.compareLink&&this.compareLink.classList.toggle("btn-disabled",e<2),this.renderThumbnails()}renderThumbnails(){this.productsEl&&(this.productsEl.innerHTML="",this.selectedProducts.forEach(e=>{let t=this.getProductById(e);if(!t)return;let s=document.createElement("div");s.className="comparison-bar-thumb-wrapper",s.innerHTML=`
                <img
                    src="${t.thumbnail||rn.placeholderImage}"
                    alt="${t.name||""}"
                    class="comparison-bar-thumb"
                >
                <button
                    type="button"
                    class="comparison-bar-remove"
                    data-remove-product="${e}"
                    aria-label="Remove ${t.name||"product"}"
                >
                    <svg class="icon"><use href="#icon-x"></use></svg>
                </button>
            `,this.productsEl.appendChild(s)}),this.productsEl.querySelectorAll("[data-remove-product]").forEach(e=>{e.addEventListener("click",()=>{let t=e.dataset.removeProduct;this.removeProduct(t)})}))}removeProduct(e){let t=String(e);this.selectedProducts.delete(t);let s=this.grid?.querySelector(`[data-compare-select][value="${t}"]`);s&&(s.checked=!1),this.update()}clear(){this.selectedProducts.clear(),this.grid?.querySelectorAll("[data-compare-select]").forEach(e=>{e.checked=!1}),this.update()}syncCheckboxes(){this.grid?.querySelectorAll("[data-compare-select]").forEach(e=>{e.checked=this.selectedProducts.has(e.value)})}}});var sn={};j(sn,{default:()=>qc,initFinder:()=>Ac});function Ft(r,e=null){if(!$c)return;let t="[Finder]";e?console.log(t,r,e):console.log(t,r)}function Ac(){return new gr}var $c,gr,qc,nn=P(()=>{ne();tn();_e();ns();$c=localStorage.getItem("erh_geo_debug")==="true"||new URLSearchParams(window.location.search).has("geo_debug");gr=class{constructor(){this.container=document.querySelector("[data-finder-page]"),this.container&&(this.grid=this.container.querySelector("[data-finder-grid]"),this.sidebar=this.container.querySelector("[data-finder-sidebar]"),this.activeFiltersBar=this.container.querySelector("[data-active-filters]"),this.emptyState=this.container.querySelector("[data-finder-empty]"),this.resultsCount=this.container.querySelector("[data-results-count]"),this.sortSelect=this.container.querySelector("[data-finder-sort]"),this.loadMoreContainer=this.container.querySelector("[data-load-more]"),this.loadMoreBtn=this.container.querySelector("[data-load-more-btn]"),this.products=window.erhData?.finderProducts||[],this.pageConfig=window.erhData?.finderConfig||{},this.filterConfig=window.erhData?.filterConfig||{},this.displayLimit=48,this.displayStep=48,this.currentLimit=this.displayLimit,this.filteredProducts=[...this.products],this.filters=this.createFilterState(),this.currentSort="popularity",this.comparisonBar=new pt({container:this.container,grid:this.grid,getProductById:e=>this.products.find(t=>String(t.id)===String(e)),maxCompare:4}),this.searchTerm="",this.currentView="grid",this.tableView=null,this.userGeo="US",this.userCurrency="USD",this.currencySymbol="$",this.specDisplayConfig=this.filterConfig.specDisplay||{},this.defaultSpecKeys=this.filterConfig.defaultSpecKeys||[],this.debouncedApplyFilters=this.debounce(()=>this.applyFilters(),150),this.init())}formatSpecValue(e,t){let s=this.specDisplayConfig[e];if(!s||t==null)return null;if(Array.isArray(t)){let o=s.join||", ";return t.join(o)}if(s.raw)return`${s.prefix||""}${t}${s.suffix||""}`;let i=parseFloat(t);if(isNaN(i))return`${s.prefix||""}${t}${s.suffix||""}`;let n;return s.round!==void 0?n=s.round===0?Math.round(i):i.toFixed(s.round):n=i,`${s.prefix||""}${n}${s.suffix||""}`}createFilterState(){let e={},t=this.filterConfig;return Object.keys(t.sets||{}).forEach(s=>{e[s]=new Set}),Object.keys(t.ranges||{}).forEach(s=>{t.ranges[s].filterMode==="contains"?e[s]={value:null}:e[s]={min:null,max:null}}),Object.keys(t.booleans||{}).forEach(s=>{e[s]=!1}),Object.keys(t.tristates||{}).forEach(s=>{e[s]="any"}),e}initFromURL(){let e=new URLSearchParams(window.location.search),t=this.filterConfig;this.initialView=e.get("view")||"grid";let s=e.get("sort");s&&this.sortSelect&&(this.sortSelect.value=s,this.currentSort=s);let i=e.get("q");if(i){this.searchTerm=i;let n=this.container.querySelector("[data-product-search-input]");n&&(n.value=i)}for(let[n,o]of Object.entries(t.ranges||{})){let a=e.get(n);if(!a)continue;let c=this.pageConfig.ranges?.[n];if(c){if(o.filterMode==="contains"){let d=parseFloat(a);isNaN(d)||(d=Math.max(c.min,Math.min(c.max,d)),this.filters[n]={value:d})}else if(a.includes("-")){let[d,l]=a.split("-").map(Number);!isNaN(d)&&!isNaN(l)&&(d=Math.max(c.min,Math.min(c.max,d)),l=Math.max(c.min,Math.min(c.max,l)),d>l&&(d=l),this.filters[n]={min:d>c.min?d:null,max:l<c.max?l:null})}}}for(let[n,o]of Object.entries(t.sets||{})){let a=e.get(n);if(!a)continue;let c=a.split(",").filter(Boolean);c.length>0&&(this.filters[n]=new Set(c))}for(let[n,o]of Object.entries(t.tristates||{})){let a=e.get(n);a&&["yes","no"].includes(a)&&(this.filters[n]=a)}}syncUIToFilters(){let e=this.filterConfig;for(let[t,s]of Object.entries(e.ranges||{})){let i=this.filters[t],n=this.container.querySelector(`[data-range-filter="${t}"]`);if(!n||!i)continue;let o=this.pageConfig.ranges?.[t];if(o){if(s.filterMode==="contains"&&i.value!=null){let a=Math.max(o.min,Math.min(o.max,i.value)),c=n.querySelector("[data-range-value]");c&&(c.value=a);let d=n.querySelector("[data-range-slider]"),l=d?.querySelector(".filter-range-handle"),h=d?.querySelector(".filter-range-fill");if(l&&h){let u=Math.max(0,Math.min(1,(a-o.min)/(o.max-o.min)));l.style.setProperty("--pos",u),h.style.setProperty("--pos",u)}}else if(i.min!=null||i.max!=null){let a=n.querySelector("[data-range-min]"),c=n.querySelector("[data-range-max]"),d=i.min??o.min,l=i.max??o.max;d=Math.max(o.min,Math.min(o.max,d)),l=Math.max(o.min,Math.min(o.max,l)),d>l&&(d=l),a&&(a.value=d),c&&(c.value=l),this.updateSliderVisuals(n.querySelector("[data-range-slider]"),d,l,o.min,o.max)}}}for(let[t,s]of Object.entries(e.sets||{})){let i=this.filters[t];if(!i||i.size===0)continue;let n=s.selector||t;this.container.querySelectorAll(`[data-filter="${n}"]`).forEach(o=>{o.checked=i.has(o.value)})}for(let[t,s]of Object.entries(e.tristates||{})){let i=this.filters[t];if(!i||i==="any")continue;let n=this.container.querySelector(`[data-tristate-filter="${t}"]`);if(!n)continue;n.querySelectorAll(".filter-tristate-btn").forEach(a=>{let c=a.dataset.value===i;a.classList.toggle("is-active",c),a.setAttribute("aria-checked",c)});let o=n.querySelector("[data-tristate-input]");o&&(o.value=i)}}updateURL(){let e=new URLSearchParams,t=this.filterConfig;if(this.currentView!=="grid"&&e.set("view",this.currentView),this.currentView==="table"&&this.tableView){let i=Array.from(this.tableView.visibleColumns).join(","),n=this.tableView.defaultColumns.join(",");i!==n&&e.set("cols",i)}this.currentSort&&this.currentSort!=="popularity"&&e.set("sort",this.currentSort),this.searchTerm&&e.set("q",this.searchTerm);for(let[i,n]of Object.entries(t.ranges||{})){let o=this.filters[i];if(!o)continue;let a=this.pageConfig.ranges?.[i];if(a){if(n.filterMode==="contains")o.value!=null&&e.set(i,o.value);else if(o.min!=null||o.max!=null){let c=o.min??a.min,d=o.max??a.max;c===a.min&&d===a.max||e.set(i,`${c}-${d}`)}}}for(let[i,n]of Object.entries(t.sets||{})){let o=this.filters[i];o?.size>0&&e.set(i,Array.from(o).join(","))}for(let[i,n]of Object.entries(t.tristates||{})){let o=this.filters[i];o&&o!=="any"&&e.set(i,o)}let s=e.toString()?`${window.location.pathname}?${e}`:window.location.pathname;history.replaceState(null,"",s)}async init(){if(this.initFromURL(),await this.detectUserGeo(),this.processProductsForGeo(),this.bindFilterEvents(),this.bindTristateEvents(),this.bindSortEvents(),this.bindComparisonEvents(),this.bindPriceAlertEvents(),this.bindRangeSliders(),this.bindHeightInputs(),this.bindFilterItemToggles(),this.bindFilterSearch(),this.bindFilterListSearch(),this.bindFilterShowAll(),this.bindViewToggle(),this.bindLoadMore(),this.bindProductSearch(),this.bindMobileFilter(),this.syncUIToFilters(),this.applyFilters(),this.initialView==="table"){let e=this.container.querySelector('.view-toggle-btn[data-view="table"]');e&&e.click()}}async detectUserGeo(){Ft("Detecting user geo...");try{let e=await z();this.userGeo=e.geo,this.userCurrency=e.currency,this.currencySymbol=e.symbol,Ft("Geo detected",{geo:this.userGeo,currency:this.userCurrency,country:e.country})}catch(e){Ft("Geo detection failed, using default US",{error:e.message})}}processProductsForGeo(){let e=window.erhData?.finderProducts||[];Ft("Processing products for geo",{userGeo:this.userGeo,totalProducts:e.length});let t=0,s=0;this.products=e.map(i=>{let o=(i.pricing||{})[this.userGeo]||{};return o.current_price&&t++,o.tracked_url&&s++,{...i,price:o.current_price??null,current_price:o.current_price??null,in_stock:o.instock??!1,best_link:o.tracked_url??null,tracked_url:o.tracked_url??null,retailer:o.retailer??null,avg_3m:o.avg_3m??null,avg_6m:o.avg_6m??null,price_indicator:this.calculatePriceIndicator(o.current_price,o.avg_6m)}}),Ft("Products processed",{userGeo:this.userGeo,productsWithPrice:t,productsWithTrackedUrl:s,totalProducts:this.products.length}),this.filteredProducts=[...this.products],this.updatePriceFilterBounds(),this.updatePriceFilterUI()}calculatePriceIndicator(e,t){return!e||!t||t<=0?null:Math.round((e-t)/t*100)}updatePriceFilterBounds(){let e=this.products.map(i=>i.price).filter(i=>i!==null&&i>0),t=e.length>0?Math.ceil(Math.max(...e)/100)*100:5e3;this.filterConfig.ranges?.price&&(this.filterConfig.ranges.price.max=t);let s=this.container?.querySelector('[data-range-filter="price"]');if(s){let i=s.querySelector("[data-range-max]");i&&(i.max=t,parseFloat(i.value)>=t&&(i.value=t))}}updatePriceFilterUI(){if(!this.container)return;let e=this.currencySymbol;this.container.querySelectorAll('[data-range-filter="price"] .filter-preset-label').forEach(i=>{i.dataset.template||(i.dataset.template=i.textContent),i.textContent=i.dataset.template.replace(/\$/g,e)}),this.container.querySelectorAll('[data-range-filter="price"] .filter-range-prefix').forEach(i=>{i.textContent=e})}formatProductPrice(e){return e.price?_(e.price,this.userCurrency):""}bindLoadMore(){this.loadMoreBtn?.addEventListener("click",()=>this.loadMore())}loadMore(){this.currentLimit+=this.displayStep,this.renderProducts(),this.updateResultsCount()}bindFilterEvents(){let e=this.filterConfig;this.container.addEventListener("change",t=>{let s=t.target.closest("[data-filter]");if(!s||s.type!=="checkbox")return;let i=s.dataset.filter;for(let[n,o]of Object.entries(e.sets||{}))if(o.selector===i){s.checked?this.filters[n].add(s.value):this.filters[n].delete(s.value),this.applyFilters();return}for(let[n,o]of Object.entries(e.booleans||{}))if(o.selector===i){this.filters[n]=s.checked,this.applyFilters();return}}),this.container.addEventListener("click",t=>{t.target.closest("[data-clear-filters]")&&this.clearAllFilters()})}bindTristateEvents(){this.container.addEventListener("click",e=>{let t=e.target.closest(".filter-tristate-btn");if(!t)return;let s=t.closest("[data-tristate-filter]");if(!s)return;let i=s.dataset.tristateFilter,n=t.dataset.value,o=s.querySelectorAll(".filter-tristate-btn"),a=s.querySelector("[data-tristate-input]");o.forEach(c=>{c.classList.remove("is-active"),c.setAttribute("aria-checked","false")}),t.classList.add("is-active"),t.setAttribute("aria-checked","true"),a&&(a.value=n),this.filters[i]=n,this.applyFilters()})}bindRangeSliders(){this.container.addEventListener("change",e=>{let t=e.target.closest("[data-range-min], [data-range-max], [data-range-value]");if(!t)return;let s=t.closest("[data-range-filter]");s&&this.handleRangeInputChange(s)}),this.container.addEventListener("change",e=>{let t=e.target.closest("[data-preset]");if(!t||!t.checked)return;let s=t.closest("[data-range-filter]");s&&this.handlePresetChange(s,t)}),this.container.addEventListener("pointerdown",e=>{let t=e.target.closest("[data-preset]")||e.target.closest(".filter-preset")?.querySelector("[data-preset]");t&&(t.dataset.wasChecked=t.checked?"true":"false")}),this.container.addEventListener("click",e=>{let t=e.target.closest("[data-preset]")||e.target.closest(".filter-preset")?.querySelector("[data-preset]");if(t)if(t.dataset.wasChecked==="true"){delete t.dataset.wasChecked;let s=t.closest("[data-range-filter]");if(!s)return;requestAnimationFrame(()=>{t.checked=!1});let i=s.dataset.rangeFilter,n=s.dataset.filterMode==="contains",o=parseFloat(s.dataset.min)||0,a=parseFloat(s.dataset.max)||100;if(n){this.filters[i]={value:null};let c=s.querySelector("[data-range-value]");c&&(c.value="")}else{this.filters[i]={min:null,max:null};let c=s.querySelector("[data-range-min]"),d=s.querySelector("[data-range-max]");c&&(c.value=o),d&&(d.value=a),this.updateSliderVisuals(s.querySelector("[data-range-slider]"),o,a,o,a)}this.applyFilters()}else delete t.dataset.wasChecked}),this.container.querySelectorAll("[data-range-filter]").forEach(e=>{this.initRangeSlider(e)})}initRangeSlider(e){if(!e||e.dataset.rangeInitialized)return;e.dataset.rangeInitialized="true";let t=e.dataset.rangeFilter,s=e.dataset.filterMode==="contains",i=parseFloat(e.dataset.min)||0,n=parseFloat(e.dataset.max)||100,o=parseFloat(e.dataset.step)||1;if(this.updateDistributionBars(e,0,1),s){let a=e.querySelector("[data-range-slider]"),c=a?.querySelector('[data-handle="value"]');a&&c&&this.initSingleSliderDrag(a,c,i,n,o,t,e)}else{let a=e.querySelector("[data-range-slider]"),c=a?.querySelector('[data-handle="min"]'),d=a?.querySelector('[data-handle="max"]'),l=e.querySelector("[data-range-min]"),h=e.querySelector("[data-range-max]"),u=a?.querySelector(".filter-range-fill");c&&d&&a&&l&&h&&this.initSliderDrag(a,c,d,u,l,h,i,n,o,t,e)}}handleRangeInputChange(e){let t=e.dataset.rangeFilter,s=e.dataset.filterMode==="contains",i=parseFloat(e.dataset.min)||0,n=parseFloat(e.dataset.max)||100,o=parseFloat(e.dataset.step)||1;if(s){let a=e.querySelector("[data-range-value]"),c=a?.value?parseFloat(a.value):null;c!==null&&(isNaN(c)||c<i?(c=null,a&&(a.value="")):c>n&&(c=n,a&&(a.value=n))),this.filters[t]={value:c}}else{let a=e.querySelector("[data-range-min]"),c=e.querySelector("[data-range-max]"),d=e.querySelector("[data-range-slider]"),l=parseFloat(a?.value),h=parseFloat(c?.value);isNaN(l)&&(l=i),isNaN(h)&&(h=n),l=this.snapToStep(l,o),h=this.snapToStep(h,o),l=Math.max(i,Math.min(n,l)),h=Math.max(i,Math.min(n,h)),l>h&&([l,h]=[h,l]),a&&(a.value=l),c&&(c.value=h),this.filters[t]={min:l>i?l:null,max:h<n?h:null},this.updateSliderVisuals(d,l,h,i,n)}this.deselectPresets(e),this.applyFilters()}handlePresetChange(e,t){let s=e.dataset.rangeFilter,i=e.dataset.filterMode==="contains",n=parseFloat(e.dataset.min)||0,o=parseFloat(e.dataset.max)||100;if(i){let a=t.dataset.presetValue,c=e.querySelector("[data-range-value]"),d=e.querySelector("[data-range-slider]"),l=d?.querySelector('[data-handle="value"]'),h=d?.querySelector(".filter-range-fill"),u=e.querySelector("[data-height-input]");if(a!==void 0&&a!==""){let p=parseFloat(a);if(c&&(c.value=p),this.filters[s]={value:p},u){let f=u.querySelector("[data-height-feet]"),m=u.querySelector("[data-height-inches]"),{feet:g,inches:y}=this.inchesToFeetInches(p);f&&(f.value=g),m&&(m.value=y)}if(l&&h){let f=(p-n)/(o-n);l.style.setProperty("--pos",Math.max(0,Math.min(1,f))),h.style.setProperty("--pos",Math.max(0,Math.min(1,f)))}}}else{let a=t.dataset.presetMin,c=t.dataset.presetMax,d=e.querySelector("[data-range-min]"),l=e.querySelector("[data-range-max]"),h=e.querySelector("[data-range-slider]"),u=a!==void 0&&a!==""?parseFloat(a):n,p=c!==void 0&&c!==""?parseFloat(c):o;u=Math.max(n,Math.min(o,u)),p=Math.max(n,Math.min(o,p)),u>p&&(u=p),d&&(d.value=u),l&&(l.value=p),this.filters[s]={min:u>n?u:null,max:p<o?p:null},this.updateSliderVisuals(h,u,p,n,o)}this.applyFilters()}deselectPresets(e){e.querySelectorAll("[data-preset]").forEach(t=>{t.checked=!1})}bindHeightInputs(){this.container.querySelectorAll("[data-height-input]").forEach(e=>{let t=e.closest("[data-range-filter]");if(!t)return;let s=t.dataset.rangeFilter,i=e.querySelector("[data-height-feet]"),n=e.querySelector("[data-height-inches]"),o=e.querySelector("[data-range-value]"),a=t.querySelector("[data-range-slider]"),c=a?.querySelector('[data-handle="value"]'),d=a?.querySelector(".filter-range-fill"),l=parseFloat(t.dataset.min)||0,h=parseFloat(t.dataset.max)||100,u=()=>{let p=parseInt(i.value,10)||0,f=parseInt(n.value,10)||0;p=Math.max(0,Math.min(8,p)),f=Math.max(0,Math.min(11,f)),i.value!==""&&parseInt(i.value,10)!==p&&(i.value=p),n.value!==""&&parseInt(n.value,10)!==f&&(n.value=f);let m=this.feetInchesToInches(p,f);if(m>0&&(m=Math.max(l,Math.min(h,m))),o.value=m>0?m:"",this.filters[s]={value:m>0?m:null},c&&d&&m>0){let g=(m-l)/(h-l);c.style.setProperty("--pos",Math.max(0,Math.min(1,g))),d.style.setProperty("--pos",Math.max(0,Math.min(1,g)))}this.deselectPresets(t),this.applyFilters()};i?.addEventListener("change",u),n?.addEventListener("change",u),a&&c&&this.initSingleSliderDrag(a,c,d,l,h,s,t,p=>{let{feet:f,inches:m}=this.inchesToFeetInches(p);i.value=f,n.value=m,o.value=p})})}initSingleSliderDrag(e,t,s,i,n,o,a,c){let d=!1,l=p=>{let f=Math.round(i+p*(n-i));t.style.setProperty("--pos",p),s.style.setProperty("--pos",p),c&&c(f)},h=p=>{d&&(p.preventDefault(),l(this.getPositionFromEvent(p,e)))},u=()=>{if(!d)return;d=!1,document.removeEventListener("mousemove",h),document.removeEventListener("mouseup",u),document.removeEventListener("touchmove",h),document.removeEventListener("touchend",u);let p=parseFloat(t.style.getPropertyValue("--pos"))||0,f=Math.round(i+p*(n-i));this.filters[o]={value:f>i?f:null},this.deselectPresets(a),this.applyFilters()};t.addEventListener("mousedown",()=>{d=!0,document.addEventListener("mousemove",h),document.addEventListener("mouseup",u)}),t.addEventListener("touchstart",()=>{d=!0,document.addEventListener("touchmove",h,{passive:!1}),document.addEventListener("touchend",u)})}initSliderDrag(e,t,s,i,n,o,a,c,d,l,h){let u=null,p=(g,y)=>{let v=a+y*(c-a),w=this.snapToStep(v,d),b=(w-a)/(c-a);if(g===t){let k=parseFloat(s.style.getPropertyValue("--pos"))||1;b<=k&&(t.style.setProperty("--pos",b),n.value=w,i.style.setProperty("--min",b),this.updateDistributionBars(h,b,k))}else{let k=parseFloat(t.style.getPropertyValue("--pos"))||0;b>=k&&(s.style.setProperty("--pos",b),o.value=w,i.style.setProperty("--max",b),this.updateDistributionBars(h,k,b))}},f=g=>{u&&(g.preventDefault(),p(u,this.getPositionFromEvent(g,e)))},m=()=>{u&&(u=null,document.removeEventListener("mousemove",f),document.removeEventListener("mouseup",m),document.removeEventListener("touchmove",f),document.removeEventListener("touchend",m),this.filters[l]={min:parseFloat(n.value)>a?parseFloat(n.value):null,max:parseFloat(o.value)<c?parseFloat(o.value):null},this.deselectPresets(h),this.applyFilters())};[t,s].forEach(g=>{g.addEventListener("mousedown",()=>{u=g,document.addEventListener("mousemove",f),document.addEventListener("mouseup",m)}),g.addEventListener("touchstart",()=>{u=g,document.addEventListener("touchmove",f,{passive:!1}),document.addEventListener("touchend",m)})})}updateSliderVisuals(e,t,s,i,n){if(!e)return;let o=Math.max(0,Math.min(1,(t-i)/(n-i))),a=Math.max(0,Math.min(1,(s-i)/(n-i))),c=e.querySelector('[data-handle="min"]'),d=e.querySelector('[data-handle="max"]'),l=e.querySelector(".filter-range-fill");c?.style.setProperty("--pos",o),d?.style.setProperty("--pos",a),l?.style.setProperty("--min",o),l?.style.setProperty("--max",a),this.updateDistributionBars(e.closest("[data-range-filter]"),o,a)}updateDistributionBars(e,t,s){if(!e)return;let i=e.querySelectorAll(".filter-range-bar"),n=i.length;n!==0&&i.forEach((o,a)=>{let c=a/n,l=(a+1)/n>t&&c<s;o.classList.toggle("is-selected",l)})}clearRangeFilter(e,t,s,i,n,o,a,c,d,l){if(s){let h=e.querySelector("[data-range-value]");if(h&&(h.value=""),c){let u=c.querySelector("[data-height-feet]"),p=c.querySelector("[data-height-inches]");u&&(u.value=""),p&&(p.value="")}d&&l&&(d.style.setProperty("--pos",0),l.style.setProperty("--pos",0))}else{let h=e.querySelector("[data-range-min]"),u=e.querySelector("[data-range-max]");h&&(h.value=i),u&&(u.value=n),this.updateSliderVisuals(a,i,n,i,n)}}getPositionFromEvent(e,t){let s=t.getBoundingClientRect(),i=9,n=s.width-i*2,o=(e.type.includes("touch")?e.touches[0].clientX:e.clientX)-s.left-i;return Math.max(0,Math.min(1,o/n))}inchesToFeetInches(e){return{feet:Math.floor(e/12),inches:e%12}}feetInchesToInches(e,t){return e*12+t}snapToStep(e,t=1){let s=Math.round(e/t)*t,i=t<1?Math.ceil(-Math.log10(t)):0;return parseFloat(s.toFixed(i))}debounce(e,t){let s;return(...i)=>{clearTimeout(s),s=setTimeout(()=>e.apply(this,i),t)}}bindFilterItemToggles(){this.container.querySelectorAll("[data-filter-item-toggle]").forEach(e=>{e.addEventListener("click",()=>{e.closest("[data-filter-item]")?.classList.toggle("is-open")})}),this.container.querySelector("[data-filter-item]")?.classList.add("is-open")}bindFilterSearch(){let e=this.container.querySelector("[data-filter-search-container]"),t=this.container.querySelector("[data-filter-search]"),s=this.container.querySelector("[data-filter-search-clear]");if(!t)return;let i=()=>{let n=t.value.toLowerCase().trim();e?.classList.toggle("has-value",!!n),this.container.querySelectorAll(".filter-item").forEach(o=>{let a=o.querySelector(".filter-item-label")?.textContent?.toLowerCase()||"";o.style.display=!n||a.includes(n)?"":"none"}),this.container.querySelectorAll(".filter-tristate").forEach(o=>{let a=o.querySelector(".filter-tristate-label")?.textContent?.toLowerCase()||"";o.style.display=!n||a.includes(n)?"":"none"}),this.container.querySelectorAll(".filter-group-content > .filter-checkbox").forEach(o=>{let a=o.querySelector(".filter-checkbox-label")?.textContent?.toLowerCase()||"";o.style.display=!n||a.includes(n)?"":"none"}),this.container.querySelectorAll(".filter-toggle").forEach(o=>{let a=o.querySelector(".filter-toggle-label")?.textContent?.toLowerCase()||"";o.style.display=!n||a.includes(n)?"":"none"}),this.container.querySelectorAll(".filter-group").forEach(o=>{let a=o.querySelector(".filter-group-content");if(!a)return;let c=Array.from(a.children).some(d=>d.style.display!=="none");o.style.display=!n||c?"":"none"})};t.addEventListener("input",i),s?.addEventListener("click",()=>{t.value="",i(),t.focus()})}bindProductSearch(){let e=this.container.querySelector("[data-product-search]"),t=this.container.querySelector("[data-product-search-input]"),s=this.container.querySelector("[data-product-search-clear]");if(!t)return;let i=()=>{this.searchTerm=t.value.trim(),e?.classList.toggle("has-value",!!this.searchTerm),this.debouncedApplyFilters()};t.addEventListener("input",i),t.addEventListener("keydown",n=>{n.key==="Enter"&&(n.preventDefault(),this.applyFilters())}),s?.addEventListener("click",()=>{t.value="",this.searchTerm="",e?.classList.remove("has-value"),this.applyFilters(),t.focus()})}bindMobileFilter(){let e=this.container.querySelector("[data-filter-toggle]"),t=this.container.querySelector("[data-filter-close]"),s=this.container.querySelector("[data-filter-overlay]");if(!e||!this.sidebar)return;let i=()=>{this.sidebar.classList.add("is-open"),s?.classList.add("is-visible"),document.body.style.overflow="hidden"},n=()=>{this.sidebar.classList.remove("is-open"),s?.classList.remove("is-visible"),document.body.style.overflow=""};e.addEventListener("click",i),t?.addEventListener("click",n),s?.addEventListener("click",n),document.addEventListener("keydown",o=>{o.key==="Escape"&&this.sidebar.classList.contains("is-open")&&n()})}bindFilterListSearch(){this.container.querySelectorAll("[data-filter-list-search]").forEach(e=>{let t=e.dataset.filterListSearch,s=this.container.querySelector(`[data-filter-list-search-container="${t}"]`),i=this.container.querySelector(`[data-filter-list="${t}"]`),n=this.container.querySelector(`[data-filter-no-results="${t}"]`),o=this.container.querySelector(`[data-filter-show-all="${t}"]`),a=this.container.querySelector(`[data-filter-list-search-clear="${t}"]`);if(!i)return;let c=()=>{let d=e.value.toLowerCase().trim(),l=0;s?.classList.toggle("has-value",!!d),i.querySelectorAll(".filter-checkbox").forEach(h=>{let u=h.querySelector(".filter-checkbox-label")?.textContent?.toLowerCase()||"",p=!d||u.includes(d);d?(h.hidden=!p,h.classList.remove("is-hidden-by-limit")):h.hidden=!1,p&&l++}),n&&(n.hidden=l>0||!d),o&&(o.hidden=!!d),d||this.resetFilterListLimit(t)};e.addEventListener("input",c),a?.addEventListener("click",()=>{e.value="",c(),e.focus()})})}resetFilterListLimit(e){let t=this.container.querySelector(`[data-filter-list="${e}"]`),s=this.container.querySelector(`[data-filter-show-all="${e}"]`);if(!t)return;let i=parseInt(t.dataset.limit,10)||8,n=t.classList.contains("is-expanded");t.querySelectorAll(".filter-checkbox").forEach((o,a)=>{o.hidden=!1,!n&&a>=i?o.classList.add("is-hidden-by-limit"):o.classList.remove("is-hidden-by-limit")}),s&&(s.hidden=!1)}bindFilterShowAll(){this.container.addEventListener("click",e=>{let t=e.target.closest("[data-filter-show-all]");if(!t)return;let s=t.dataset.filterShowAll,i=this.container.querySelector(`[data-filter-list="${s}"]`),n=t.querySelector("[data-show-text]"),o=t.querySelector("[data-hide-text]");if(!i)return;let a=i.classList.toggle("is-expanded");n&&(n.hidden=a),o&&(o.hidden=!a)})}applyFilters(){this.currentLimit=this.displayLimit,this.filteredProducts=this.products.filter(e=>this.productMatchesFilters(e)),this.sortFilteredProducts(),this.renderProducts(),this.updateResultsCount(),this.updateActiveFiltersBar(),this.tableView&&this.currentView==="table"&&this.tableView.updateData(),this.updateURL()}productMatchesFilters(e){let t=this.filterConfig;if(this.searchTerm){let s=this.searchTerm.toLowerCase(),i=(e.name||"").toLowerCase(),n=(e.brand||"").toLowerCase();if(!i.includes(s)&&!n.includes(s))return!1}for(let[s,i]of Object.entries(t.sets||{})){let n=this.filters[s];if(n.size>0){let o=e[i.productKey];if(i.isArray){if(!o||!Array.isArray(o)||!o.some(c=>n.has(c)))return!1}else if(!o||!n.has(o))return!1}}for(let[s,i]of Object.entries(t.ranges||{})){let n=this.filters[s];if(i.filterMode==="contains"){if(n.value!==null){let a=e[i.productKeyMin],c=e[i.productKeyMax];if(a==null&&c==null||a!=null&&n.value<a||c!=null&&n.value>c)return!1}continue}let o=e[i.productKey];if(s==="price"){if(o==null){if(n.min!==null&&n.min>0)return!1}else if(n.min!==null&&o<n.min||n.max!==null&&o>n.max)return!1;continue}if(o==null){if(n.min!==null||n.max!==null)return!1}else if(n.min!==null&&o<n.min||n.max!==null&&o>n.max)return!1}for(let[s,i]of Object.entries(t.booleans||{}))if(this.filters[s]&&!e[i.productKey])return!1;for(let[s,i]of Object.entries(t.tristates||{})){let n=this.filters[s];if(n==="any")continue;let o=e[i.productKey];if(n==="yes"&&o!==!0||n==="no"&&o!==!1)return!1}return!0}renderProducts(){let e=this.filteredProducts.slice(0,this.currentLimit);if(this.grid.innerHTML="",e.forEach(t=>{this.grid.appendChild(this.createProductCard(t))}),this.currentView==="grid"){let t=this.filteredProducts.length>0;this.emptyState&&(this.emptyState.hidden=t),this.grid&&(this.grid.style.display=t?"":"none"),this.updateLoadMoreButton()}}createProductCard(e){let t=document.createElement("article");t.className="product-card",t.dataset.productId=e.id;let s=this.comparisonBar.isSelected(e.id),i=this.getPriceIndicator(e),n=this.formatProductSpecs(e);return t.innerHTML=`
            <label class="product-card-select" onclick="event.stopPropagation()">
                <input type="checkbox"
                       data-compare-select
                       value="${e.id}"
                       ${s?"checked":""}>
                <span class="product-card-select-box">
                    <svg class="icon"><use href="#icon-check"></use></svg>
                </span>
            </label>

            ${e.price?`<button class="product-card-track" data-track-price="${e.id}" aria-label="Track price">
                <svg class="icon"><use href="#icon-bell"></use></svg>
            </button>`:""}

            <a href="${e.url}" class="product-card-link">
                <div class="product-card-image">
                    <img src="${e.thumbnail||"/wp-content/themes/erh-theme/assets/images/placeholder.svg"}"
                         alt="${e.name}"
                         loading="lazy">${e.price?`<div class="product-card-price-row">
                        <span class="product-card-price">${this.formatProductPrice(e)}</span>
                        ${i}
                    </div>`:""}
                </div>
            </a>

            <div class="product-card-content">
                <h3 class="product-card-name">
                    <a href="${e.url}">${e.name}</a>
                </h3>
                ${n?`<p class="product-card-specs">${n}</p>`:""}
            </div>
        `,t}getActiveSpecFilterKeys(){let e=["price","rider_height","in_stock"],t=[];for(let[s,i]of Object.entries(this.filters))e.includes(s)||this.specDisplayConfig[s]&&i&&typeof i=="object"&&(i.min!=null||i.max!=null||i.value!=null)&&t.push(s);return t}formatProductSpecs(e){let s=this.getActiveSpecFilterKeys(),i=new Set,n=[],o=[],a=h=>{if(i.has(h))return null;let u=this.specDisplayConfig[h];if(!u)return null;let p=e[u.key];return p==null||p===0?null:(i.add(h),this.formatSpecValue(h,p))},c=[...s].sort((h,u)=>{let p=this.specDisplayConfig[h]?.priority??99,f=this.specDisplayConfig[u]?.priority??99;return p-f}),d=0;for(let h of c){if(d>=7)break;let u=a(h);u&&(n.push(u),d++)}for(let h of this.defaultSpecKeys){if(d>=7)break;let u=a(h);u&&(o.push(u),d++)}let l=[];return n.length>0&&l.push(`<span class="specs-active">${n.join(", ")}</span>`),o.length>0&&l.push(o.join(", ")),l.join(" \xB7 ")}getPriceIndicator(e){if(!e.price_indicator)return"";let t=e.price_indicator;return t<-5?`<span class="product-card-indicator product-card-indicator--below">
                <svg class="icon product-card-indicator-icon" aria-hidden="true"><use href="#icon-arrow-down"></use></svg>${Math.abs(t)}%
            </span>`:t>10?`<span class="product-card-indicator product-card-indicator--above">
                <svg class="icon product-card-indicator-icon" aria-hidden="true"><use href="#icon-arrow-up"></use></svg>${t}%
            </span>`:""}updateLoadMoreButton(){if(!this.loadMoreContainer)return;let e=this.currentLimit<this.filteredProducts.length;if(this.loadMoreContainer.hidden=!e,e&&this.loadMoreBtn){let t=this.filteredProducts.length-this.currentLimit,s=Math.min(t,this.displayStep);this.loadMoreBtn.textContent=`Load ${s} more`}}updateResultsCount(){if(!this.resultsCount)return;let e=this.filteredProducts.length,t=this.pageConfig.shortName||"product";this.resultsCount.innerHTML=`<strong>${e}</strong> ${t}s`}updateActiveFiltersBar(){if(!this.activeFiltersBar)return;let e=this.filterConfig,t=[];if(this.searchTerm&&t.push(this.createFilterPill(`"${this.searchTerm}"`,"search")),Object.entries(e.sets||{}).forEach(([s,i])=>{this.filters[s].forEach(n=>{let o=this.formatSetPillLabel(i,n);t.push(this.createFilterPill(o,s,n))})}),Object.entries(e.ranges||{}).forEach(([s,i])=>{let n=this.filters[s];if(i.filterMode==="contains"){if(n.value!==null){let o=this.formatContainsPillLabel(i,n.value);t.push(this.createFilterPill(o,s))}}else if(n.min!==null||n.max!==null){let o=this.pageConfig.ranges?.[s]||{min:0,max:100},a=n.min??o.min,c=n.max??o.max,d=this.formatRangePillLabel(i,a,c);t.push(this.createFilterPill(d,s))}}),Object.entries(e.booleans||{}).forEach(([s,i])=>{this.filters[s]&&t.push(this.createFilterPill(i.label,s))}),Object.entries(e.tristates||{}).forEach(([s,i])=>{let n=this.filters[s];if(n!=="any"){let o=this.formatTristatePillLabel(i,n);t.push(this.createFilterPill(o,s))}}),this.activeFiltersBar.innerHTML="",t.length>0){t.forEach(i=>this.activeFiltersBar.appendChild(i));let s=document.createElement("button");s.className="finder-active-clear",s.setAttribute("data-clear-filters",""),s.textContent="Clear all",s.addEventListener("click",()=>this.clearAllFilters()),this.activeFiltersBar.appendChild(s),this.activeFiltersBar.hidden=!1}else this.activeFiltersBar.hidden=!0}formatSetPillLabel(e,t){let s=e.label||"";return s.toLowerCase().includes("position")?`Motor: ${t}`:s.toLowerCase().includes("type")&&e.selector.includes("battery")?`Battery: ${t}`:s.toLowerCase().includes("type")&&e.selector.includes("brake")?`Brakes: ${t}`:s.toLowerCase().includes("tire")?`Tires: ${t}`:s.toLowerCase().includes("type")&&e.selector.includes("suspension")?`Suspension: ${t}`:t}formatRangePillLabel(e,t,s){let i=e.prefix||"",n=e.suffix||"";if(i==="$"||e.field==="current_price"){let o=this.currencySymbol;return`${o}${t.toLocaleString()} \u2013 ${o}${s.toLocaleString()}`}return`${t}\u2013${s}${n}`}formatContainsPillLabel(e,t){let s=e.label||"",i=e.suffix||"";if(s.toLowerCase().includes("height")&&i==='"'){let{feet:n,inches:o}=this.inchesToFeetInches(t);return`${n}'${o}" tall`}return`${s}: ${t}${i}`}formatTristatePillLabel(e,t){let s=e.label||"";return t==="yes"?s:s.toLowerCase().includes("removable")?"Fixed battery":s.toLowerCase().includes("regenerative")?"No regen braking":s.toLowerCase().includes("self-healing")?"No self-healing":s.toLowerCase().includes("adjustable")?"Fixed suspension":`No ${s.toLowerCase()}`}createFilterPill(e,t,s=null){let i=document.createElement("span");return i.className="active-filter-pill",i.innerHTML=`
            ${e}
            <button class="active-filter-pill-remove" aria-label="Remove filter">
                <svg class="icon"><use href="#icon-x"></use></svg>
            </button>
        `,i.querySelector("button").addEventListener("click",()=>{this.removeFilter(t,s)}),i}removeFilter(e,t=null){let s=this.filterConfig;if(e==="search"){this.searchTerm="";let i=this.container.querySelector("[data-product-search-input]"),n=this.container.querySelector("[data-product-search]");i&&(i.value=""),n?.classList.remove("has-value")}else if(s.sets?.[e]&&t){this.filters[e].delete(t);let i=s.sets[e],n=this.container.querySelector(`[data-filter="${i.selector}"][value="${t}"]`);n&&(n.checked=!1)}else if(s.ranges?.[e])s.ranges[e].filterMode==="contains"?this.filters[e]={value:null}:this.filters[e]={min:null,max:null},this.resetRangeInputs(e);else if(s.booleans?.[e]){this.filters[e]=!1;let i=s.booleans[e],n=this.container.querySelector(`[data-filter="${i.selector}"]`);n&&(n.checked=!1)}else s.tristates?.[e]&&(this.filters[e]="any",this.resetTristateUI(e));this.applyFilters()}resetRangeInputs(e){let t=this.container.querySelector(`[data-range-filter="${e}"]`);if(!t)return;let s=t.dataset.filterMode==="contains",i=parseFloat(t.dataset.min)||0,n=parseFloat(t.dataset.max)||100,o=parseFloat(t.dataset.step)||1,a=t.querySelector("[data-range-slider]"),c=t.querySelector("[data-height-input]"),d=a?.querySelector('[data-handle="value"]'),l=a?.querySelector(".filter-range-fill");this.deselectPresets(t),this.clearRangeFilter(t,e,s,i,n,o,a,c,d,l)}clearAllFilters(){let e=this.filterConfig;Object.entries(e.sets||{}).forEach(([i,n])=>{this.filters[i].clear(),this.container.querySelectorAll(`[data-filter="${n.selector}"]`).forEach(o=>{o.checked=!1})}),Object.keys(e.ranges||{}).forEach(i=>{e.ranges[i].filterMode==="contains"?this.filters[i]={value:null}:this.filters[i]={min:null,max:null},this.resetRangeInputs(i)}),Object.entries(e.booleans||{}).forEach(([i,n])=>{this.filters[i]=!1;let o=this.container.querySelector(`[data-filter="${n.selector}"]`);o&&(o.checked=!1)}),Object.keys(e.tristates||{}).forEach(i=>{this.filters[i]="any",this.resetTristateUI(i)}),this.searchTerm="";let t=this.container.querySelector("[data-product-search-input]"),s=this.container.querySelector("[data-product-search]");t&&(t.value=""),s?.classList.remove("has-value"),this.applyFilters()}resetTristateUI(e){let t=this.container.querySelector(`[data-tristate-filter="${e}"]`);if(!t)return;let s=t.querySelectorAll(".filter-tristate-btn"),i=t.querySelector("[data-tristate-input]");s.forEach(n=>{let o=n.dataset.value==="any";n.classList.toggle("is-active",o),n.setAttribute("aria-checked",o?"true":"false")}),i&&(i.value="any")}bindSortEvents(){this.sortSelect?.addEventListener("change",()=>{this.currentSort=this.sortSelect.value,this.sortFilteredProducts(),this.renderProducts()})}sortFilteredProducts(){let e=this.filterConfig.sort||{},t=e[this.currentSort]||e.popularity||{key:"popularity",dir:"desc",nullValue:0},s=t.nullValue;s==="Infinity"&&(s=1/0),this.filteredProducts.sort((i,n)=>{let o=i[t.key]??s,a=n[t.key]??s;return t.isString?t.dir==="asc"?(o||"").localeCompare(a||""):(a||"").localeCompare(o||""):t.dir==="asc"?o-a:a-o})}bindViewToggle(){let e=this.container.querySelectorAll(".view-toggle-btn[data-view]");e.forEach(t=>{t.addEventListener("click",()=>{let s=t.dataset.view;s!==this.currentView&&(e.forEach(i=>{i.classList.toggle("is-active",i===t),i.setAttribute("aria-pressed",i===t?"true":"false")}),this.handleViewChange(s))})})}handleViewChange(e){this.currentView=e,this.container.dataset.view=e,e==="table"?(this.grid.hidden=!0,this.grid.style.display="",this.loadMoreContainer?.setAttribute("hidden",""),this.emptyState&&(this.emptyState.hidden=!0),this.tableView||(this.tableView=new mr(this)),this.tableView.show()):(this.tableView&&(this.tableView.hide(),this.tableView.syncSelectionFromGrid()),this.grid.hidden=!1,this.syncSidebarToFilters(),this.renderProducts()),this.updateURL()}syncSidebarToFilters(){let e=this.filterConfig;for(let[t,s]of Object.entries(e.ranges||{})){let i=this.filters[t],n=this.container.querySelector(`[data-range-filter="${t}"]`);if(!n)continue;let o=parseFloat(n.dataset.min)||0,a=parseFloat(n.dataset.max)||100,c=i.min??o,d=i.max??a,l=i.value??null,h=n.querySelector("[data-range-min]"),u=n.querySelector("[data-range-max]"),p=n.querySelector("[data-range-value]");h&&(h.value=c),u&&(u.value=d),p&&(p.value=l??""),this.updateRangeSliderVisuals(n,c,d,o,a,l)}for(let[t,s]of Object.entries(e.sets||{})){let i=this.filters[t];this.container.querySelectorAll(`[data-filter="${t}"]`).forEach(o=>{o.checked=i.has(o.value)})}for(let[t,s]of Object.entries(e.tristates||{})){let i=this.filters[t]||"any",n=this.container.querySelector(`[data-tristate-filter="${t}"]`);if(!n)continue;let o=n.querySelectorAll(".filter-tristate-btn"),a=n.querySelector("[data-tristate-input]");o.forEach(c=>{let d=c.dataset.value===i;c.classList.toggle("is-active",d),c.setAttribute("aria-checked",d)}),a&&(a.value=i)}this.container.querySelectorAll("[data-preset]:checked").forEach(t=>{t.checked=!1})}updateRangeSliderVisuals(e,t,s,i,n,o=null){let a=n-i;if(a<=0)return;let c=e.querySelector(".filter-range-fill"),d=e.querySelector('[data-handle="min"]'),l=e.querySelector('[data-handle="max"]'),h=e.querySelector('[data-handle="value"]');if(c&&d&&l){let u=(t-i)/a,p=(s-i)/a;c.style.setProperty("--min",u),c.style.setProperty("--max",p),d.style.setProperty("--pos",u),l.style.setProperty("--pos",p)}else if(c&&h&&o!==null){let u=(o-i)/a;c.style.setProperty("--pos",u),h.style.setProperty("--pos",u)}this.updateDistributionHighlighting(e,t,s,i,n)}updateDistributionHighlighting(e,t,s,i,n){let o=e.querySelectorAll(".filter-range-bar");if(o.length===0)return;let a=n-i,c=o.length,d=a/c;o.forEach((l,h)=>{let u=i+h*d,f=u+d>t&&u<s;l.classList.toggle("is-selected",f)})}bindPriceAlertEvents(){this.grid.addEventListener("click",e=>{let t=e.target.closest("[data-track-price]");if(!t)return;e.preventDefault(),e.stopPropagation();let s=parseInt(t.dataset.trackPrice,10);this.openPriceAlert(s)})}openPriceAlert(e){let t=this.products.find(s=>s.id===e);if(!t){console.warn("[Finder] Product not found for price alert:",e);return}oe.open({productId:t.id,productName:t.name,productImage:t.thumbnail,currentPrice:t.price,currency:this.userCurrency})}bindComparisonEvents(){this.grid.addEventListener("change",e=>{let t=e.target.closest("[data-compare-select]");t&&this.comparisonBar.handleCheckboxChange(t)})}clearComparison(){this.comparisonBar.clear()}};qc=gr});function Ge(r,e){let{grid:t,leftArrow:s,rightArrow:i,scrollAmount:n=420,threshold:o=5}=e;if(!r||!t||!s||!i)return null;let a=null;function c(){let p=t.scrollLeft,f=t.scrollWidth-t.clientWidth,m=p>o,g=p<f-o;s.disabled=!m,i.disabled=!g,r.classList.toggle("can-scroll-left",m),r.classList.toggle("can-scroll-right",g)}function d(p){t.scrollTo({left:t.scrollLeft+p*n,behavior:"smooth"})}function l(){d(-1)}function h(){d(1)}function u(){clearTimeout(a),a=setTimeout(c,100)}return s.addEventListener("click",l),i.addEventListener("click",h),t.addEventListener("scroll",c,{passive:!0}),window.addEventListener("resize",u),c(),{update:c,destroy(){s.removeEventListener("click",l),i.removeEventListener("click",h),t.removeEventListener("scroll",c),window.removeEventListener("resize",u),clearTimeout(a)}}}var _t=P(()=>{});function Bt(r,e,t,s={}){let{placeholderImage:i="/wp-content/themes/erh-theme/assets/images/placeholder.svg"}=s,n=r.content.cloneNode(!0),o=n.querySelector(".deal-card"),a=n.querySelector("[data-track-price]"),c=n.querySelector(".deal-card-image img"),d=n.querySelector(".deal-card-title"),l=n.querySelector("[data-price]")||n.querySelector(".deal-card-price"),h=n.querySelector("[data-indicator]")||n.querySelector(".deal-card-indicator"),u=n.querySelector("[data-indicator-value]");if(o&&(o.href=e.url||"#",o.dataset.category=e.category||""),a&&(e.current_price?(a.dataset.trackPrice=e.id,a.dataset.productName=e.name||"",a.dataset.productImage=e.thumbnail||"",a.dataset.currentPrice=e.current_price,a.dataset.currency=e.currency||t.currency):a.style.display="none"),c&&(c.src=e.thumbnail||"",c.alt=e.name||"",c.onerror=()=>{c.src=i}),d&&(d.textContent=e.name||""),l&&(e.current_price>0?l.textContent=_(e.current_price,e.currency||t.currency):(l.textContent="",l.classList.add("deal-card-no-price"))),h&&u){let p=li(e.discount_percent);if(p){u.textContent=p.text;let f=h.querySelector("use");h.classList.remove("deal-card-indicator--above","deal-card-indicator--below"),h.classList.add(`deal-card-indicator--${p.type}`),f&&f.setAttribute("href",`#icon-${p.icon}`)}else h.style.display="none"}else h&&(h.style.display="none");return n}function yr(r,e){let t=r.target.closest("[data-track-price]");return t?(r.preventDefault(),r.stopPropagation(),oe.open({productId:parseInt(t.dataset.trackPrice,10),productName:t.dataset.productName||"",productImage:t.dataset.productImage||"",currentPrice:parseFloat(t.dataset.currentPrice)||0,currency:t.dataset.currency||e.currency}),!0):!1}async function Nt({category:r="all",limit:e=12,threshold:t=-5,geo:s="US"}){let i=`${te()}deals?category=${r}&limit=${e}&threshold=${t}&geo=${s}`,n=await fetch(i);if(!n.ok)throw new Error(`HTTP ${n.status}`);let o=await n.json();return{deals:o.deals||[],counts:o.counts||{}}}function on(r){let e={};return r.forEach(t=>{let s=t.category||"other";e[s]||(e[s]=[]),e[s].push(t)}),e}var os=P(()=>{ne();_e();At();xe()});var cn={};j(cn,{default:()=>Tc,initDeals:()=>an});async function an(){let r=document.getElementById("deals-section");if(!r)return null;let e=r.querySelector(".deals-grid"),t=r.querySelectorAll(".filter-pill"),s=r.querySelector(".deals-empty"),i=document.getElementById("deal-card-template"),n=document.getElementById("deal-cta-template"),o=r.querySelector(".carousel-arrow-left"),a=r.querySelector(".carousel-arrow-right"),c=r.querySelector(".deals-carousel"),d=document.getElementById("deals-count");if(!e||!i)return null;let l=[],h="all",u={geo:"US",currency:"USD"},p=0,f=null;try{u=await z()}catch{}try{let b=await Nt({category:"all",limit:Ot.dealsLimit,threshold:Ot.discountThreshold,geo:u.geo});l=b.deals,p=b.counts.all||0,d&&p>0&&(d.textContent=`\u{1F525} ${p} deals cooking`)}catch(b){return console.error("[Deals] Failed to load deals:",b),v(!0),null}if(m(l),t.forEach(b=>{b.addEventListener("click",()=>{let k=b.dataset.filter||"all";y(b),g(k)})}),e.addEventListener("click",b=>yr(b,u)),o&&a&&c){let b=(Ot.cardWidth+Ot.cardGap)*2;f=Ge(c,{grid:e,leftArrow:o,rightArrow:a,scrollAmount:b,threshold:1})}function m(b){if(e.innerHTML="",b.length===0){v(!0);return}if(w(),b.forEach(k=>{e.appendChild(Bt(i,k,u))}),n&&p>b.length){let k=n.content.cloneNode(!0),q=k.querySelector(".deal-card-cta-count");q&&(q.textContent=`+${p-b.length}`),e.appendChild(k)}f&&f.update()}function g(b){h=b;let k=e.querySelectorAll(".deal-card"),q=0;k.forEach(G=>{let ee=G.dataset.category;if(G.classList.contains("deal-card-cta"))return;let re=b==="all"||ee===b;G.classList.toggle("hidden",!re),re&&q++}),q===0?v():w(),e.scrollLeft=0,f&&f.update()}function y(b){t.forEach(k=>{let q=k===b;k.classList.toggle("active",q),k.setAttribute("aria-selected",q?"true":"false")})}function v(b=!1){b&&(e.innerHTML=""),s&&(s.style.display="")}function w(){s&&(s.style.display="none")}return{refresh:async()=>{try{l=(await Nt({category:"all",limit:Ot.dealsLimit,geo:u.geo})).deals,m(l),g(h)}catch(b){console.error("[Deals] Refresh failed:",b)}},filterDeals:g}}var Ot,Tc,ln=P(()=>{ne();_t();os();Ot={dealsLimit:12,discountThreshold:-5,cardWidth:160,cardGap:12};Tc={initDeals:an}});var dn={};j(dn,{initDealsTabs:()=>Pc});function Pc(r={}){let e={tabsSelector:".deals-tabs",gridSelector:".deals-grid",carouselSelector:".deals-carousel",cardSelector:".deal-card",pillSelector:".filter-pill",filterType:"category",filterAttribute:"category",...r},t=document.querySelector(e.tabsSelector),s=document.querySelector(e.gridSelector),i=document.querySelector(e.carouselSelector);if(!t||!s)return null;let n=t.querySelectorAll(e.pillSelector),o=s.querySelectorAll(e.cardSelector),a=i?.querySelector(".carousel-arrow-left"),c=i?.querySelector(".carousel-arrow-right");function d(g){o.forEach(y=>{let v=y.dataset[e.filterAttribute];if(v===void 0){y.classList.remove("hidden");return}g==="all"||v===g?y.classList.remove("hidden"):y.classList.add("hidden")})}function l(g){if(g==="all"){o.forEach(w=>w.classList.remove("hidden"));return}let[y,v]=g.split("-").map(w=>w==="inf"?1/0:parseInt(w,10));o.forEach(w=>{let b=w.dataset[e.filterAttribute];if(b===void 0){w.classList.remove("hidden");return}let k=parseInt(b,10);!isNaN(k)&&k>=y&&k<v?w.classList.remove("hidden"):w.classList.add("hidden")})}function h(g){e.filterType==="price"?l(g):d(g),i&&setTimeout(f,50)}function u(g){n.forEach(y=>{let v=y===g;y.classList.toggle("active",v),y.setAttribute("aria-selected",v?"true":"false")})}n.forEach(g=>{g.addEventListener("click",()=>{let y=g.dataset.filter||g.dataset.category||"all";u(g),h(y)})}),t.addEventListener("keydown",g=>{let y=document.activeElement;if(!y.classList.contains("filter-pill"))return;let v=Array.from(n),w=v.indexOf(y),b;switch(g.key){case"ArrowRight":b=(w+1)%v.length;break;case"ArrowLeft":b=(w-1+v.length)%v.length;break;case"Home":b=0;break;case"End":b=v.length-1;break;default:return}g.preventDefault(),v[b].focus(),v[b].click()});let p=200;function f(){if(!i||!a||!c)return;let g=s.scrollLeft,y=s.scrollWidth-s.clientWidth,v=g>0,w=g<y-1;a.disabled=!v,c.disabled=!w,i.classList.toggle("can-scroll-left",v),i.classList.toggle("can-scroll-right",w)}function m(g){let v=s.scrollLeft+g*p;s.scrollTo({left:v,behavior:"smooth"})}return a&&c&&i&&(a.addEventListener("click",()=>m(-1)),c.addEventListener("click",()=>m(1)),s.addEventListener("scroll",f),window.addEventListener("resize",f),f()),{filterCards:h,setActiveTab:u,updateScrollStates:f}}var un=P(()=>{});var pn={};j(pn,{default:()=>Ic,initDealsPage:()=>hn});async function hn(){let r=document.querySelector("[data-deals-page]");if(!r)return null;let e=r.dataset.category||"escooter",t=r.querySelector("[data-deals-grid]"),s=r.querySelector("[data-deals-empty]"),i=document.getElementById("deal-card-template"),n=document.getElementById("deals-info-card-template"),o=r.querySelector("[data-deals-period]"),a=r.querySelector("[data-deals-sort]"),c=r.querySelector("[data-deals-price-filter]"),d=r.querySelector("[data-deals-count]");if(!t||!i)return null;let l=[],h=o?.value||vr.defaultPeriod,u=a?.value||vr.defaultSort,p=c?.value||"all",f={geo:"US",currency:"USD"},m=!1,g=new pt({container:r,grid:t,getProductById:S=>l.find(x=>String(x.id)===String(S)),maxCompare:vr.maxCompare});try{f=await z(),v(f.currency)}catch{}await y(),o&&o.addEventListener("change",async S=>{h=S.target.value,await y()}),a&&a.addEventListener("change",S=>{u=S.target.value,b()}),c&&c.addEventListener("change",S=>{p=S.target.value,b()}),t.addEventListener("click",S=>{let x=S.target.closest("[data-track-price]");if(!x)return;S.preventDefault(),S.stopPropagation();let A=parseInt(x.dataset.trackPrice,10),U=l.find(Y=>Y.id===A);U&&oe.open({productId:A,productName:U.name,productImage:U.thumbnail||"",currentPrice:U.current_price||0,currency:U.currency||f.currency})}),t.addEventListener("change",S=>{let x=S.target.closest("[data-compare-select]");x&&g.handleCheckboxChange(x)}),Yt(r);async function y(){if(!m){m=!0,ee();try{let S=`${te()}deals?category=${e}&limit=50&threshold=${vr.discountThreshold}&geo=${f.geo}&period=${h}`,x=await fetch(S);if(!x.ok)throw new Error(`HTTP ${x.status}`);l=(await x.json()).deals||[],re(l.length),b()}catch(S){console.error("[DealsPage] Failed to load:",S),M()}finally{m=!1}}}function v(S){if(!c)return;let x=$e(S),A=c.options;for(let Y=0;Y<A.length;Y++){let I=A[Y];I.text=I.text.replace(/[$A-Z]{1,3}(?=\d)/g,x)}let U=c.closest(".custom-select");U&&(U.parentNode.insertBefore(c,U),U.remove(),new Et(c))}function w(S){return p==="all"?S:S.filter(x=>{let A=x.current_price||0;switch(p){case"0-500":return A<500;case"500-1000":return A>=500&&A<1e3;case"1000-1500":return A>=1e3&&A<1500;case"1500-2000":return A>=1500&&A<2e3;case"2000+":return A>=2e3;default:return!0}})}function b(){let x=[...w(l)].sort((A,U)=>{switch(u){case"discount":return U.discount_percent-A.discount_percent;case"price-asc":return A.current_price-U.current_price;case"price-desc":return U.current_price-A.current_price;case"name":return A.name.localeCompare(U.name);default:return 0}});re(x.length),k(x)}function k(S){if(t.innerHTML="",S.length===0){M();return}E();let x=4;window.innerWidth>1024?x=5:window.innerWidth<=850&&(x=6);let A=x+3;S.forEach((U,Y)=>{if(Y===x&&n&&S.length>=A){let O=n.content.cloneNode(!0);t.appendChild(O)}let I=q(U);t.appendChild(I)}),g.syncCheckboxes()}function q(S){let x=i.content.cloneNode(!0),A=x.querySelector(".product-card"),U=x.querySelector("[data-compare-select]"),Y=x.querySelector("[data-track-price]"),I=x.querySelector(".product-card-link"),O=x.querySelector(".product-card-image img"),K=x.querySelector("[data-price]"),ie=x.querySelector("[data-indicator]"),ge=x.querySelector("[data-indicator-value]"),pe=x.querySelector("[data-product-link]");A.dataset.productId=S.id,U&&(U.value=S.id,U.checked=g.isSelected(S.id)),Y&&(S.current_price?Y.dataset.trackPrice=S.id:Y.style.display="none"),I&&(I.href=S.url||"#"),pe&&(pe.href=S.url||"#",pe.textContent=S.name||""),O&&(O.src=S.thumbnail||"/wp-content/themes/erh-theme/assets/images/placeholder.svg",O.alt=S.name||"",O.onerror=()=>{O.src="/wp-content/themes/erh-theme/assets/images/placeholder.svg"}),K&&S.current_price>0&&(K.textContent=_(S.current_price,S.currency)),ie&&ge&&S.discount_percent>0?ge.textContent=`${Math.round(S.discount_percent)}%`:ie&&(ie.style.display="none");let ve=x.querySelector("[data-compare-label]"),Ke=x.querySelector("[data-compare-price]");if(ve&&Ke){let $={"3m":"3-mo avg","6m":"6-mo avg","12m":"12-mo avg"};ve.textContent=$[h]||"6-mo avg";let T=G(S,h);Ke.textContent=T>0?_(T,S.currency):"\u2014"}return x}function G(S,x){switch(x){case"3m":return S.avg_price_3m||S.avg_price;case"6m":return S.avg_price_6m||S.avg_price;case"12m":return S.avg_price_12m||S.avg_price;default:return S.avg_price}}function ee(){t.innerHTML="";for(let S=0;S<8;S++){let x=document.createElement("div");x.className="product-card product-card-skeleton",x.innerHTML=`
                <div class="product-card-image">
                    <div class="skeleton skeleton-img"></div>
                </div>
                <div class="product-card-content">
                    <div class="skeleton skeleton-text"></div>
                    <div class="skeleton skeleton-text-sm"></div>
                </div>
            `,t.appendChild(x)}}function re(S){d&&(d.innerHTML=`<strong>${S}</strong> deals available`)}function M(){s&&(s.hidden=!1)}function E(){s&&(s.hidden=!0)}return{refresh:y,comparisonBar:g}}var vr,Ic,fn=P(()=>{ne();_e();Fr();ns();xe();vr={discountThreshold:-5,defaultPeriod:"6m",defaultSort:"discount",maxCompare:4};Ic={initDealsPage:hn}});var gn={};j(gn,{default:()=>Dc,initDealsHub:()=>mn});async function mn(){let r=document.querySelector("[data-deals-hub]");if(!r)return null;let e=r.querySelector("[data-top-deals]"),t=r.querySelector("[data-top-deals-grid]"),s=document.getElementById("hub-deal-card-template");if(!s)return null;let i={geo:"US",currency:"USD"},n={};try{i=await z()}catch{}await o(),r.addEventListener("click",u=>yr(u,i));async function o(){try{let u=await Nt({category:"all",limit:Ne.dealsLimit,threshold:Ne.discountThreshold,geo:i.geo}),{deals:p,counts:f}=u;c(p.slice(0,Ne.topDealsLimit)),a(f);let m=on(p);Ne.categories.forEach(g=>{d(g,m[g]||[])})}catch(u){console.error("[DealsHub] Failed to load:",u),h()}}function a(u){Ne.categories.forEach(p=>{let f=r.querySelector(`[data-category-count="${p}"]`);f&&u[p]&&(f.textContent=u[p],f.hidden=!1)})}function c(u){if(!(!e||!t)){if(e.classList.remove("is-loading"),!u.length){e.hidden=!0;return}t.innerHTML="",u.forEach(p=>{t.appendChild(Bt(s,p,i))}),l("top",e,t)}}function d(u,p){let f=r.querySelector(`[data-category-section="${u}"]`),m=r.querySelector(`[data-category-grid="${u}"]`);if(!f||!m)return;if(f.classList.remove("is-loading"),!p.length){f.hidden=!0;return}m.innerHTML="",p.slice(0,Ne.categoryDisplayLimit).forEach(y=>{m.appendChild(Bt(s,y,i))}),l(u,f,m)}function l(u,p,f){n[u]&&n[u].destroy();let m=p.querySelector(".deals-carousel"),g=m?.querySelector(".carousel-arrow-left"),y=m?.querySelector(".carousel-arrow-right");!m||!g||!y||(n[u]=Ge(m,{grid:f,leftArrow:g,rightArrow:y,scrollAmount:(Ne.cardWidth+Ne.cardGap)*2,threshold:1}))}function h(){e&&(e.classList.remove("is-loading"),e.hidden=!0),Ne.categories.forEach(u=>{let p=r.querySelector(`[data-category-section="${u}"]`);p&&(p.classList.remove("is-loading"),p.hidden=!0)})}return{refresh:o}}var Ne,Dc,yn=P(()=>{ne();_t();os();Ne={dealsLimit:50,topDealsLimit:8,categoryDisplayLimit:15,discountThreshold:-5,cardWidth:160,cardGap:12,categories:["escooter","ebike","eskate","euc","hoverboard"]};Dc={initDealsHub:mn}});var et={};j(et,{initComparison:()=>Mc});async function Mc(r={}){let e={containerId:"comparison-container",containerSelector:null,inputsContainerId:null,inputsContainerSelector:null,rightColumnId:"comparison-right-column",submitBtnId:"comparison-submit",submitBtnSelector:null,categoryPillId:"comparison-category-pill",categoryTextId:"comparison-category-text",categoryClearId:"comparison-category-clear",announcerId:"comparison-announcer",announcerSelector:null,categoryFilter:null,allowedCategories:null,wrapperClass:"comparison-input-wrapper",showCategoryInResults:!0,lockedProduct:null,allowDynamicInputs:!0,...r},t=e.containerSelector?document.querySelector(e.containerSelector):e.containerId?document.getElementById(e.containerId):null,s=e.inputsContainerSelector?document.querySelector(e.inputsContainerSelector):e.inputsContainerId?document.getElementById(e.inputsContainerId):document.getElementById(e.rightColumnId),i=document.getElementById(e.rightColumnId),n=e.submitBtnSelector?t?t.querySelector(e.submitBtnSelector):document.querySelector(e.submitBtnSelector):document.getElementById(e.submitBtnId),o=document.getElementById(e.categoryPillId),a=document.getElementById(e.categoryTextId),c=document.getElementById(e.categoryClearId),d=e.announcerSelector?t?t.querySelector(e.announcerSelector):document.querySelector(e.announcerSelector):document.getElementById(e.announcerId),l=e.inputsContainerId?s:i||t;if(!t)return null;let{geo:h,currency:u}=await z(),p=[],f=new Map,m=2,g=e.categoryFilter,y=e.allowedCategories;!y&&t?.dataset.allowedCategories&&(y=t.dataset.allowedCategories.split(",").map(L=>L.trim()).filter(Boolean));let v=-1,w=[],b=null,k=null,q=e.lockedProduct;!q&&t?.dataset.lockedId&&(q={id:t.dataset.lockedId,name:t.dataset.lockedName||"",image:t.dataset.lockedImage||"",category:t.dataset.lockedCategory||e.categoryFilter}),q&&(f.set(0,{id:q.id,name:q.name,image:q.image,category:q.category,categoryLabel:q.categoryLabel||q.category}),q.category&&!e.categoryFilter&&(g=q.category));let G={escooter:"E-Scooters",ebike:"E-Bikes",eskateboard:"E-Skateboards",euc:"Electric Unicycles",hoverboard:"Hoverboards"};try{let L=t.dataset.jsonUrl||"/wp-content/uploads/comparison_products.json",C=await fetch(L);if(!C.ok)throw new Error(`HTTP ${C.status}`);let D=await C.json();p=(Array.isArray(D)?D:D.products||[]).map(B=>{let ue=(B.prices||{})[h]??null;return{id:String(B.id),name:B.name,category:B.category,categoryLabel:G[B.category]||B.categoryLabel||B.category,image:B.thumbnail||B.image,price:ue,currency:u,url:B.url,popularity:B.popularity||0}}),p.sort((B,V)=>V.popularity-B.popularity),e.categoryFilter&&(p=p.filter(B=>B.category===e.categoryFilter))}catch(L){return console.error("Failed to load products:",L),ae("Unable to load products. Please refresh the page."),null}t.querySelectorAll(".comparison-input-wrapper").forEach(ee),T(),c&&c.addEventListener("click",K);function ee(L){let C=L.querySelector(".comparison-input"),D=L.querySelector(".comparison-input-clear"),R=L.querySelector(".comparison-results"),B=L.querySelector(".comparison-input-thumb"),V=parseInt(C?.dataset.slot,10);if(!C||isNaN(V))return;V>=m&&(m=V+1);let ue=`${e.containerId}-listbox-${V}`;R.id=ue,R.setAttribute("role","listbox"),C.setAttribute("role","combobox"),C.setAttribute("aria-autocomplete","list"),C.setAttribute("aria-expanded","false"),C.setAttribute("aria-controls",ue),C.setAttribute("aria-haspopup","listbox");let be=null,ce="";L._comparisonData={input:C,clearBtn:D,dropdown:R,thumb:B,slot:V},C.addEventListener("focus",()=>{ce=C.value,k=C,b=R,C.value&&f.has(V)&&C.select(),U(E(C.value),R,C,V,B)}),C.addEventListener("input",()=>{clearTimeout(be),be=setTimeout(()=>{let Le=C.value.trim().toLowerCase();U(E(Le),R,C,V,B)},100)}),C.addEventListener("keydown",Le=>{re(Le,R,C,V,B,ce)}),D&&D.addEventListener("click",Le=>{Le.stopPropagation(),O(V,L),C.focus()}),B&&B.addEventListener("error",()=>{B.classList.add("error"),B.src='data:image/svg+xml,%3Csvg xmlns="http://www.w3.org/2000/svg" width="28" height="28"%3E%3Crect fill="%23f0f0f0" width="28" height="28"/%3E%3C/svg%3E'}),document.addEventListener("click",Le=>{L.contains(Le.target)||Y(R,C)}),C.addEventListener("blur",()=>{setTimeout(()=>{document.activeElement!==C&&ve()},200)})}function re(L,C,D,R,B,V){let ue=C.classList.contains("active");switch(L.key){case"ArrowDown":L.preventDefault(),ue?(v=Math.min(v+1,w.length-1),M(C)):U(E(D.value),C,D,R,B);break;case"ArrowUp":L.preventDefault(),ue&&(v=Math.max(v-1,0),M(C));break;case"Enter":if(L.preventDefault(),ue&&v>=0&&w[v]){let be=w[v];S(be.id)||(I(be,D,R,B),Y(C,D))}break;case"Escape":L.preventDefault(),ue&&(f.has(R)?D.value=f.get(R).name:D.value="",Y(C,D));break;case"Tab":Y(C,D);break}}function M(L){L.querySelectorAll(".comparison-result:not(.already-selected)").forEach((D,R)=>{D.classList.toggle("highlighted",R===v),R===v&&(D.scrollIntoView({block:"nearest"}),k?.setAttribute("aria-activedescendant",D.id))})}function E(L=""){return L=L.toLowerCase().trim(),p.filter(C=>{if(g&&C.category!==g||!g&&y&&y.length>0&&!y.includes(C.category))return!1;if(L.length>0){let D=C.name.toLowerCase().includes(L),R=C.categoryLabel.toLowerCase().includes(L);if(!D&&!R)return!1}return!0})}function S(L){if(q&&q.id===L)return!0;for(let C of f.values())if(C.id===L)return!0;return!1}function x(L,C){if(!C||C.length<1)return F(L);let D=new RegExp(`(${A(C)})`,"gi");return F(L).replace(D,"<mark>$1</mark>")}function A(L){return L.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function U(L,C,D,R,B){if(!C)return;w=L,v=-1;let V=D.value.trim().toLowerCase();if(L.length===0){let ue=g&&!e.categoryFilter?`Try searching within ${pe(g)} or clear the filter.`:"Try a different search term.";C.innerHTML=`
                <div class="comparison-no-results">
                    <p class="comparison-no-results-text">No products found</p>
                    <p class="comparison-no-results-hint">${ue}</p>
                </div>
            `}else{let ue=L.findIndex(ce=>!S(ce.id));v=ue>=0?ue:-1;let be=g&&!e.categoryFilter?`<div class="comparison-results-header">${pe(g)}</div>`:"";C.innerHTML=be+L.slice(0,10).map((ce,Le)=>{let it=S(ce.id),jt=Le===v;return`
                    <div class="comparison-result ${it?"already-selected":""} ${jt?"highlighted":""}"
                         data-product-id="${ce.id}"
                         data-index="${Le}"
                         id="${e.containerId}-option-${R}-${Le}"
                         role="option"
                         aria-selected="${jt}"
                         ${it?'aria-disabled="true"':""}>
                        <img class="comparison-result-thumb"
                             src="${ce.image}"
                             alt=""
                             onerror="this.classList.add('error'); this.src='data:image/svg+xml,%3Csvg xmlns=%22http://www.w3.org/2000/svg%22 width=%2240%22 height=%2240%22%3E%3Crect fill=%22%23f0f0f0%22 width=%2240%22 height=%2240%22/%3E%3C/svg%3E'">
                        <div class="comparison-result-info">
                            <span class="comparison-result-name">${x(ce.name,V)}</span>
                            <div class="comparison-result-meta">
                                ${it?'<span class="comparison-result-selected">Already selected</span>':`${e.showCategoryInResults?`<span class="comparison-result-category">${ce.categoryLabel}</span>`:""}
                                       ${ce.price>0?`<span class="comparison-result-price">${_(ce.price,ce.currency)}</span>`:""}`}
                            </div>
                        </div>
                    </div>
                `}).join(""),C.querySelectorAll(".comparison-result:not(.already-selected)").forEach(ce=>{ce.addEventListener("click",()=>{let Le=ce.dataset.productId,it=p.find(jt=>jt.id===Le);it&&(I(it,D,R,B),Y(C,D))}),ce.addEventListener("mouseenter",()=>{v=parseInt(ce.dataset.index,10),M(C)})})}C.classList.add("active"),D.setAttribute("aria-expanded","true")}function Y(L,C){L&&(L.classList.remove("active"),C?.setAttribute("aria-expanded","false"),C?.removeAttribute("aria-activedescendant")),v=-1,w=[],b=null}function I(L,C,D,R){if(f.set(D,{id:L.id,name:L.name,image:L.image,category:L.category,categoryLabel:L.categoryLabel}),C.value=L.name,C.classList.add("has-value"),C.classList.add("just-selected"),setTimeout(()=>C.classList.remove("just-selected"),400),R&&(R.src=L.image,R.alt=L.name,R.classList.remove("error")),!g&&!e.categoryFilter&&ie(L.category,L.categoryLabel),N(`Selected ${L.name}`),T(),e.allowDynamicInputs){let B=l.querySelectorAll(".comparison-input"),V=B[B.length-1];V&&parseInt(V.dataset.slot,10)===D&&$()}}function O(L,C){let R=f.get(L)?.name||"selection";f.delete(L);let B=C.querySelector(".comparison-input"),V=C.querySelector(".comparison-input-thumb");B&&(B.value="",B.classList.remove("has-value")),V&&(V.src="",V.alt="",V.classList.remove("error")),f.size===0&&!e.categoryFilter&&ge(),N(`Removed ${R}`),T(),setTimeout(ve,100)}function K(){f.forEach((L,C)=>{let D=t.querySelector(`[data-slot="${C}"]`)?.closest(".comparison-input-wrapper");if(D){let R=D.querySelector(".comparison-input"),B=D.querySelector(".comparison-input-thumb");R&&(R.value="",R.classList.remove("has-value")),B&&(B.src="",B.alt="")}}),f.clear(),e.categoryFilter||ge(),N("All selections cleared"),T(),setTimeout(()=>{ve(!0)},100)}function ie(L,C){g=L,a&&(a.textContent=`Showing ${C}`),o&&o.classList.add("visible")}function ge(){g=null,o&&o.classList.remove("visible")}function pe(L){return p.find(D=>D.category===L)?.categoryLabel||L}function ve(L=!1){if(!e.allowDynamicInputs)return;let C=l.querySelectorAll(".comparison-input-wrapper"),D=[];C.forEach(V=>{let ue=V.querySelector(".comparison-input"),be=parseInt(ue?.dataset.slot,10);be>=2&&!f.has(be)&&D.push(V)});let R=f.has(1),B=L||!R?D:D.slice(0,-1);B.forEach(V=>{V.classList.add("removing"),setTimeout(()=>V.remove(),150)}),B.length>0&&i&&!e.inputsContainerId&&setTimeout(Ke,200)}function Ke(){if(!i)return;let L=i.querySelectorAll(".comparison-input"),C=new Map;f.has(0)&&C.set(0,f.get(0)),L.forEach((D,R)=>{let B=parseInt(D.dataset.slot,10),V=R+1;D.dataset.slot=V;let be=D.closest(".comparison-input-wrapper")?.querySelector(".comparison-results");be&&(be.id=`${e.containerId}-listbox-${V}`,D.setAttribute("aria-controls",be.id)),f.has(B)&&C.set(V,f.get(B))}),f.clear(),C.forEach((D,R)=>f.set(R,D)),m=L.length+1}function $(){let L=document.createElement("div");L.className=e.wrapperClass,L.innerHTML=`
            <input type="text"
                   class="comparison-input"
                   placeholder="Add another..."
                   autocomplete="off"
                   data-slot="${m}">
            <button type="button" class="comparison-input-clear" aria-label="Clear selection">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <line x1="18" y1="6" x2="6" y2="18"></line>
                    <line x1="6" y1="6" x2="18" y2="18"></line>
                </svg>
            </button>
            <img class="comparison-input-thumb" src="" alt="" aria-hidden="true">
            <div class="comparison-results"></div>
        `,l.appendChild(L),ee(L),m++}function T(){n&&(n.disabled=f.size<2)}function N(L){d&&(d.textContent=L,setTimeout(()=>{d.textContent=""},1e3))}function ae(L){console.error(L)}return n&&n.addEventListener("click",()=>{if(f.size>=2){let L=Array.from(f.values()).map(R=>R.id),D=`${window.erhData?.siteUrl||""}/compare/?products=${L.join(",")}`;window.location.href=D}}),{getSelectedProducts:()=>Array.from(f.values()),clearAll:K}}var tt=P(()=>{ne();fe()});var Fc,ft,as=P(()=>{fe();Fc={size:320,levels:5,maxValue:100,labelOffset:24,animationDuration:800,animationEasing:"cubic-bezier(0.34, 1.56, 0.64, 1)",colors:["var(--color-primary)","var(--color-success)","var(--color-info)","var(--color-warning)","#e91e63","#00bcd4"],fillOpacity:.15,strokeWidth:2,dotRadius:4},ft=class{constructor(e,t={}){this.container=e,this.options={...Fc,...t},this.data=[],this.categories=[],this.tooltip=null,this.legendItems=new Map,this.hoveredProduct=null,this.hiddenProducts=new Set,this.init()}init(){this.container.classList.add("radar-chart"),this.container.innerHTML=`
            <div class="radar-chart-wrapper">
                <svg class="radar-chart-svg" aria-hidden="true"></svg>
            </div>
            <div class="radar-chart-legend"></div>
            <div class="radar-chart-tooltip" aria-hidden="true"></div>
        `,this.svg=this.container.querySelector(".radar-chart-svg"),this.legend=this.container.querySelector(".radar-chart-legend"),this.tooltip=this.container.querySelector(".radar-chart-tooltip"),this.setupResizeObserver()}setData(e,t){this.data=e,this.categories=t,this.render()}render(){if(!this.categories.length||!this.data.length)return;let{size:e,levels:t,labelOffset:s}=this.options,i=e/2,n=e/2-s-10,o=Math.PI*2/this.categories.length;this.svg.setAttribute("viewBox",`0 0 ${e} ${e}`),this.svg.innerHTML="";let a=this.createGroup("radar-grid"),c=this.createGroup("radar-axes"),d=this.createGroup("radar-labels"),l=this.createGroup("radar-data");for(let h=1;h<=t;h++){let u=n/t*h,p=document.createElementNS("http://www.w3.org/2000/svg","circle");p.setAttribute("cx",i),p.setAttribute("cy",i),p.setAttribute("r",u),p.classList.add("radar-level"),h===t&&p.classList.add("radar-level--outer"),a.appendChild(p)}this.categories.forEach((h,u)=>{let p=o*u-Math.PI/2,f=i+Math.cos(p)*n,m=i+Math.sin(p)*n,g=document.createElementNS("http://www.w3.org/2000/svg","line");g.setAttribute("x1",i),g.setAttribute("y1",i),g.setAttribute("x2",f),g.setAttribute("y2",m),g.classList.add("radar-axis"),c.appendChild(g);let y=i+Math.cos(p)*(n+s),v=i+Math.sin(p)*(n+s),w=document.createElementNS("http://www.w3.org/2000/svg","text");w.setAttribute("x",y),w.setAttribute("y",v),w.setAttribute("text-anchor",this.getTextAnchor(p)),w.setAttribute("dominant-baseline","middle"),w.classList.add("radar-label"),w.textContent=h.name,w.dataset.category=h.name,w.addEventListener("mouseenter",b=>this.showCategoryTooltip(b,h,u)),w.addEventListener("mouseleave",()=>this.hideTooltip()),d.appendChild(w)}),this.data.forEach((h,u)=>{let p=this.options.colors[u%this.options.colors.length],f=this.calculatePoints(h,i,n,o),m=this.createGroup(`radar-product radar-product-${u}`);m.dataset.productId=h.id;let g=document.createElementNS("http://www.w3.org/2000/svg","polygon");g.setAttribute("points",f.map(v=>`${v.x},${v.y}`).join(" ")),g.classList.add("radar-polygon"),g.style.setProperty("--radar-color",p),g.style.setProperty("--radar-fill-opacity",this.options.fillOpacity),m.appendChild(g);let y=document.createElementNS("http://www.w3.org/2000/svg","polygon");y.setAttribute("points",f.map(v=>`${v.x},${v.y}`).join(" ")),y.classList.add("radar-stroke"),y.style.setProperty("--radar-color",p),y.style.setProperty("--stroke-width",this.options.strokeWidth),m.appendChild(y),f.forEach((v,w)=>{let b=document.createElementNS("http://www.w3.org/2000/svg","circle");b.setAttribute("cx",v.x),b.setAttribute("cy",v.y),b.setAttribute("r",this.options.dotRadius),b.classList.add("radar-dot"),b.style.setProperty("--radar-color",p),b.dataset.value=v.value,b.dataset.category=this.categories[w].name,b.dataset.product=h.name,b.addEventListener("mouseenter",k=>this.showDotTooltip(k,v,this.categories[w],h)),b.addEventListener("mouseleave",()=>this.hideTooltip()),m.appendChild(b)}),m.addEventListener("mouseenter",()=>this.highlightProduct(u)),m.addEventListener("mouseleave",()=>this.unhighlightProduct()),l.appendChild(m)}),this.svg.appendChild(a),this.svg.appendChild(c),this.svg.appendChild(l),this.svg.appendChild(d),this.renderLegend(),requestAnimationFrame(()=>this.animate())}calculatePoints(e,t,s,i){return this.categories.map((n,o)=>{let a=e.scores?.[n.key]??0,c=Math.min(a/this.options.maxValue,1),d=i*o-Math.PI/2;return{x:t+Math.cos(d)*s*c,y:t+Math.sin(d)*s*c,value:Math.round(a),rawValue:a}})}getTextAnchor(e){let t=(e*180/Math.PI+360)%360;return t>45&&t<135?"middle":t>=135&&t<=225?"end":t>225&&t<315?"middle":"start"}createGroup(e){let t=document.createElementNS("http://www.w3.org/2000/svg","g");return t.setAttribute("class",e),t}renderLegend(){let e=this.data.length>1;this.legend.innerHTML=this.data.map((t,s)=>{let i=this.options.colors[s%this.options.colors.length];return`
                <button class="radar-legend-item${this.hiddenProducts.has(s)?" is-hidden":""}" data-product-index="${s}" type="button"${e?' title="Click to toggle visibility"':""}>
                    <span class="radar-legend-color" style="--radar-color: ${i}"></span>
                    <span class="radar-legend-name">${F(t.name)}</span>
                </button>
            `}).join(""),this.legend.querySelectorAll(".radar-legend-item").forEach(t=>{let s=parseInt(t.dataset.productIndex,10);t.addEventListener("mouseenter",()=>{this.hiddenProducts.has(s)||this.highlightProduct(s)}),t.addEventListener("mouseleave",()=>this.unhighlightProduct()),e&&t.addEventListener("click",i=>{i.preventDefault(),this.toggleProduct(s)})})}toggleProduct(e){let t=this.data.length-this.hiddenProducts.size,s=this.hiddenProducts.has(e);if(!s&&t<=1)return;s?this.hiddenProducts.delete(e):this.hiddenProducts.add(e);let i=this.legend.querySelector(`[data-product-index="${e}"]`);i&&i.classList.toggle("is-hidden",!s);let n=this.svg.querySelector(`.radar-product-${e}`);n&&n.classList.toggle("is-hidden",!s),this.unhighlightProduct()}animate(){this.container.classList.add("is-animated"),this.svg.querySelectorAll(".radar-polygon, .radar-stroke").forEach((s,i)=>{s.style.animationDelay=`${i*100}ms`}),this.svg.querySelectorAll(".radar-dot").forEach((s,i)=>{s.style.animationDelay=`${200+i*30}ms`})}highlightProduct(e){this.hoveredProduct=e,this.container.classList.add("has-hover"),this.svg.querySelectorAll(".radar-product").forEach((t,s)=>{t.classList.toggle("is-active",s===e),t.classList.toggle("is-dimmed",s!==e)}),this.legend.querySelectorAll(".radar-legend-item").forEach((t,s)=>{t.classList.toggle("is-active",s===e)})}unhighlightProduct(){this.hoveredProduct=null,this.container.classList.remove("has-hover"),this.svg.querySelectorAll(".radar-product").forEach(e=>{e.classList.remove("is-active","is-dimmed")}),this.legend.querySelectorAll(".radar-legend-item").forEach(e=>{e.classList.remove("is-active")})}showDotTooltip(e,t,s,i){let n=this.options.colors[this.data.indexOf(i)%this.options.colors.length];this.tooltip.innerHTML=`
            <div class="radar-tooltip-header">
                <span class="radar-tooltip-dot" style="--radar-color: ${n}"></span>
                <span class="radar-tooltip-product">${F(i.name)}</span>
            </div>
            <div class="radar-tooltip-category">${s.name}</div>
            <div class="radar-tooltip-value">${t.value}<span>pts</span></div>
        `,this.positionTooltip(e)}showCategoryTooltip(e,t,s){let i=this.data.map((n,o)=>{let a=this.options.colors[o%this.options.colors.length],c=n.scores?.[t.key]??0;return`
                <div class="radar-tooltip-row">
                    <span class="radar-tooltip-dot" style="--radar-color: ${a}"></span>
                    <span class="radar-tooltip-name">${F(n.name)}</span>
                    <span class="radar-tooltip-score">${Math.round(c)}</span>
                </div>
            `}).join("");this.tooltip.innerHTML=`
            <div class="radar-tooltip-title">${t.name}</div>
            ${i}
        `,this.positionTooltip(e)}positionTooltip(e){let t=this.container.getBoundingClientRect(),s=e.clientX-t.left,i=e.clientY-t.top;this.tooltip.style.left=`${s}px`,this.tooltip.style.top=`${i-10}px`,this.tooltip.classList.add("is-visible")}hideTooltip(){this.tooltip.classList.remove("is-visible")}setupResizeObserver(){"ResizeObserver"in window&&new ResizeObserver(t=>{for(let s of t)s.contentRect.width<300?this.container.classList.add("is-compact"):this.container.classList.remove("is-compact")}).observe(this.container)}destroy(){this.container.innerHTML="",this.container.classList.remove("radar-chart","is-animated","has-hover","is-compact"),this.hiddenProducts.clear()}}});function vn(r){if(!r)return 0;let e=String(r).toUpperCase().match(/^IP([X0-9])([0-9])$/);if(!e)return 0;let t=e[1],s=parseInt(e[2],10),i=t!=="X";return s*10+(i?1:0)}function xn(r,e){if(r==null||r==="")return"\u2014";if(Array.isArray(r)){if(r.length===0)return"\u2014";if(e.format==="suspensionArray"){let t=r.filter(s=>s&&s!=="None");return t.length===0?"None":t.join(", ")}return e.format==="featureArray"?r.length<=3?r.join(", "):`${r.slice(0,3).join(", ")} +${r.length-3} more`:(e.format==="array",r.join(", "))}if(typeof r=="object"&&r!==null){if(r.front!==void 0||r.rear!==void 0){let s=r.front||"None",i=r.rear||"None";return s===i?s:s==="None"?`Rear: ${i}`:i==="None"?`Front: ${s}`:`F: ${s}, R: ${i}`}if(r.type){if(Array.isArray(r.type)){let s=r.type.filter(i=>i&&i!=="None");return s.length===0?"None":s.join(", ")}return String(r.type)}if(r.value)return String(r.value);let t=Object.values(r).filter(s=>s&&s!=="None");return t.length?t.join(", "):"\u2014"}if(e.format==="boolean")return r===!0||r==="Yes"||r==="yes"||r===1?"Yes":r===!1||r==="No"||r==="no"||r===0?"No":String(r);if(e.format==="ip"){let t=String(r);return/^ip/i.test(t)?t.toUpperCase():t}if(e.format==="suspension")return String(r);if(e.format==="currency"){let t=parseFloat(r);if(!isNaN(t)){let s=e.currencySymbol||"$",i=e.valueUnit||"";return s+t.toFixed(2)+i}return"\u2014"}if(e.format==="decimal"){let t=parseFloat(r);if(!isNaN(t)){let s=e.valueUnit?" "+e.valueUnit:"";return t.toFixed(2)+s}return"\u2014"}if(e.unit){let t=parseFloat(r);if(!isNaN(t))return`${Number.isInteger(t)?t.toLocaleString("en-US"):t.toLocaleString("en-US",{minimumFractionDigits:1,maximumFractionDigits:1})} ${e.unit}`}return String(r)}function Ln(r){if(!r||!Array.isArray(r)||r.length===0)return 0;let e=r.map(c=>String(c).toLowerCase());if(e.every(c=>c==="none"||c===""))return 0;let t=c=>c.includes("hydraulic")?3:c.includes("spring")||c.includes("fork")?2:c.includes("rubber")?1:0,s=e.find(c=>c.includes("dual"));if(s)return 7+t(s);let i=e.find(c=>c.includes("front")),n=e.find(c=>c.includes("rear")),o=i&&!i.includes("none"),a=n&&!n.includes("none");if(o&&a){let c=t(i),d=t(n);return 7+(c+d)/2}else if(o||a)return 2+t(o?i:n);return 0}function br(r,e,t){if(r==null||r==="")return 1;if(e==null||e==="")return-1;if(t.format==="boolean"){let o=r===!0||r==="Yes"||r==="yes"||r===1;return o===(e===!0||e==="Yes"||e==="yes"||e===1)?0:t.higherBetter!==!1?o?-1:1:o?1:-1}if(t.format==="ip"){let o=vn(r),a=vn(e);return o===a?0:o===0?1:a===0||o>a?-1:1}if(t.format==="suspension"){let o=bn.findIndex(c=>String(r).toLowerCase().includes(c.toLowerCase())),a=bn.findIndex(c=>String(e).toLowerCase().includes(c.toLowerCase()));return o===a?0:o===-1?1:a===-1||o>a?-1:1}if(t.format==="suspensionArray"){let o=Ln(r),a=Ln(e);return o===a?0:o>a?-1:1}if(t.format==="brakeType"){let o=Sn.findIndex(c=>String(r).toLowerCase().includes(c.toLowerCase())),a=Sn.findIndex(c=>String(e).toLowerCase().includes(c.toLowerCase()));return o===a?0:o===-1?1:a===-1||o>a?-1:1}if(t.format==="displayType"){let o=En.findIndex(c=>String(r).toLowerCase()===c.toLowerCase()),a=En.findIndex(c=>String(e).toLowerCase()===c.toLowerCase());return o===a?0:o===-1?1:a===-1||o>a?-1:1}if(t.format==="tire"){let o=wn.findIndex(c=>String(r).toLowerCase().includes(c.toLowerCase())),a=wn.findIndex(c=>String(e).toLowerCase().includes(c.toLowerCase()));return o===a?0:o===-1?1:a===-1||o>a?-1:1}if(t.format==="featureArray"||t.format==="array"){let o=Array.isArray(r)?r.length:0,a=Array.isArray(e)?e.length:0;return o===a?0:o>a?-1:1}let s=parseFloat(r),i=parseFloat(e);return isNaN(s)&&isNaN(i)?0:isNaN(s)?1:isNaN(i)?-1:Math.abs((s-i)/Math.max(s,i))*100<=_c?0:t.higherBetter===!1?s<i?-1:1:s>i?-1:1}var bn,wn,Sn,En,_c,wr=P(()=>{bn=["None","Front only","Rear only","Dual spring","Dual hydraulic","Full suspension"],wn=["Solid","Honeycomb","Semi-pneumatic","Pneumatic","Tubeless pneumatic"],Sn=["None","Foot","Drum","Disc (Mechanical)","Disc (Hydraulic)"],En=["None","Unknown","LED","LCD","OLED","TFT"],_c=3});var X,Bc,Nc,cs,kn,Cn,$n,An,ls=P(()=>{X={page:"[data-compare-page]",header:"[data-compare-header]",products:"[data-compare-products]",nav:"[data-compare-nav]",navLinks:"[data-nav-links]",navLink:"[data-nav-link]",section:"[data-section]",overview:"[data-compare-overview]",specs:"[data-compare-specs]",addModal:"#compare-add-modal",searchInput:"[data-compare-search]",searchResults:"[data-compare-results]",addBtn:"[data-compare-add]",inputs:"[data-compare-inputs]"},Bc=72,Nc=48,cs=Bc+Nc+24,kn=1200,Cn=48,$n=200,An=200});function rt(r,e){let t=r.specs||r;return e.split(".").reduce((s,i)=>s?.[i],t)??null}function Ut(r,e){if(e.noWinner)return[];let t=r.map((n,o)=>({v:n,i:o})).filter(n=>n.v!=null&&n.v!=="");if(t.length<2)return[];let s=t[0];for(let n of t.slice(1))br(n.v,s.v,e)<0&&(s=n);let i=t.filter(n=>br(n.v,s.v,e)===0).map(n=>n.i);return i.length===t.length?[]:i}function ds(r,e){let t=window.erhData?.siteUrl||"";if(r.length<=4){let s=r.map(i=>{let n=e.find(a=>a.id===i);return n?.slug?n.slug:n?.url?.match(/\/([^/]+)\/?$/)?.[1]||null}).filter(Boolean);if(s.length===r.length)return`${t}/compare/${s.join("-vs-")}/`}return`${t}/compare/?products=${r.join(",")}`}function us(){document.querySelector(X.addModal)?.querySelector("[data-modal-close]")?.click()}function qn(r){let e=document.querySelector(X.overview);e&&(e.innerHTML=`<div class="compare-error"><p>${r}</p></div>`)}function Tn(r,e){let t=0;return function(...s){let i=Date.now();i-t>=e&&(t=i,r.apply(this,s))}}async function hs(r){if(!r||r.length<2)return;let e=Oc(r);if(!e.length)return;let t=e.filter(s=>!Uc(s));if(t.length)try{let s=te(),i=window.erhData?.nonce||"";await fetch(`${s}compare/track`,{method:"POST",headers:{"Content-Type":"application/json","X-WP-Nonce":i},body:JSON.stringify({product_ids:r})}),t.forEach(n=>Rc(n))}catch(s){console.debug("Comparison tracking failed:",s)}}function Oc(r){let e=[];for(let t=0;t<r.length;t++)for(let s=t+1;s<r.length;s++){let i=Math.min(r[t],r[s]),n=Math.max(r[t],r[s]);e.push(`${i}-${n}`)}return e}function Uc(r){try{return sessionStorage.getItem(`erh_compared_${r}`)==="1"}catch{return!1}}function Rc(r){try{sessionStorage.setItem(`erh_compared_${r}`,"1")}catch{}}var Pn=P(()=>{wr();ls();xe()});function ke(r){if(!r)return"";let e=document.createElement("div");return e.textContent=r,e.innerHTML}function Ce(r,e=16,t=16){return`<svg class="icon" width="${e}" height="${t}" aria-hidden="true"><use href="#icon-${r}"></use></svg>`}function In(r,e="md",t=""){if(r==null||r==="")return"";let s=15,i=36,n=18,o=2*Math.PI*s,a=Math.min(100,Math.max(0,parseFloat(r))),c=o-a/100*o,d=Math.round(r),l=e==="sm"?"compare-mini-score":"compare-product-score",h=t?" "+t:"";return`
        <div class="${l}${h}" title="${d} points">
            <svg class="${l}-ring" viewBox="0 0 ${i} ${i}">
                <circle class="${l}-track" cx="${n}" cy="${n}" r="${s}" />
                <circle class="${l}-progress" cx="${n}" cy="${n}" r="${s}"
                        style="stroke-dasharray: ${o}; stroke-dashoffset: ${c};" />
            </svg>
            <span class="${l}-value">${d}</span>
        </div>
    `}function Sr(r="compare-spec-badge"){return`<span class="${r}">${Ce("check")}</span>`}function ps(r,e,t=!1){if(r==null||r==="")return"\u2014";if((e.format||"")==="boolean")return Hc(r);let i=Dn(r,e);return t?`
            <div class="compare-spec-value-inner">
                ${Sr("compare-spec-badge")}
                <span class="compare-spec-value-text">${ke(i)}</span>
            </div>
        `:ke(i)}function Hc(r){let e=r===!0||r==="Yes"||r==="yes"||r==="1"||r===1,t=e?"feature-yes":"feature-no",s=e?"check":"x",i=e?"Yes":"No";return`
        <div class="compare-spec-value-inner ${t}">
            <span class="compare-feature-badge">${Ce(s)}</span>
            <span class="compare-feature-text">${i}</span>
        </div>
    `}function Mn(r,e,t=!1){return(e.format||"")==="boolean"?`<td class="${r===!0||r==="Yes"||r==="yes"||r==="1"||r===1?"feature-yes":"feature-no"}">${ps(r,e,!1)}</td>`:t?`<td class="is-winner">${ps(r,e,!0)}</td>`:`<td>${ps(r,e,!1)}</td>`}function fs(r,e="compare-spec-card-product"){let t=r.thumbnail||"",s=r.name||"",i=t?`<img src="${t}" alt="">`:"";return`<span class="${e}">${i}${ke(s)}</span>`}function Fn(r,e,t,s=!1){if((t.format||"")==="boolean")return Er(r,e);let n=Dn(e,t);return s?`
            <div class="compare-spec-card-value is-winner">
                ${fs(r)}
                <span class="compare-spec-card-data">
                    <span class="compare-spec-badge">${Ce("check")}</span>
                    <span class="compare-spec-card-text">${ke(n)}</span>
                </span>
            </div>
        `:`
        <div class="compare-spec-card-value">
            ${fs(r)}
            <span class="compare-spec-card-data">
                <span class="compare-spec-card-text">${ke(n)}</span>
            </span>
        </div>
    `}function Er(r,e){let t=e===!0||e==="Yes"||e==="yes"||e==="1"||e===1,s=e!==null&&e!==""&&e!==void 0,i=s?t?"feature-yes":"feature-no":"",n=t?"check":"x",o=s?t?"Yes":"No":"\u2014",a=s?`<span class="compare-feature-badge">${Ce(n)}</span>`:"";return`
        <div class="compare-spec-card-value ${i}">
            ${fs(r)}
            <span class="compare-spec-card-data">${a}${o}</span>
        </div>
    `}function Gc(r){let e=ke(r.text||""),t=r.comparison?ke(r.comparison):"",s=r.tooltip?ke(r.tooltip):"",i=s?`<span class="info-trigger" data-tooltip="${s}" data-tooltip-trigger="click">${Ce("info",14,14)}</span>`:"",n=t?`<span class="compare-advantage-values">${t}</span>`:"";return`
        <li class="compare-advantage-item">
            <span class="compare-advantage-check">${Ce("check",16,16)}</span>
            <div class="compare-advantage-content">
                <span class="compare-advantage-text">${e}${i}</span>
                ${n}
            </div>
        </li>
    `}function Vc(r,e){let t=ke(r.name||"This product");if(!e||e.length===0)return`
            <div class="compare-advantage">
                <h4 class="compare-advantage-title">Where ${t} wins</h4>
                <p class="compare-advantage-empty">No clear advantages</p>
            </div>
        `;let s=e.map(i=>Gc(i)).join("");return`
        <div class="compare-advantage">
            <h4 class="compare-advantage-title">Where ${t} wins</h4>
            <ul class="compare-advantage-list">
                ${s}
            </ul>
        </div>
    `}function _n(r,e){return!r||r.length<2?"":r.map((s,i)=>{let n=e[i]||[];return Vc(s,n)}).join("")}function jc(r){let e=ke(r.text||""),t=r.comparison?ke(r.comparison):"",s=r.tooltip?ke(r.tooltip):"",i=t?`<span class="compare-advantage-values">${t}</span>`:"",n=s?`<span class="info-trigger" data-tooltip="${s}" data-tooltip-trigger="click">${Ce("info",14,14)}</span>`:"";return`
        <li class="compare-advantage-item">
            <span class="compare-advantage-check">${Ce("check",16,16)}</span>
            <div class="compare-advantage-content">
                <span class="compare-advantage-text">${e}${n}</span>
                ${i}
            </div>
        </li>
    `}function Wc(r,e){let t=ke(r.name||"This product");if(!e||e.length===0)return`
            <div class="compare-advantage compare-advantage--empty">
                <h4 class="compare-advantage-title">Where ${t} wins</h4>
                <p class="compare-advantage-empty">No clear advantages</p>
            </div>
        `;let s=e.map(i=>jc(i)).join("");return`
        <div class="compare-advantage">
            <h4 class="compare-advantage-title">Where ${t} wins</h4>
            <ul class="compare-advantage-list">
                ${s}
            </ul>
        </div>
    `}function Bn(r,e){return!r||r.length<3?"":r.map((s,i)=>{let n=e[i]||[];return Wc(s,n)}).join("")}var Dn,Nn=P(()=>{wr();Dn=xn});var go={};j(go,{default:()=>Sl,init:()=>Xn});function zn(){return window.erhData?.specConfig||{}}function Yn(){return zn().specGroups||{}}function zc(){return zn().categoryWeights||{}}function Yc(r){return r._normalized?r:{...r,currentPrice:r.currentPrice??r.current_price??null,buyLink:r.buyLink??r.buy_link??r.tracked_url??null,avg6m:r.avg6m??r.avg_6m??null,priceIndicator:r.priceIndicator??r.price_indicator??null,inStock:r.inStock??r.in_stock??!0,retailer:r.retailer??null,currency:r.currency??"USD",_normalized:!0}}function bs(r){if(!r.geoAware)return r;let e=Ee.geo||"US",t=Ee.symbol||$e(Ee.currency||"USD");return{...r,key:r.key.replace("{geo}",e),label:r.label.replace("{symbol}",t),currencySymbol:t}}async function Xn(){let r=document.querySelector(X.page);if(!r)return;let e=window.erhData?.compareConfig;if(On=e?.category||r.dataset.category||"escooter",Kn=e?.finderKey||On,!e?.productIds?.length||e.productIds.length<2){await rl();return}try{Ee=await z()}catch{console.warn("Geo detection failed, using defaults"),e.geo&&(Ee={geo:e.geo,currency:e.currencySymbol})}document.querySelector("[data-ssr-rendered]")?await Kc(e):await el(e)}async function Kc(r){let e=document.querySelector("[data-products-json]");if(e)try{H=JSON.parse(e.textContent||"[]").map(Yc)}catch(t){console.error("Failed to parse products JSON:",t),H=[]}await ws(),Ht(),Xc(),Jc(),Jn(),Qc(),Zc(),to(),xs(),lo(),oo(),ao(),Zn(),tl(),hs(r.productIds)}function Xc(){H.forEach(r=>{let e=document.querySelector(`.compare-product[data-product-id="${r.id}"]`);if(!e)return;let t=r.currentPrice||r.current_price,s=r.buyLink||r.buy_link,i=t&&r.retailer,n=i?_(t,r.currency):null,o=r.avg6m||r.avg_6m||r.priceData?.avg_6m,a=Ss(t,o),c=Ls(a),d=e.querySelector(".compare-product-image");if(d&&n){let u=document.createElement("div");u.className="compare-product-price-row",u.innerHTML=`<span class="compare-product-price">${n}</span>${c}`,d.appendChild(u)}let l=e.querySelector(".compare-product-actions");if(l&&i){let u=document.createElement("button");u.className="compare-product-track",u.dataset.track=r.id,u.dataset.name=r.name,u.dataset.image=r.thumbnail||"",u.dataset.price=t,u.dataset.currency=r.currency||"USD",u.setAttribute("aria-label","Track price"),u.innerHTML='<svg class="icon" width="16" height="16"><use href="#icon-bell"></use></svg>',l.appendChild(u)}let h=e.querySelector("[data-cta-placeholder]");if(h)if(i&&s){let u=document.createElement("a");u.href=se(s),u.className="compare-product-cta btn btn-primary btn-sm",u.target="_blank",u.rel="sponsored noopener",u.innerHTML=`Buy at ${F(r.retailer)} <svg class="icon" width="14" height="14"><use href="#icon-external-link"></use></svg>`,h.replaceWith(u)}else h.remove()})}function Jc(){document.querySelectorAll("[data-verdict-product]").length&&H.forEach(e=>{let t=document.querySelector(`[data-verdict-product="${e.id}"]`);if(!t)return;let s=e.currentPrice||e.current_price,i=e.buyLink||e.buy_link,n=s&&e.retailer,o=n?_(s,e.currency):null,a=e.avg6m||e.avg_6m||e.priceData?.avg_6m,c=Ss(s,a),d=Ls(c),l=t.querySelector("[data-verdict-price-row]"),h=t.querySelector("[data-verdict-price]"),u=t.querySelector("[data-verdict-cta]"),p=t.querySelector("[data-verdict-cta-mobile]");if(n){h&&(h.innerHTML=`${o}${d}`);let f=t.querySelector(".compare-verdict-product-image");if(f){let m=document.createElement("button");m.type="button",m.className="compare-verdict-product-track",m.dataset.track=e.id,m.dataset.name=e.name,m.dataset.image=e.thumbnail||"",m.dataset.price=s,m.dataset.currency=e.currency||"USD",m.setAttribute("aria-label","Track price"),m.innerHTML='<svg class="icon" width="14" height="14"><use href="#icon-bell"></use></svg>',f.appendChild(m),m.addEventListener("click",g=>{g.preventDefault(),g.stopPropagation(),oe.open({productId:parseInt(m.dataset.track,10),productName:m.dataset.name,productImage:m.dataset.image,currentPrice:parseFloat(m.dataset.price)||0,currency:m.dataset.currency||"USD"})})}if(i){let m=()=>{let g=document.createElement("a");return g.href=se(i),g.className="btn btn-sm btn-primary",g.target="_blank",g.rel="sponsored noopener",g.innerHTML=`Buy at ${F(e.retailer)} <svg class="icon" width="14" height="14"><use href="#icon-external-link"></use></svg>`,g};u&&u.replaceChildren(m()),p&&p.replaceChildren(m())}}else l&&(l.style.display="none"),u&&(u.style.display="none"),p&&(p.style.display="none")})}function Jn(){let r=document.querySelector("[data-value-analysis]");if(!r)return;let e=Ee.geo||"US",t=Ee.symbol||$e(Ee.currency||"USD"),s=(a,c,d)=>a==null?"\u2014":c?t+a.toFixed(2)+d:a.toFixed(2)+" "+d,i={higherBetter:!1};r.querySelectorAll("tr[data-spec-key]").forEach(a=>{let d=a.dataset.specKey.replace("{geo}",e),l=a.querySelector("[data-label-template]"),h=l?.dataset.labelTemplate||"",u=h.includes("{symbol}"),p=u?h.replace("{symbol}",""):h;if(l){let v=h.replace("{symbol}",t),w=Array.from(l.childNodes).find(b=>b.nodeType===Node.TEXT_NODE);w?w.textContent=v:l.prepend(v)}let f=a.querySelectorAll("td[data-product-id]"),m=[],g=[];f.forEach(v=>{let w=parseInt(v.dataset.productId,10),b=H.find(q=>q.id===w),k=b?Hn(b.specs,d):null;m.push(k),g.push({cell:v,value:k,isCurrencyMetric:u,unitSuffix:p})});let y=Ut(m,i);g.forEach(({cell:v,value:w,isCurrencyMetric:b,unitSuffix:k},q)=>{let G=y.includes(q),ee=s(w,b,k);G&&w!==null&&w!==void 0?(v.classList.add("is-winner"),v.innerHTML=`
                    <div class="compare-spec-value-inner">
                        ${Sr()}
                        <span class="compare-spec-value-text">${ee}</span>
                    </div>
                `):(v.classList.remove("is-winner"),v.textContent=ee)})});let o=r.querySelector("[data-value-analysis-mobile]");o&&o.querySelectorAll(".compare-spec-card[data-spec-key]").forEach(c=>{let l=c.dataset.specKey.replace("{geo}",e),h=c.querySelector("[data-label-template]"),u=h?.dataset.labelTemplate||"",p=u.includes("{symbol}"),f=p?u.replace("{symbol}",""):u;if(h){let w=u.replace("{symbol}",t),b=Array.from(h.childNodes).find(k=>k.nodeType===Node.TEXT_NODE);b?b.textContent=w:h.prepend(w)}let m=c.querySelectorAll(".compare-spec-card-value[data-product-id]"),g=[],y=[];m.forEach(w=>{let b=parseInt(w.dataset.productId,10),k=H.find(G=>G.id===b),q=k?Hn(k.specs,l):null;g.push(q),y.push({valueEl:w,value:q,isCurrencyMetric:p,unitSuffix:f})});let v=Ut(g,i);y.forEach(({valueEl:w,value:b,isCurrencyMetric:k,unitSuffix:q},G)=>{let ee=w.querySelector(".compare-spec-card-text");if(!ee)return;let re=v.includes(G),M=s(b,k,q);if(re&&b!==null&&b!==void 0){w.classList.add("is-winner");let E=w.querySelector(".compare-spec-card-data");E&&(E.innerHTML=`
                            ${Sr()}
                            <span class="compare-spec-card-text">${M}</span>
                        `)}else w.classList.remove("is-winner"),ee.textContent=M})})}function Qc(){document.querySelectorAll("[data-mini-price-placeholder]").forEach(e=>{let t=parseInt(e.dataset.productId,10),s=e.dataset.buyLink,i=H.find(a=>a.id===t);if(!i){e.style.display="none";return}let n=i.currentPrice||i.current_price;if(n&&i.retailer&&s){let a=_(n,i.currency),c=document.createElement("a");c.href=se(s),c.className="compare-mini-price-link",c.target="_blank",c.rel="sponsored noopener",c.textContent=a+" ";let d=document.createElementNS("http://www.w3.org/2000/svg","svg");d.setAttribute("class","icon"),d.setAttribute("width","12"),d.setAttribute("height","12");let l=document.createElementNS("http://www.w3.org/2000/svg","use");l.setAttribute("href","#icon-external-link"),d.appendChild(l),c.appendChild(d),e.appendChild(c)}else e.style.display="none"})}function Zc(){let r=document.querySelector("[data-compare-buy-row]");if(!r)return;let e=r.querySelectorAll("[data-buy-cell]"),t=!1;e.forEach(s=>{let i=parseInt(s.dataset.buyCell,10),n=H.find(d=>d.id===i);if(!n){s.innerHTML="";return}let o=n.currentPrice||n.current_price,a=n.buyLink||n.buy_link;if(o&&n.retailer&&a){t=!0;let d=_(o,n.currency),l=document.createElement("a");l.href=se(a),l.className="btn btn-sm btn-primary",l.target="_blank",l.rel="sponsored noopener",l.innerHTML=`
                <span class="compare-buy-price">${d}</span>
                <span class="compare-buy-retailer">at ${F(n.retailer)}</span>
                <svg class="icon" width="14" height="14"><use href="#icon-external-link"></use></svg>
            `,s.replaceChildren(l)}else s.innerHTML=""}),t||(r.dataset.hidden="true")}function Hn(r,e){if(!(!r||!e))return e.split(".").reduce((t,s)=>t?.[s],r)}async function el(r){if(await nl(r.productIds),H.length<2){qn("Could not load product data.");return}Ht(),Es(),xs(),lo(),oo(),ao(),Zn(),hs(r.productIds)}function tl(){let r=document.querySelector(X.products);if(!r)return;r.querySelectorAll("[data-remove]").forEach(t=>{t.addEventListener("click",s=>{s.preventDefault();let i=parseInt(t.dataset.remove,10);po(i)})}),r.querySelectorAll("[data-track]").forEach(t=>{t.addEventListener("click",s=>{s.preventDefault(),s.stopPropagation(),oe.open({productId:parseInt(t.dataset.track,10),productName:t.dataset.name,productImage:t.dataset.image,currentPrice:parseFloat(t.dataset.price)||0,currency:t.dataset.currency||"USD"})})});let e=r.querySelector("[data-open-add-modal]");e&&e.addEventListener("click",()=>{le.openById("compare-add-modal",e),setTimeout(()=>{document.querySelector(X.searchInput)?.focus()},100)})}async function rl(){await ws();let r=document.querySelector(X.addBtn);r&&r.addEventListener("click",()=>{le.openById("compare-add-modal",r),setTimeout(()=>{document.querySelector(X.searchInput)?.focus()},100)}),sl()}function sl(){let r=document.querySelector(X.searchInput),e=document.querySelector(X.searchResults),t=document.querySelector(X.inputs);if(!r||!e)return;let s=[],i=null;r.addEventListener("input",()=>{clearTimeout(i),i=setTimeout(()=>{let n=r.value.trim().toLowerCase();if(n.length<2){e.innerHTML='<p class="compare-search-hint">Type to search...</p>';return}uo(n,e,s,o=>{s.push(o),Qn(t,s,()=>{Gn(s)}),us(),r.value="",e.innerHTML="",s.length>=2&&Gn(s)})},150)})}function Qn(r,e,t){r&&(r.innerHTML=e.map(s=>`
        <div class="compare-selector-product">
            <img src="${s.thumbnail||""}" alt="" class="compare-selector-thumb">
            <span class="compare-selector-name">${F(s.name)}</span>
            <button type="button" class="compare-selector-remove" data-remove="${s.id}" aria-label="Remove">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M18 6L6 18M6 6l12 12"/>
                </svg>
            </button>
        </div>
    `).join(""),r.querySelectorAll("[data-remove]").forEach(s=>{s.addEventListener("click",()=>{let i=parseInt(s.dataset.remove,10),n=e.findIndex(o=>o.id===i);n>-1&&e.splice(n,1),Qn(r,e,t),t?.()})}))}function Gn(r){let e=document.querySelector(".compare-selector-submit");if(r.length<2){e?.remove();return}e||(e=document.createElement("button"),e.className="compare-selector-submit btn btn--primary",e.textContent="Compare Now",document.querySelector(".compare-selector")?.appendChild(e)),e.onclick=()=>{window.location.href=ds(r.map(t=>t.id),st)}}function il(){let r=window.innerWidth,t=Math.min(r,kn)-Cn-$n,s=Math.floor(t/An);return H.length>s}function Ht(){let r=document.querySelector(X.page),e=document.querySelector(".compare-section--specs");if(!r)return;let t=il(),s=Un;if(Un=t,r.dataset.productCount=H.length,r.style.setProperty("--product-count",H.length),t?r.classList.add("compare-page--full-width"):r.classList.remove("compare-page--full-width"),e){let i=e.querySelector(".container, .compare-section-full");t?(e.classList.add("compare-section--full"),i&&(i.classList.remove("container"),i.classList.add("compare-section-full"))):(e.classList.remove("compare-section--full"),i&&(i.classList.remove("compare-section-full"),i.classList.add("container")))}s!==t&&co()}function Zn(){let r=null;window.addEventListener("resize",()=>{clearTimeout(r),r=setTimeout(()=>{Ht()},150)},{passive:!0})}async function nl(r){try{await ws(),H=r.map(e=>st.find(t=>t.id===e)).filter(Boolean).map(eo)}catch(e){console.error("Failed to load products:",e)}}async function ws(){if(st.length)return;let e=`${window.erhData?.siteUrl||""}/wp-content/uploads/finder_${Kn}.json`,t=await fetch(e);if(!t.ok)throw new Error(`HTTP ${t.status}`);st=await t.json()}function eo(r){let e=Ee.geo||"US",t=r.pricing||{},s=t[e],i=s?.current_price!=null,o=!Oe(e)&&!i,a,c;i?(a=s,c=Ee.currency):o?(a=t.US||{},c="USD"):(a={},c=Ee.currency);let d=a.current_price||null,l=a.avg_6m||null;return{...r,currentPrice:d,currency:c,priceData:a,inStock:a.instock!==!1,buyLink:d&&a.tracked_url||null,retailer:d&&a.retailer||null,priceIndicator:Ss(d,l),avg6m:l,_normalized:!0}}function Ss(r,e){return!r||!e||e<=0?null:Math.round((r-e)/e*100)}function Es(){if(!gs){gs=!0;try{try{ol()}catch(r){console.error("Failed to render products:",r)}try{to()}catch(r){console.error("Failed to render overview:",r)}try{ll()}catch(r){console.error("Failed to render specs:",r)}try{Jn()}catch(r){console.error("Failed to hydrate value analysis:",r)}}finally{gs=!1}}}function ol(){let r=document.querySelector(X.products);if(!r)return;let e=window.erhData?.compareConfig,t=e?.verdictWinner,s=e?.isCurated,i=H.map((o,a)=>{try{let c=so(o),d=o.currentPrice?_(o.currentPrice,o.currency):null,l=s&&t===`product_${a+1}`,h=Ls(o.priceIndicator),u=o.retailer&&o.buyLink;return`
            <article class="compare-product" data-product-id="${o.id}">
                <!-- Score ring (top-left, uses shared renderer) -->
                ${In(c,"md")}

                <div class="compare-product-actions">
                    <button class="compare-product-remove" data-remove-product="${o.id}" aria-label="Remove from comparison">
                        <svg class="icon" width="14" height="14"><use href="#icon-x"></use></svg>
                    </button>
                    ${o.currentPrice?`
                        <button class="compare-product-track" data-track="${o.id}"
                                data-name="${F(o.name)}"
                                data-image="${o.thumbnail||""}"
                                data-price="${o.currentPrice}"
                                data-currency="${o.currency}"
                                aria-label="Track price">
                            <svg class="icon" width="16" height="16"><use href="#icon-bell"></use></svg>
                        </button>
                    `:""}
                </div>

                <a href="${o.url}" class="compare-product-link">
                    <div class="compare-product-image">
                        <img src="${o.thumbnail||""}" alt="${F(o.name)}">
                        ${d?`
                            <div class="compare-product-price-row">
                                <span class="compare-product-price">${d}</span>
                                ${h}
                            </div>
                        `:""}
                    </div>
                </a>

                <div class="compare-product-content">
                    <a href="${o.url}" class="compare-product-name">${F(o.name)}</a>
                    ${u?`
                        <a href="${se(o.buyLink)}" class="compare-product-cta btn btn-primary btn-sm" target="_blank" rel="sponsored noopener">
                            Buy at ${o.retailer}
                            <svg class="icon" width="14" height="14"><use href="#icon-external-link"></use></svg>
                        </a>
                    `:""}
                </div>
            </article>
        `}catch(c){return console.error(`Failed to render product ${o?.id}:`,c),`<article class="compare-product compare-product--error" data-product-id="${o?.id||"unknown"}">
                <div class="compare-product-error">Failed to load product</div>
            </article>`}}).join(""),n=`
        <div class="compare-product compare-product--add-wrap">
            <button class="compare-product-add-btn" data-open-add-modal>
                <svg class="icon" width="24" height="24"><use href="#icon-plus"></use></svg>
                <span>Add</span>
            </button>
        </div>
    `;r.innerHTML=i+n,r.querySelectorAll("[data-track]").forEach(o=>{o.addEventListener("click",a=>{a.preventDefault(),a.stopPropagation(),oe.open({productId:parseInt(o.dataset.track,10),productName:o.dataset.name,productImage:o.dataset.image,currentPrice:parseFloat(o.dataset.price)||0,currency:o.dataset.currency||"USD"})})}),r.querySelectorAll("[data-remove-product]").forEach(o=>{o.addEventListener("click",()=>po(parseInt(o.dataset.removeProduct,10)))}),r.querySelector("[data-open-add-modal]")?.addEventListener("click",()=>{le.openById("compare-add-modal"),setTimeout(()=>document.querySelector(X.searchInput)?.focus(),100)})}function Ls(r){if(r==null||r>=-5&&r<=10)return"";let e=r<0,t=e?"compare-product-indicator--below":"compare-product-indicator--above",s=e?"arrow-down":"arrow-up",i=Math.abs(r);return`
        <span class="compare-product-indicator ${t}">
            <svg class="icon compare-product-indicator-icon" aria-hidden="true"><use href="#icon-${s}"></use></svg>${i}%
        </span>
    `}function to(){let r=document.querySelector(X.overview);if(!r||H.length<2)return;let e=r.querySelector("[data-radar-container]"),t=r.querySelector(".compare-advantages");if(e&&t&&!Rn){Rn=!0,Vn();return}r.innerHTML=`
        <div class="compare-overview-grid">
            <div class="compare-radar">
                <h3 class="compare-radar-title">Category Scores</h3>
                <div class="compare-radar-chart" data-radar-chart></div>
            </div>
            <div class="compare-advantages compare-advantages--loading">
                ${H.map(s=>`
                    <div class="compare-advantage">
                        <div class="skeleton skeleton--text" style="width: 60%; height: 1.2em;"></div>
                        <div class="skeleton skeleton--text" style="width: 90%; height: 0.9em; margin-top: 0.5em;"></div>
                        <div class="skeleton skeleton--text" style="width: 85%; height: 0.9em; margin-top: 0.5em;"></div>
                    </div>
                `).join("")}
            </div>
        </div>
    `,Vn(),al()}async function al(){let r=document.querySelector(".compare-advantages");if(!r||H.length<1)return;let e=H.map(n=>n.id).join(","),{geo:t}=await z(),{restUrl:s,nonce:i}=window.erhData||{};if(!s){console.error("erhData.restUrl not available"),r.classList.remove("compare-advantages--loading");return}try{let n=await fetch(`${s}compare/advantages?products=${e}&geo=${t}`,{headers:{"X-WP-Nonce":i||""}});if(!n.ok)throw new Error(`HTTP ${n.status}`);let o=await n.json();if(!o.success){console.error("Advantages API error:",o.message);return}o.mode==="head_to_head"&&o.advantages?r.innerHTML=_n(H,o.advantages):o.mode==="multi"&&o.advantages?r.innerHTML=Bn(H,o.advantages):o.mode==="single"&&(r.innerHTML="")}catch(n){console.error("Failed to fetch advantages:",n)}finally{r.classList.remove("compare-advantages--loading")}}function Vn(){let r=document.querySelector("[data-radar-chart]");if(!r)return;Lr&&Lr.destroy();let e=zc(),t=Object.entries(e).filter(([i,n])=>n>0).map(([i])=>({key:i,name:i})),s=H.map(i=>({id:i.id,name:i.name,scores:Object.fromEntries(t.map(n=>[n.key,io(i,n.key)]))}));Lr=new ft(r,{size:340,levels:5,maxValue:100,labelOffset:28}),Lr.setData(s,t)}function cl(){let e=2*Math.PI*15;return`
        <div class="compare-mini-header">
            <table class="compare-mini-table">
                ${`
        <colgroup>
            <col class="compare-spec-col-label">
            ${H.map(()=>"<col>").join("")}
        </colgroup>
    `}
                <tr>
                    <td class="compare-mini-label">
                        <label class="compare-diff-toggle">
                            <input type="checkbox" data-diff-toggle>
                            <span class="compare-diff-toggle-switch"></span>
                            <span class="compare-diff-toggle-label">Differences only</span>
                        </label>
                    </td>
                    ${H.map(s=>{let i=so(s),n=Math.min(100,Math.max(0,i)),o=e-n/100*e,a=s.currentPrice?_(s.currentPrice,s.currency):"",c=s.retailer&&s.buyLink;return`
                            <td>
                                <div class="compare-mini-product">
                                    <div class="compare-mini-thumb-wrap">
                                        <img src="${s.thumbnail||""}" alt="" class="compare-mini-thumb">
                                    </div>
                                    <div class="compare-mini-score" title="${i} points">
                                        <svg class="compare-mini-score-ring" viewBox="0 0 36 36">
                                            <circle class="compare-mini-score-track" cx="18" cy="18" r="15" />
                                            <circle class="compare-mini-score-progress" cx="18" cy="18" r="15"
                                                    style="stroke-dasharray: ${e}; stroke-dashoffset: ${o};" />
                                        </svg>
                                        <span class="compare-mini-score-value">${i}</span>
                                    </div>
                                    <div class="compare-mini-info">
                                        <span class="compare-mini-name">${F(s.name)}</span>
                                        ${c?`
                                            <a href="${se(s.buyLink)}" class="compare-mini-price" target="_blank" rel="sponsored noopener">
                                                ${a}
                                                <svg class="icon" width="12" height="12"><use href="#icon-external-link"></use></svg>
                                            </a>
                                        `:""}
                                    </div>
                                </div>
                            </td>
                        `}).join("")}
                </tr>
            </table>
        </div>
    `}function ll(){let r=document.querySelector(X.specs);if(!r)return;let e=Yn(),t=[],s=[];for(let[o,a]of Object.entries(e)){let c=(a.specs||[]).filter(y=>{let v=bs(y);return!H.map(b=>rt(b,v.key)).every(b=>b==null||b==="")});if(!c.length)continue;let d=o.toLowerCase().replace(/[^a-z0-9]+/g,"-").replace(/(^-|-$)/g,"");s.push({name:o,slug:d});let l=H.map(y=>io(y,o)),h=-1,u=l.filter(y=>y>0);if(u.length>=2){let y=Math.max(...u),v=l.map((w,b)=>w===y?b:-1).filter(w=>w>=0);v.length===1&&(h=v[0])}let p=ml(c),f=a.valueMetric?hl(a.valueMetric):"",m=dl(c),g=`
            <colgroup>
                <col class="compare-spec-col-label">
                ${H.map(()=>"<col>").join("")}
            </colgroup>
        `;t.push(`
            <div id="${d}" class="compare-spec-category" data-section="${d}">
                <h3 class="compare-spec-category-title">${o}</h3>
                <!-- Desktop table -->
                <table class="compare-spec-table">
                    ${g}
                    <tbody>${p.join("")}${f}</tbody>
                </table>
                <!-- Mobile stacked cards -->
                <div class="compare-spec-cards">
                    ${m}
                </div>
            </div>
        `)}let i=cl(),n=t.join("");r.innerHTML=`
        ${i}
        <div class="compare-specs-scroll">${n}</div>
    `,co(),yl(s)}function dl(r){let e=[],t=["suspensionArray","suspension"];for(let s of r){let i=bs(s),n=H.map(u=>rt(u,i.key));if(n.some(u=>Array.isArray(u))&&!t.includes(i.format)){e.push(...ul(i,n));continue}let c=i.type==="boolean"||n.every(u=>u===null||u===""||u===!0||u===!1||u==="Yes"||u==="No"||u==="yes"||u==="no"),d=Ut(n,i),l=i.tooltip?`
            <span class="info-trigger" data-tooltip="${F(i.tooltip)}" data-tooltip-trigger="click">
                ${Ce("info",14,14)}
            </span>
        `:"",h=H.map((u,p)=>{let f=n[p],m=d.includes(p);return c?Er(u,f):Fn(u,f,i,m)}).join("");e.push(`
            <div class="compare-spec-card">
                <div class="compare-spec-card-label">
                    ${i.label}${l}
                </div>
                <div class="compare-spec-card-values">
                    ${h}
                </div>
            </div>
        `)}return e.join("")}function ul(r,e){let t=[],s=new Set;if(e.forEach(i=>{Array.isArray(i)&&i.forEach(n=>s.add(n))}),s.size===0)return t;for(let i of s){let n=H.map((o,a)=>{let c=e[a],d=Array.isArray(c)&&c.includes(i);return Er(o,d)}).join("");t.push(`
            <div class="compare-spec-card">
                <div class="compare-spec-card-label">${i}</div>
                <div class="compare-spec-card-values">
                    ${n}
                </div>
            </div>
        `)}return t}function hl(r){let e=H.map(n=>{let o=rt(n,r.key);return(o==null||o==="")&&r.fallback&&(o=rt(n,r.fallback)),o});if(e.every(n=>n==null||n===""))return"";let t=e.map((n,o)=>({v:parseFloat(n)||1/0,i:o})).filter(n=>isFinite(n.v)&&n.v>0),s=-1;if(t.length>=2){let n=r.lowerBetter?Math.min(...t.map(a=>a.v)):Math.max(...t.map(a=>a.v)),o=t.filter(a=>a.v===n);o.length===1&&(s=o[0].i)}let i=e.map((n,o)=>{let a=o===s?"is-winner":"",c=n!=null&&n!==""?_(parseFloat(n),H[o]?.currency||Ee.currency):"\u2014";return`<td class="${a}">${c}</td>`}).join("");return`<tr><td>${r.label}</td>${i}</tr>`}function ro(r){let e=r===!0||r==="Yes"||r==="yes"||r===1,t=e?"feature-yes":"feature-no",s=e?"check":"x",i=e?"Yes":"No";return`
        <td class="${t}">
            <div class="compare-spec-value-inner">
                <span class="compare-feature-badge">${Ce(s)}</span>
                <span class="compare-feature-text">${i}</span>
            </div>
        </td>
    `}function pl(r){let e=[],t=H.map(i=>rt(i,r.key)),s=new Set;if(t.forEach(i=>{Array.isArray(i)&&i.forEach(n=>s.add(n))}),s.size===0)return e;for(let i of s){let n=H.map((d,l)=>{let h=t[l];return Array.isArray(h)&&h.includes(i)}),a=n.every(d=>d===n[0])?" data-same-values":"",c=n.map(d=>ro(d)).join("");e.push(`
            <tr${a}>
                <td>
                    <div class="compare-spec-label">${F(i)}</div>
                </td>
                ${c}
            </tr>
        `)}return e}function fl(r){let e=r.filter(i=>i!=null&&i!=="");if(e.length<=1)return!0;let t=i=>Array.isArray(i)?JSON.stringify(i.sort()):typeof i=="boolean"?i.toString():String(i).toLowerCase().trim(),s=t(e[0]);return e.every(i=>t(i)===s)}function ml(r){let e=[];for(let t of r){if(t.format==="featureArray"){e.push(...pl(t));continue}let s=bs(t),i=H.map(l=>rt(l,s.key));if(i.every(l=>l==null||l===""))continue;let o=fl(i)?" data-same-values":"";if(s.format==="boolean"){let l=i.map(u=>u==null||u===""?"<td>\u2014</td>":ro(u)).join(""),h=s.tooltip?`
                <span class="info-trigger" data-tooltip="${F(s.tooltip)}" data-tooltip-trigger="click">
                    ${Ce("info",14,14)}
                </span>
            `:"";e.push(`
                <tr${o}>
                    <td>
                        <div class="compare-spec-label">${s.label}${h}</div>
                    </td>
                    ${l}
                </tr>
            `);continue}let a=Ut(i,s),c=i.map((l,h)=>{let u=a.includes(h);return Mn(l,s,u)}).join(""),d=s.tooltip?`
            <span class="info-trigger" data-tooltip="${F(s.tooltip)}" data-tooltip-trigger="click">
                ${Ce("info",14,14)}
            </span>
        `:"";e.push(`
            <tr${o}>
                <td>
                    <div class="compare-spec-label">${s.label}${d}</div>
                </td>
                ${c}
            </tr>
        `)}return e}function so(r){return(r.specs||r).scores?.overall??0}function io(r,e){let t=r.specs||r,i=Yn()[e]?.scoreKey||gl[e];return i?t.scores?.[i]??0:0}function yl(r){let e=document.querySelector(X.navLinks);if(!e)return;e.querySelectorAll('[data-nav-link]:not([data-nav-link="overview"])').forEach(n=>n.remove());let t=window.erhData?.compareConfig,s=r.map(({name:n,slug:o})=>`<a href="#${o}" class="compare-nav-link" data-nav-link="${o}">${n}</a>`).join(""),i=t?.isCurated?'<a href="#verdict" class="compare-nav-link" data-nav-link="verdict">Verdict</a>':"";e.insertAdjacentHTML("beforeend",s+i),xs()}function xs(){let r=document.querySelector(X.nav);r&&(r.removeEventListener("click",jn),r.addEventListener("click",jn),vl())}function jn(r){let e=r.target.closest(X.navLink);if(!e)return;r.preventDefault();let t=e.getAttribute("href")?.slice(1),s=document.getElementById(t);if(!s)return;ys=!0;let i=document.querySelector(X.nav),n=document.querySelector(X.navLinks);i?.querySelectorAll(X.navLink).forEach(a=>{a.classList.toggle("is-active",a===e)}),no(n);let o=s.getBoundingClientRect().top+window.scrollY-cs;window.scrollTo({top:o,behavior:"smooth"}),xr(()=>{ys=!1})}function xr(r){let e=window.scrollY,t=0,s=100;clearInterval(xr.interval),xr.interval=setInterval(()=>{t++,(window.scrollY===e||t>=s)&&(clearInterval(xr.interval),r()),e=window.scrollY},25)}function vl(){let r=document.querySelector(X.nav),e=document.querySelector(X.navLinks),t=document.querySelectorAll(X.section);if(!r||!t.length)return;let s=null,i=()=>{if(ys)return;let n=r.querySelectorAll(X.navLink),o="";t.forEach(a=>{a.getBoundingClientRect().top<=cs+50&&(o=a.dataset.section)}),n.forEach(a=>{a.classList.toggle("is-active",a.dataset.navLink===o)}),o&&o!==s&&(s=o,no(e))};window.removeEventListener("scroll",ms),ms=Tn(i,50),window.addEventListener("scroll",ms,{passive:!0}),i()}function no(r){if(!r||!(r.scrollWidth>r.clientWidth))return;let t=r.querySelector(".compare-nav-link.is-active");if(!t)return;let s=r.clientWidth,i=t.offsetLeft,n=t.offsetWidth,o=i-s/2+n/2;r.scrollTo({left:Math.max(0,o),behavior:"smooth"})}function oo(){let r=document.querySelector(X.nav);r&&(Rt&&(Rt.disconnect(),Rt=null),Ve&&Ve.parentNode&&(Ve.remove(),Ve=null),Ve=document.createElement("div"),Ve.style.cssText="height: 1px; margin-bottom: -1px; pointer-events: none;",r.parentNode.insertBefore(Ve,r),Rt=new IntersectionObserver(([e])=>{r.classList.toggle("is-stuck",!e.isIntersecting)},{threshold:0,rootMargin:"0px"}),Rt.observe(Ve))}function ao(){let r=document.querySelector("[data-diff-toggle]");r&&r.addEventListener("change",()=>{let e=document.querySelector(X.specs);e&&e.classList.toggle("show-diff-only",r.checked)})}function co(){bl();let r=document.querySelector(".compare-mini-header"),e=document.querySelector(".compare-specs-scroll");if(!r||!e)return;let t=!1;r.addEventListener("scroll",()=>{t||(t=!0,e.scrollLeft=r.scrollLeft,requestAnimationFrame(()=>{t=!1}))},{passive:!0}),e.addEventListener("scroll",()=>{t||(t=!0,r.scrollLeft=e.scrollLeft,requestAnimationFrame(()=>{t=!1}))},{passive:!0}),Wn(e),Wn(r)}function bl(){vs.forEach(r=>r()),vs=[]}function Wn(r){if(!r)return;if(window.innerWidth<=768){r.style.cursor="";return}if(r.scrollWidth<=r.clientWidth){r.style.cursor="";return}let e=!1,t=0,s=0;r.style.cursor="grab";let i=c=>{c.target.closest("a, button, input, label")||(e=!0,r.style.cursor="grabbing",r.style.userSelect="none",t=c.pageX-r.offsetLeft,s=r.scrollLeft)},n=()=>{e&&(e=!1,r.style.cursor="grab",r.style.userSelect="")},o=()=>{e=!1,r.style.cursor="grab",r.style.userSelect=""},a=c=>{if(!e)return;c.preventDefault();let l=(c.pageX-r.offsetLeft-t)*1.5;r.scrollLeft=s-l};r.addEventListener("mousedown",i),r.addEventListener("mouseleave",n),r.addEventListener("mouseup",o),r.addEventListener("mousemove",a),vs.push(()=>{r.removeEventListener("mousedown",i),r.removeEventListener("mouseleave",n),r.removeEventListener("mouseup",o),r.removeEventListener("mousemove",a),r.style.cursor="",r.style.userSelect=""})}function lo(){let r=document.querySelector(X.searchInput),e=document.querySelector(X.searchResults);if(!r||!e)return;let t=null;r.addEventListener("input",()=>{clearTimeout(t),t=setTimeout(()=>{let s=r.value.trim().toLowerCase();if(s.length<2){e.innerHTML='<p class="compare-search-hint">Type to search...</p>';return}uo(s,e,H,i=>{wl(i),us(),r.value="",e.innerHTML=""})},150)})}function uo(r,e,t,s){let i=t.map(o=>o.id),n=st.filter(o=>!i.includes(o.id)&&o.name.toLowerCase().includes(r)).slice(0,8);if(!n.length){e.innerHTML='<p class="compare-search-empty">No products found</p>';return}e.innerHTML=n.map(o=>{let a=Ee.geo||"US",c=o.pricing?.[a],d=c?.current_price!=null,l=Oe(a),h=null,u=Ee.currency;d?h=c.current_price:!l&&o.pricing?.US?.current_price&&(h=o.pricing.US.current_price,u="USD");let p=h?_(h,u):"";return`
            <button type="button" class="compare-search-result" data-id="${o.id}">
                <img src="${o.thumbnail||""}" alt="" class="compare-search-result-img">
                <div class="compare-search-result-info">
                    <span class="compare-search-result-name">${F(o.name)}</span>
                    ${p?`<span class="compare-search-result-price">${p}</span>`:""}
                </div>
            </button>
        `}).join(""),e.querySelectorAll("[data-id]").forEach(o=>{o.addEventListener("click",()=>{let a=st.find(c=>c.id===parseInt(o.dataset.id,10));a&&s(a)})})}function ho(){let r=window.erhData?.compareConfig;if(!r?.isCurated)return;[".compare-intro",".compare-section--verdict"].forEach(s=>{let i=document.querySelector(s);i&&i.remove()});let t=document.querySelector('[data-nav-link="verdict"]');t&&t.remove(),r.isCurated=!1}function wl(r){ho();let e=eo(r);H.push(e),fo(),mo(),Es(),Ht()}function po(r){H.length<=2||(ho(),H=H.filter(e=>e.id!==r),fo(),mo(),Es(),Ht())}function fo(){let r=H.map(t=>t.id),e=ds(r,st);window.history.replaceState({},"",e)}function mo(){let r=H.map(o=>o.name),e=r.length;if(e===0)return;let t=window.erhData?.compareConfig?.categoryName||"Electric Rides",s;e<=3?s=r.join(" vs "):s=`Comparing ${e} ${t}`,document.title=s;let i=document.querySelector("title");i&&(i.textContent=s);let n=document.querySelector('meta[property="og:title"]');n&&n.setAttribute("content",s)}var H,st,On,Kn,Ee,Lr,Un,ms,ys,Rt,Ve,gs,Rn,vs,gl,Sl,yo=P(()=>{ne();_r();_e();Ue();as();fe();wr();ls();Pn();Nn();H=[],st=[],On="escooter",Kn="escooter",Ee={geo:"US",currency:"USD"},Lr=null,Un=!1,ms=null,ys=!1,Rt=null,Ve=null,gs=!1,Rn=!1,vs=[];gl={"Motor Performance":"motor_performance","Range & Battery":"range_battery","Ride Quality":"ride_quality","Portability & Fit":"portability",Safety:"safety",Features:"features",Maintenance:"maintenance","Motor & Drive":"motor_drive","Battery & Range":"battery_range","Component Quality":"component_quality",Comfort:"comfort",Practicality:"practicality",Portability:"portability","Ride Comfort":"ride_comfort"};Sl={init:Xn}});function bo(r){return xl[r]||{singular:"product",plural:"products"}}function kl(r,e="comparison"){let t=window.erhData?.tooltips;if(!t)return null;let s=r.replace(/\.(US|GB|EU|CA|AU)\./,"."),i=t[s];if(!i)return null;switch(e){case"comparison":return i.comparison||i.methodology||null;case"methodology":default:return i.methodology||null}}function Cl(r){for(let e of El)if(r>=e.minPercentile)return e.label;return"Good"}function $l(r){for(let e of Ll)if(r<=e.maxPercentile)return e.label;return"Weak"}function Al(r){let e=kl(r,"comparison");return e||"Performance metric compared against similar products."}function ql(r){return r.comparison||""}function vo(r,e){let s=e==="strength"?"check":"x",i=r.text||Tl(r,e),n=ql(r),o=r.tooltip||Al(r.spec_key),a=n?`<div class="analysis-item-comparison"><span class="analysis-item-value">${F(n)}</span></div>`:"";return`
        <li class="analysis-item">
            <div class="analysis-item-icon">
                <svg class="icon" aria-hidden="true">
                    <use href="#icon-${s}"></use>
                </svg>
            </div>
            <div class="analysis-item-content">
                <div class="analysis-item-header">
                    <span class="analysis-item-label">${F(i)}</span>
                    <button type="button" class="info-trigger" data-tooltip="${F(o)}" data-tooltip-trigger="click" aria-label="More info">
                        <svg class="icon" aria-hidden="true">
                            <use href="#icon-info"></use>
                        </svg>
                    </button>
                </div>
                ${a}
            </div>
        </li>
    `}function Tl(r,e){return`${e==="strength"?Cl(r.percentile):$l(r.percentile)} ${r.label.toLowerCase()}`}function Pl(r,e){let{bracket:t,products_in_bracket:s,comparison_mode:i}=r,n=bo(e);if(i==="category")return`Compared to all ${n.plural}`;let o=t?.label||"this price range",a=t?`$${t.min.toLocaleString()}\u2013${t.max===2147483647?"+":"$"+t.max.toLocaleString()}`:"";return`Compared to ${s} ${n.plural} in the ${o} bracket${a?` (${a})`:""}`}var El,Ll,xl,kr,wo=P(()=>{fe();ne();er();El=[{minPercentile:95,label:"Best"},{minPercentile:90,label:"Excellent"},{minPercentile:80,label:"Strong"},{minPercentile:0,label:"Good"}],Ll=[{maxPercentile:5,label:"Very low"},{maxPercentile:10,label:"Low"},{maxPercentile:20,label:"Below average"},{maxPercentile:100,label:"Weak"}],xl={escooter:{singular:"scooter",plural:"electric scooters"},ebike:{singular:"e-bike",plural:"electric bikes"},euc:{singular:"EUC",plural:"electric unicycles"},eskateboard:{singular:"e-skateboard",plural:"electric skateboards"},hoverboard:{singular:"hoverboard",plural:"hoverboards"}};kr=class{constructor(e,t={}){this.container=e,this.productId=t.productId,this.category=t.category,this.skeletonEl=e.querySelector("[data-analysis-skeleton]"),this.contentEl=e.querySelector("[data-analysis-content]"),this.emptyEl=e.querySelector("[data-analysis-empty]"),this.strengthsList=e.querySelector("[data-strengths-list]"),this.weaknessesList=e.querySelector("[data-weaknesses-list]"),this.contextTextEl=e.querySelector("[data-context-text]"),t.data?this.renderWithData(t.data):this.init()}renderWithData(e){e?this.render(e):this.showError()}async init(){try{let t=(await z()).geo,s=await this.fetchAnalysis(t);s?this.render(s):this.showError()}catch(e){console.error("[ProductAnalysis] Failed to load:",e),this.showError()}}async fetchAnalysis(e){let{restUrl:t,nonce:s}=window.erhData||{};if(!t||!this.productId)throw new Error("Missing required data");let i=`${t}products/${this.productId}/analysis?geo=${e}`,n=await fetch(i,{headers:{"X-WP-Nonce":s}});if(!n.ok)throw new Error(`API error: ${n.status}`);return n.json()}render(e){let{advantages:t=[],weaknesses:s=[],price_context:i={}}=e,n=t.length>0,o=s.length>0,a=this.container.querySelector(".analysis-strengths"),c=this.container.querySelector(".analysis-weaknesses");if(!n&&!o){this.showBalanced(i);return}n&&this.strengthsList?(this.strengthsList.innerHTML=t.map(d=>vo(d,"strength")).join(""),a&&(a.style.display="")):a&&(a.style.display="none"),o&&this.weaknessesList?(this.weaknessesList.innerHTML=s.map(d=>vo(d,"weakness")).join(""),c&&(c.style.display="")):c&&(c.style.display="none"),this.contextTextEl&&(this.contextTextEl.textContent=Pl(i,this.category)),this.showContent(),kt()}showContent(){this.skeletonEl&&(this.skeletonEl.style.display="none"),this.contentEl&&(this.contentEl.style.display=""),this.emptyEl&&(this.emptyEl.style.display="none")}showBalanced(e){if(this.skeletonEl&&(this.skeletonEl.style.display="none"),this.contentEl&&(this.contentEl.style.display="none"),this.emptyEl){let t=e?.bracket?.label||"its price range",s=this.emptyEl.querySelector(".analysis-empty-message");if(s){let i=bo(this.category);s.textContent=`This ${i.singular} performs close to average for the ${t} bracket \u2014 no significant strengths or weaknesses identified.`}this.emptyEl.style.display=""}}showError(){if(this.skeletonEl&&(this.skeletonEl.style.display="none"),this.contentEl&&(this.contentEl.style.display="none"),this.emptyEl){let e=this.emptyEl.querySelector(".analysis-empty-message");e&&(e.textContent="Unable to load comparison data."),this.emptyEl.style.display=""}}}});var Eo={};j(Eo,{ProductPage:()=>Cr,initProductPages:()=>ks});function Il(r){return So[r]||So.escooter}function Ml(r){return Dl[r]||{singular:"product",plural:"products"}}function ks(){document.querySelectorAll("[data-product-page]").forEach(r=>{new Cr(r)})}var So,Dl,Cr,Lo=P(()=>{as();wo();_t();ne();So={escooter:{motor_performance:{name:"Motor",icon:"zap"},range_battery:{name:"Range & Battery",icon:"battery"},ride_quality:{name:"Ride Quality",icon:"smile"},portability:{name:"Portability",icon:"box"},safety:{name:"Safety",icon:"shield"},features:{name:"Features",icon:"settings"},maintenance:{name:"Maintenance",icon:"tool"}},ebike:{motor_drive:{name:"Motor & Drive",icon:"zap"},battery_range:{name:"Battery & Range",icon:"battery"},component_quality:{name:"Component Quality",icon:"settings"},comfort:{name:"Comfort",icon:"smile"},practicality:{name:"Practicality",icon:"box"}},hoverboard:{motor_performance:{name:"Motor",icon:"zap"},battery_range:{name:"Battery",icon:"battery"},portability:{name:"Portability",icon:"box"},ride_comfort:{name:"Ride Comfort",icon:"smile"},features:{name:"Features",icon:"settings"}},euc:{motor_performance:{name:"Motor",icon:"zap"},battery_range:{name:"Battery & Range",icon:"battery"},ride_quality:{name:"Ride Quality",icon:"smile"},safety:{name:"Safety",icon:"shield"},portability:{name:"Portability",icon:"box"},features:{name:"Features",icon:"settings"}},eskateboard:{motor_performance:{name:"Motor",icon:"zap"},battery_range:{name:"Battery & Range",icon:"battery"},ride_quality:{name:"Ride Quality",icon:"smile"},portability:{name:"Portability",icon:"box"},features:{name:"Features",icon:"settings"}}};Dl={escooter:{singular:"scooter",plural:"scooters"},ebike:{singular:"e-bike",plural:"e-bikes"},euc:{singular:"EUC",plural:"EUCs"},eskateboard:{singular:"e-skateboard",plural:"e-skateboards"},hoverboard:{singular:"hoverboard",plural:"hoverboards"}};Cr=class{constructor(e){this.container=e,this.productId=parseInt(e.dataset.productId,10),this.category=e.dataset.category||"escooter",this.radarChart=null,this.productAnalysis=null,this.carousel=null,this.radarContainer=e.querySelector("[data-radar-chart]"),this.radarSkeleton=e.querySelector("[data-radar-skeleton]"),this.radarContent=e.querySelector("[data-radar-content]"),this.init()}async init(){this.trackProductView(),this.initSimilarCarousel(),await this.initPerformanceSection()}trackProductView(){if(!this.productId||typeof this.productId!="number")return;let e=`erh_viewed_${this.productId}`;try{if(sessionStorage.getItem(e))return}catch{}let{restUrl:t,nonce:s}=window.erhData||{};t&&fetch(`${t}products/${this.productId}/view`,{method:"POST",headers:{"Content-Type":"application/json","X-WP-Nonce":s}}).then(i=>{if(i.ok)try{sessionStorage.setItem(e,"1")}catch{}}).catch(()=>{})}async initPerformanceSection(){try{let t=(await z()).geo,s=await this.fetchAnalysis(t);this.initRadarChart(s),this.initProductAnalysis(s)}catch(e){console.error("[ProductPage] Failed to load analysis:",e),this.hideRadarSection(),this.showAnalysisError()}}initRadarChart(e){!this.radarContainer||!this.radarContent||(e?.product?.scores&&Object.keys(e.product.scores).length>0?this.renderRadarChart(e):this.hideRadarSection())}async fetchAnalysis(e){let{restUrl:t,nonce:s}=window.erhData||{};if(!t||!this.productId)throw new Error("Missing required data");let i=`${t}products/${this.productId}/analysis?geo=${e}`,n=await fetch(i,{headers:{"X-WP-Nonce":s}});if(!n.ok)throw new Error(`API error: ${n.status}`);return n.json()}renderRadarChart(e){let{product:t,bracket_scores:s,price_context:i}=e,n=Il(this.category),o=Object.entries(n).filter(([l])=>t.scores[l]!==void 0).map(([l,h])=>({key:l,name:h.name}));if(o.length===0){this.hideRadarSection();return}let a=[],c=[];if(s&&Object.keys(s).length>0){let l=i?.bracket,h=Ml(this.category),u=l?`${l.label} ${h.plural} ($${l.min.toLocaleString()}\u2013$${l.max>=2147483647?"+":l.max.toLocaleString()})`:"Bracket average";a.push({id:"bracket-avg",name:u,scores:s}),c.push("var(--color-muted)")}a.push({id:t.id,name:t.name,scores:t.scores}),c.push("var(--color-primary)"),this.radarChart=new ft(this.radarContent,{size:300,maxValue:100,fillOpacity:.12,strokeWidth:2,colors:c}),this.radarChart.setData(a,o);let d=this.radarContent.querySelector(".radar-chart-legend");d&&d.classList.add("radar-chart-legend--static"),this.showRadarContent()}showRadarContent(){this.radarSkeleton&&(this.radarSkeleton.style.display="none"),this.radarContent&&(this.radarContent.style.display="")}hideRadarSection(){this.radarSkeleton&&(this.radarSkeleton.style.display="none")}initProductAnalysis(e){let t=this.container.querySelector("[data-product-analysis]");t&&(this.productAnalysis=new kr(t,{productId:this.productId,category:this.category,data:e}))}showAnalysisError(){let e=this.container.querySelector("[data-product-analysis]");if(!e)return;let t=e.querySelector("[data-analysis-skeleton]"),s=e.querySelector("[data-analysis-empty]");if(t&&(t.style.display="none"),s){let i=s.querySelector(".analysis-empty-message");i&&(i.textContent="Unable to load comparison data."),s.style.display=""}}initSimilarCarousel(){let e=this.container.querySelector("[data-similar-carousel]");if(!e)return;let t=e.querySelector(".similar-carousel"),s=e.querySelector(".similar-grid"),i=e.querySelector(".carousel-arrow-left"),n=e.querySelector(".carousel-arrow-right");!t||!s||!i||!n||(this.carousel=Ge(t,{grid:s,leftArrow:i,rightArrow:n,scrollAmount:420}))}destroy(){this.radarChart&&(this.radarChart.destroy(),this.radarChart=null),this.productAnalysis&&(this.productAnalysis=null),this.carousel&&(this.carousel.destroy(),this.carousel=null)}};document.readyState==="loading"?document.addEventListener("DOMContentLoaded",ks):ks()});function xo(r,e={}){let{template:t,variant:s="default",onTrackClick:i}=e;if(!t)return console.error("[ProductCard] No template provided"),null;let n=t.content.cloneNode(!0),o=n.querySelector("a, .product-card, .deal-card, .similar-card");if(!o)return console.error("[ProductCard] No card element found in template"),null;r.url&&(o.href=r.url),r.category&&(o.dataset.category=r.category),r.id&&(o.dataset.productId=r.id);let a=n.querySelector("img");a&&r.thumbnail&&(a.src=r.thumbnail,a.alt=r.name||"",a.onerror=()=>{a.src='data:image/svg+xml,%3Csvg xmlns="http://www.w3.org/2000/svg" width="80" height="80"%3E%3Crect fill="%23f0f0f0" width="80" height="80"/%3E%3C/svg%3E'});let c=n.querySelector(".deal-card-title, .similar-card-name, [data-card-name]");c&&(c.textContent=r.name||"");let d=n.querySelector(".similar-card-specs, [data-card-specs]");d&&r.specs_line&&(d.textContent=r.specs_line);let l=n.querySelector(".deal-price-value, .similar-card-price, [data-card-price]"),h=n.querySelector(".deal-price-currency, [data-card-currency]");if(l&&r.price>0){let m=$e(r.currency||"USD"),g=r.price.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2});h?(h.textContent=m,l.textContent=g):l.textContent=`${m}${g}`}let u=n.querySelector(".similar-card-indicator, .deal-trend, [data-card-indicator]");if(u&&r.price_indicator!==null&&r.price_indicator!==void 0){let m=r.price_indicator;m<-5?(u.classList.add("similar-card-indicator--below"),u.innerHTML=`
                <svg class="icon" aria-hidden="true"><use href="#icon-arrow-down"></use></svg>
                ${Math.abs(m)}%
            `,u.style.display=""):m>10?(u.classList.add("similar-card-indicator--above"),u.innerHTML=`
                <svg class="icon" aria-hidden="true"><use href="#icon-arrow-up"></use></svg>
                ${m}%
            `,u.style.display=""):u.style.display="none"}let p=n.querySelector(".deal-discount-text, [data-card-discount]");p&&r.discount_percent&&(p.textContent=`${Math.round(r.discount_percent)}% below avg`);let f=n.querySelector("[data-track-price]");return f&&(r.price?(f.dataset.trackPrice=r.id,f.dataset.productName=r.name||"",f.dataset.productImage=r.thumbnail||"",f.dataset.currentPrice=r.price,f.dataset.currency=r.currency||"USD",i&&f.addEventListener("click",m=>{m.preventDefault(),m.stopPropagation(),i(r,f)})):f.style.display="none"),n}var ko=P(()=>{fe();ne()});var $o={};j($o,{default:()=>_l,initSimilarProducts:()=>Co});function mt(r,e=null){if(!Fl)return;let t="[SimilarProducts]";e?console.log(t,r,e):console.log(t,r)}async function Co(r=null){let e=r||document.querySelector("[data-similar-products]");if(!e)return null;let t=e.dataset.productId,s=parseInt(e.dataset.limit,10)||10,i=e.querySelector(".similar-grid, [data-similar-grid]"),n=document.getElementById("similar-card-template"),o=e.querySelector(".similar-empty, [data-similar-empty]"),a=e.querySelector(".similar-carousel"),c=e.querySelector(".carousel-arrow-left"),d=e.querySelector(".carousel-arrow-right");if(!i||!n||!t)return console.warn("[SimilarProducts] Missing required elements",{grid:i,template:n,productId:t}),null;let l=[],h={geo:"US",currency:"USD"},u=null;mt("Initializing",{productId:t,limit:s});try{h=await z(),mt("Got user geo",{geo:h.geo,currency:h.currency,country:h.country})}catch(y){mt("Geo detection failed, using defaults",{error:y.message})}let p=`${te()}products/${t}/similar?limit=${s}&geo=${h.geo}`;mt("Fetching similar products",{url:p});try{let y=await fetch(p);if(!y.ok)throw new Error(`HTTP ${y.status}`);let v=await y.json();l=v.products||[];let w=l.filter(k=>k.price).length,b=l.filter(k=>k.tracked_url).length;mt("Products loaded",{count:l.length,withPrice:w,withTrackedUrl:b,geo:v.geo})}catch(y){return console.error("[SimilarProducts] Failed to load:",y),mt("Failed to load products",{error:y.message}),m(),null}f(l),c&&d&&a&&(u=Ge(a,{grid:i,leftArrow:c,rightArrow:d,scrollAmount:432,threshold:5}));function f(y){if(i.innerHTML="",y.length===0){m();return}g(),y.forEach(v=>{let w=xo(v,{template:n});w&&i.appendChild(w)}),u&&u.update()}function m(){i.innerHTML="",o&&(o.style.display=""),e.style.display="none"}function g(){o&&(o.style.display="none"),e.style.display=""}return{async refresh(y){let v=y||h.geo;try{l=(await(await fetch(`${te()}products/${t}/similar?limit=${s}&geo=${v}`)).json()).products||[],f(l)}catch(w){console.error("[SimilarProducts] Refresh failed:",w)}},getProducts(){return l},destroy(){u&&u.destroy()}}}var Fl,_l,Ao=P(()=>{ne();ko();_t();xe();Fl=localStorage.getItem("erh_geo_debug")==="true"||new URLSearchParams(window.location.search).has("geo_debug");_l={initSimilarProducts:Co}});var To={};j(To,{default:()=>Bl,initListicleItems:()=>qo});function qo(){document.querySelectorAll("[data-listicle-item]").forEach(e=>new Cs(e))}var $r,Cs,Bl,Po=P(()=>{ne();ir();_e();er();At();zr();fe();$r={"3m":"3-month","6m":"6-month","1y":"12-month",all:"All-time"};Cs=class{constructor(e){this.el=e,this.config=JSON.parse(e.dataset.listicleItem||"{}"),this.productId=this.config.productId,this.categoryKey=this.config.categoryKey||"escooter",this.hasPricing=this.config.hasPricing,this.userGeo=null,this.priceData=null,this.filteredOffers=null,this.specsLoaded=!1,this.pricingLoaded=!1,this.currentPeriod="6m",this.chart=null,this.tabs=e.querySelectorAll(".listicle-item-tab"),this.panels=e.querySelectorAll(".listicle-item-panel"),this.init()}async init(){this.setupTabNavigation(),this.setupPriceAlertButtons(),this.setupVideoLightbox(),this.hasPricing&&(this.userGeo=await z(),await this.hydratePriceBar())}setupTabNavigation(){this.tabs.forEach(e=>{e.addEventListener("click",()=>this.switchTab(e.dataset.tab)),e.addEventListener("keydown",t=>{let s=Array.from(this.tabs),i=s.indexOf(e);if(t.key==="ArrowLeft"){t.preventDefault();let n=i>0?i-1:s.length-1;s[n].focus(),this.switchTab(s[n].dataset.tab)}else if(t.key==="ArrowRight"){t.preventDefault();let n=i<s.length-1?i+1:0;s[n].focus(),this.switchTab(s[n].dataset.tab)}else t.key==="Home"?(t.preventDefault(),s[0].focus(),this.switchTab(s[0].dataset.tab)):t.key==="End"&&(t.preventDefault(),s[s.length-1].focus(),this.switchTab(s[s.length-1].dataset.tab))})})}async switchTab(e){this.tabs.forEach(t=>{let s=t.dataset.tab===e;t.classList.toggle("is-active",s),t.setAttribute("aria-selected",s?"true":"false"),t.setAttribute("tabindex",s?"0":"-1")}),this.panels.forEach(t=>{let s=t.dataset.panel===e;t.classList.toggle("is-active",s),t.hidden=!s}),e==="specs"&&!this.specsLoaded?await this.loadSpecsTab():e==="pricing"&&!this.pricingLoaded&&this.hasPricing&&await this.loadPricingTab()}async loadSpecsTab(){let e=this.el.querySelector('[data-panel="specs"]'),t=e.querySelector("[data-loader]"),s=e.querySelector("[data-specs-content]");if(s)try{let i=await fetch(`${window.erhData.restUrl}listicle/specs`,{method:"POST",headers:{"Content-Type":"application/json","X-WP-Nonce":window.erhData.nonce},body:JSON.stringify({product_id:this.productId,category_key:this.categoryKey})});if(!i.ok)throw new Error(`HTTP ${i.status}`);let n=await i.json();t&&(t.style.display="none"),s.innerHTML=n.html,this.setupSpecsAccordion(s),kt(),this.specsLoaded=!0}catch(i){console.error("[ListicleItem] Failed to load specs:",i),t&&(t.style.display="none"),s.innerHTML='<p class="listicle-item-error">Failed to load specifications.</p>'}}setupSpecsAccordion(e){let t=e.querySelector("[data-specs-accordion]");t&&t.addEventListener("click",s=>{let i=s.target.closest(".listicle-specs-group-header");if(!i)return;let n=i.closest(".listicle-specs-group"),o=n.querySelector(".listicle-specs-group-content"),a=n.classList.contains("is-open");n.classList.toggle("is-open",!a),i.setAttribute("aria-expanded",!a),o.hidden=a})}async hydratePriceBar(){let e=this.el.querySelector("[data-price-bar]");if(!(!e||!this.userGeo))try{let t=await Fe(this.productId,this.userGeo.geo);if(!t||!t.offers||t.offers.length===0)throw new Error("No pricing data");this.priceData=t;let s=Xe(t.offers,this.userGeo);if(s.length===0)throw new Error("No offers for region");this.filteredOffers=s;let i=s[0],n=i.currency||this.userGeo.currency;this.currentPrice=i.price,this.currentCurrency=n;let o="",a=t.history?.statistics?.average,c=dt(i.price,a);if(c&&c.shouldShow){let u=c.type==="below"?"arrow-down":"arrow-up";o=`<span class="listicle-item-verdict listicle-item-verdict--${c.type==="below"?"good":"high"}">
                    <svg class="icon" aria-hidden="true"><use href="#icon-${u}"></use></svg>
                    ${c.text}
                </span>`}let d=i.logo_url?`<span class="listicle-item-retailer-logo"><img src="${i.logo_url}" alt="${i.retailer}"></span>`:`<span class="listicle-item-retailer-name-text">${i.retailer}</span>`,l=e.querySelector("[data-best-price]");l&&(l.innerHTML=`
                    <a href="${se(i.tracked_url||i.url)}" class="listicle-item-price-link" target="_blank" rel="sponsored noopener">
                        <span class="listicle-item-price-amount">${_(i.price,n)}</span>
                        <span class="listicle-item-price-at">at</span>
                        ${d}
                    </a>
                    ${o}
                `);let h=e.querySelector("[data-buy-btn]");if(h){h.href=se(i.tracked_url||i.url);let u=h.querySelector("[data-buy-text]"),p=h.querySelector("[data-buy-icon]"),f=h.querySelector("[data-buy-spinner]");u&&(u.style.display=""),p&&(p.style.display=""),f&&(f.style.display="none")}}catch(t){console.error("[ListicleItem] Failed to hydrate price bar:",t),e.style.display="none";let s=this.el.querySelector(".listicle-item-track-btn");s&&(s.style.display="none")}}async loadPricingTab(){let e=this.el.querySelector('[data-panel="pricing"]'),t=e.querySelector("[data-loader]"),s=e.querySelector("[data-pricing-content]");if(!(!s||!this.userGeo))try{if(!this.priceData){let i=await Fe(this.productId,this.userGeo.geo);if(!i||!i.offers||i.offers.length===0)throw new Error("No pricing data");this.priceData=i,this.filteredOffers=Xe(i.offers,this.userGeo)}if(!this.filteredOffers||this.filteredOffers.length===0)throw new Error("No offers for region");t&&(t.style.display="none"),s.innerHTML=this.renderPricingTabContent(this.filteredOffers,this.priceData),this.setupPricingInteractions(s,this.priceData),this.pricingLoaded=!0}catch(i){console.error("[ListicleItem] Failed to load pricing:",i),t&&(t.style.display="none"),s.innerHTML=this.renderNoPricing()}}renderPricingTabContent(e,t){let i=e[0].currency||this.userGeo.currency,n=e.map((c,d)=>{let l=d===0,h=l?"listicle-item-retailer-row listicle-item-retailer-row--best":"listicle-item-retailer-row",u=c.logo_url?`<div class="listicle-item-retailer-logo-wrap"><img src="${c.logo_url}" alt="${c.retailer}"></div>`:`<span class="listicle-item-retailer-logo-text">${c.retailer}</span>`,p=c.in_stock?"check":"x",f=c.in_stock?"":"listicle-item-retailer-stock--out",m=c.in_stock?"In Stock":"Out of Stock",g=l?'<span class="listicle-item-retailer-badge">Best price</span>':"";return`
                <a href="${se(c.tracked_url||c.url)}" class="${h}" target="_blank" rel="sponsored noopener">
                    ${u}
                    <div class="listicle-item-retailer-info">
                        <span class="listicle-item-retailer-name">${c.retailer}</span>
                        <span class="listicle-item-retailer-stock ${f}">
                            <svg class="icon" aria-hidden="true"><use href="#icon-${p}"></use></svg>
                            ${m}
                        </span>
                    </div>
                    <div class="listicle-item-retailer-price-wrap">
                        <span class="listicle-item-retailer-price">${_(c.price,i)}</span>
                        ${g}
                    </div>
                    <svg class="icon listicle-item-retailer-arrow" aria-hidden="true"><use href="#icon-chevron-right"></use></svg>
                </a>
            `}).join(""),o=t.history?.data?.length>0&&!t.history?.used_fallback,a="";if(o){let c=t.history.statistics||{},d=c.average?_(c.average,i):"\u2014",l=c.lowest?_(c.lowest,i):"\u2014",h=c.lowest_date||"";a=`
                <div class="listicle-item-history">
                    <div class="listicle-item-history-header">
                        <span class="listicle-item-history-title">Price history</span>
                        <div class="listicle-item-chart-periods" data-period-buttons>
                            <button type="button" data-period="3m">3M</button>
                            <button type="button" data-period="6m" class="is-active">6M</button>
                            <button type="button" data-period="1y">1Y</button>
                            <button type="button" data-period="all">All</button>
                        </div>
                    </div>
                    <div class="listicle-item-chart-visual" data-chart></div>
                    <div class="listicle-item-stats">
                        <div class="listicle-item-stat">
                            <span class="listicle-item-stat-label" data-period-label>6-month avg</span>
                            <span class="listicle-item-stat-value" data-period-avg>${d}</span>
                        </div>
                        <div class="listicle-item-stat">
                            <span class="listicle-item-stat-label" data-period-low-label>6-month low</span>
                            <span class="listicle-item-stat-value listicle-item-stat-value--low" data-period-low>${l}</span>
                            <span class="listicle-item-stat-meta" data-period-low-meta>${h}</span>
                        </div>
                        <div class="listicle-item-stat listicle-item-stat--action">
                            <button type="button" class="btn btn-secondary btn-sm" data-pricing-alert>
                                <svg class="icon" aria-hidden="true"><use href="#icon-bell"></use></svg>
                                Set price alert
                            </button>
                        </div>
                    </div>
                </div>
            `}return`
            <div class="listicle-item-retailers">
                <div class="listicle-item-retailers-header">
                    <span class="listicle-item-retailers-title">Compare prices</span>
                </div>
                <div class="listicle-item-retailer-list">
                    ${n}
                </div>
                <p class="listicle-item-disclosure">We may earn a commission from purchases.</p>
            </div>
            ${a}
        `}renderNoPricing(){return`
            <div class="listicle-item-no-pricing">
                <svg class="icon"><use href="#icon-tag"></use></svg>
                <p>No pricing data available for your region.</p>
            </div>
        `}setupPricingInteractions(e,t){let s=e.querySelector("[data-chart]");s&&t.history?.data?.length>0&&this.initChart(s,t.history);let i=e.querySelector("[data-period-buttons]");i&&i.addEventListener("click",o=>{let a=o.target.closest("[data-period]");if(!a)return;let c=a.dataset.period;this.changePeriod(c,e,t),i.querySelectorAll("button").forEach(d=>{d.classList.toggle("is-active",d===a)})}),e.querySelectorAll("[data-pricing-alert]").forEach(o=>{o.addEventListener("click",()=>{this.openPriceAlert()})})}initChart(e,t){let s=this.userGeo?.currency||"USD";this.chart=Ze(e,{height:180,type:"line",showArea:!0,showXAxis:!0,showYAxis:!0,yAxisInside:!0,currency:s});let i=this.getChartDataForPeriod("6m",t.data);i&&this.chart.setData(i)}getChartDataForPeriod(e,t){if(!t||!t.length)return null;let s=new Date,n={"3m":90,"6m":180,"1y":365,all:1/0}[e]||180,o=n===1/0?new Date(0):new Date(s-n*24*60*60*1e3),a=t.filter(c=>new Date(c.x||c.date)>=o);return a.length===0?null:{dates:a.map(c=>this.formatChartDate(c.x||c.date)),values:a.map(c=>c.y),stores:a.map(c=>c.domain||""),raw:a}}formatChartDate(e){return e?new Date(e).toLocaleDateString("en-US",{month:"short",day:"numeric"}):""}changePeriod(e,t,s){this.currentPeriod=e;let i=s.history?.data?this.getChartDataForPeriod(e,s.history.data):null;this.chart&&i&&this.chart.setData(i);let n=this.userGeo?.currency||"USD",o=t.querySelector("[data-period-label]"),a=t.querySelector("[data-period-avg]"),c=t.querySelector("[data-period-low-label]"),d=t.querySelector("[data-period-low]"),l=t.querySelector("[data-period-low-meta]");if(i&&i.values.length>0){let h=i.values,u=h.reduce((m,g)=>m+g,0)/h.length,p=Math.min(...h),f=h.indexOf(p);if(o&&(o.textContent=`${$r[e]} avg`),a&&(a.textContent=_(u,n)),c&&(c.textContent=`${$r[e]} low`),d&&(d.textContent=_(p,n)),l){let m=i.stores?.[f]||"",g=i.dates?.[f]||"";l.textContent=m?`${g} \xB7 ${m}`:g}}else o&&(o.textContent=`${$r[e]} avg`),a&&(a.textContent="\u2014"),c&&(c.textContent=`${$r[e]} low`),d&&(d.textContent="\u2014"),l&&(l.textContent="")}setupPriceAlertButtons(){let e=this.el.querySelector(".listicle-item-track-btn");e&&e.addEventListener("click",t=>{t.preventDefault(),this.openPriceAlert()})}openPriceAlert(){let e=this.config.productName||this.el.querySelector(".listicle-item-title")?.textContent||"",t=this.priceData?.product_image||"";oe.open({productId:this.productId,productName:e,productImage:t,currentPrice:this.currentPrice||0,currency:this.currentCurrency||this.userGeo?.currency||"USD"})}setupVideoLightbox(){let e=this.el.querySelector(".listicle-item-video-card");e&&e.addEventListener("click",()=>{let t=e.dataset.video;t&&sr.open(t)})}},Bl={init:qo}});var Io={};j(Io,{default:()=>Ol,initBuyingGuideTables:()=>Nl});function Nl(){document.querySelectorAll("[data-buying-guide-table]").forEach(e=>new Ar(e))}var Ar,Ol,Do=P(()=>{ne();fe();Ar=class{constructor(e){this.el=e,this.config=JSON.parse(e.dataset.buyingGuideTable||"{}"),this.productIds=this.config.productIds||[],this.priceCellMap=new Map,e.querySelectorAll(".bgt-col-price[data-product-id]").forEach(t=>{this.priceCellMap.set(t.dataset.productId,t)}),!(this.productIds.length===0||this.priceCellMap.size===0)&&this.init()}async init(){try{let e=await z();await this.hydratePrices(e)}catch(e){console.error("[BuyingGuideTable] Init error:",e),this.showPriceErrors()}}async hydratePrices(e){let{geo:t,symbol:s}=e,i=this.productIds.map(async o=>{try{let a=await Fe(o,t);return{productId:o,priceData:a,error:null}}catch(a){return{productId:o,priceData:null,error:a}}});(await Promise.all(i)).forEach(({productId:o,priceData:a,error:c})=>{let d=this.priceCellMap.get(String(o));if(d){if(c||!a){this.renderPriceError(d);return}this.renderPrice(d,a,s)}})}renderPrice(e,t,s){let i=t.offers||[];if(i.length===0){e.innerHTML='<span class="bgt-na">&mdash;</span>';return}let n=i.find(c=>c.in_stock)||i[0];if(!n||!n.price){e.innerHTML='<span class="bgt-na">&mdash;</span>';return}let o=_(n.price,s),a=se(n.tracked_url||n.url);e.innerHTML=`
            <a href="${a}" class="bgt-price-btn" target="_blank" rel="sponsored noopener">
                ${o}
                <svg class="icon" aria-hidden="true"><use href="#icon-external-link"></use></svg>
            </a>
        `}renderPriceError(e){e.innerHTML='<span class="bgt-na">&mdash;</span>'}showPriceErrors(){this.priceCellMap.forEach(e=>this.renderPriceError(e))}},Ol=Ar});var Mo={};j(Mo,{initAccountTabs:()=>$s});function $s(){let r=document.querySelectorAll("[data-account-nav]"),e=document.querySelectorAll("[data-account-tab]");if(!r.length||!e.length)return;function t(i){r.forEach(n=>{let o=n.dataset.accountNav===i;n.classList.toggle("is-active",o)}),e.forEach(n=>{let o=n.dataset.accountTab===i;n.hidden=!o})}function s(){let i=window.location.hash.slice(1);return[...e].map(o=>o.dataset.accountTab).includes(i)?i:"trackers"}r.forEach(i=>{i.addEventListener("click",n=>{n.preventDefault();let o=i.dataset.accountNav;history.pushState(null,"",`#${o}`),t(o)})}),window.addEventListener("hashchange",()=>{t(s())}),t(s())}var Fo=P(()=>{document.querySelector(".account-page")&&(document.readyState==="loading"?document.addEventListener("DOMContentLoaded",$s):$s())});var Oo={};j(Oo,{initAccountSettings:()=>As});function As(){Ul(),Rl(),Hl(),Gl(),zl(),Yl(),Xl(),Vl()}function Ul(){document.querySelectorAll("[data-toggle-password]").forEach(e=>{e.addEventListener("click",()=>{let s=e.closest(".password-input-wrapper")?.querySelector("input");if(!s)return;let i=s.type==="text";s.type=i?"password":"text",e.classList.toggle("is-visible",!i),e.setAttribute("aria-label",i?"Show password":"Hide password")})})}function Rl(){let r=document.querySelector("[data-email-form]");if(!r)return;let e=r.querySelector("[data-email-error]"),t=r.querySelector("[data-email-submit]");r.addEventListener("submit",async s=>{s.preventDefault(),qr(e),je(t,!0);let i=new FormData(r),n={new_email:i.get("new_email"),current_password:i.get("current_password")};try{let o=await fetch(`${We()}/user/email`,{method:"PUT",headers:{"Content-Type":"application/json","X-WP-Nonce":ze()},credentials:"same-origin",body:JSON.stringify(n)}),a=await o.json();if(!o.ok)throw new Error(a.message||"Failed to update email");Z.success("Email updated successfully"),r.reset();let c=document.querySelector(".settings-current-value");c&&(c.textContent=n.new_email)}catch(o){gt(e,o.message)}finally{je(t,!1)}})}function Hl(){let r=document.querySelector("[data-password-form]");if(!r)return;let e=r.querySelector("[data-password-error]"),t=r.querySelector("[data-password-submit]");r.addEventListener("submit",async s=>{s.preventDefault(),qr(e);let i=new FormData(r),n=i.get("current_password"),o=i.get("new_password"),a=i.get("confirm_password");if(o!==a){gt(e,"New passwords do not match");return}if(o.length<8){gt(e,"Password must be at least 8 characters");return}je(t,!0);try{let c=await fetch(`${We()}/user/password`,{method:"PUT",headers:{"Content-Type":"application/json","X-WP-Nonce":ze()},credentials:"same-origin",body:JSON.stringify({current_password:n,new_password:o})}),d=await c.json();if(!c.ok)throw new Error(d.message||"Failed to update password");Z.success("Password updated successfully"),r.reset()}catch(c){gt(e,c.message)}finally{je(t,!1)}})}function Gl(){let r=document.querySelector("[data-geo-form]"),e=r?.querySelector("[data-geo-select]");if(!r||!e)return;let t=r.querySelector("[data-geo-error]"),s=r.querySelector("[data-geo-submit]"),i=window.erhData?.user?.geo||"US";e.value=i,e.dispatchEvent(new Event("change",{bubbles:!0})),r.addEventListener("submit",async n=>{n.preventDefault(),qr(t),je(s,!0);let o=e.value;try{if((await Qt(o)).success)Z.success("Region updated successfully");else throw new Error("Failed to update region")}catch(a){gt(t,a.message)}finally{je(s,!1)}})}async function Vl(){let r=document.querySelector("[data-preferences-form]");if(r)try{let e=await fetch(`${We()}/user/preferences`,{headers:{"X-WP-Nonce":ze()},credentials:"same-origin"});if(!e.ok)return;let t=await e.json(),s=t.preferences||t,i=r.querySelector('input[data-preference="price_trackers_emails"]'),n=r.querySelector('input[data-preference="sales_roundup_emails"]'),o=r.querySelector('input[data-preference="newsletter_subscription"]'),a=r.querySelector('select[data-preference="sales_roundup_frequency"]');i&&(i.checked=s.price_tracker_emails??!0),n&&(n.checked=s.sales_roundup_emails??!0),o&&(o.checked=s.newsletter_subscription??!1),a&&(a.value=s.sales_roundup_frequency||"weekly",a.dispatchEvent(new Event("change",{bubbles:!0})));let c=r.querySelectorAll("input[data-roundup-type]"),d=s.sales_roundup_types||[];c.forEach(l=>{l.checked=d.includes(l.value)}),Bo(n?.checked)}catch(e){console.error("Failed to load preferences:",e)}}async function jl(){try{let r=await fetch(`${We()}/user/trackers`,{headers:{"X-WP-Nonce":ze()},credentials:"same-origin"});return r.ok&&(await r.json()).trackers?.length||0}catch{return 0}}function Wl(r,e){if(document.querySelector("[data-tracker-warning]")?.remove(),!r.checked&&e>0){let t=document.createElement("div");t.className="settings-inline-warning",t.setAttribute("data-tracker-warning",""),t.innerHTML=`
            <svg class="settings-warning-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"></path>
                <line x1="12" y1="9" x2="12" y2="13"></line>
                <line x1="12" y1="17" x2="12.01" y2="17"></line>
            </svg>
            <span>
                You have <strong>${e} active tracker${e>1?"s":""}</strong>.
                Disabling emails means you won't be notified when prices drop.
                Your trackers will remain visible in your account.
            </span>
        `;let s=r.closest(".settings-preference");s&&s.after(t)}}function zl(){let r=document.querySelector("[data-preferences-form]");if(!r)return;let e=r.querySelector("[data-preferences-error]"),t=r.querySelector("[data-preferences-submit]"),s=r.querySelector('input[data-preference="sales_roundup_emails"]'),i=r.querySelector("[data-roundup-wrapper]"),n=r.querySelector('input[data-preference="price_trackers_emails"]'),o=0;jl().then(a=>{o=a}),s&&i&&s.addEventListener("change",()=>{Bo(s.checked)}),n&&n.addEventListener("change",()=>{Wl(n,o)}),r.addEventListener("submit",async a=>{a.preventDefault(),qr(e),je(t,!0);let c=new FormData(r),d=[];r.querySelectorAll("input[data-roundup-type]:checked").forEach(l=>{d.push(l.value)});try{let l=await fetch(`${We()}/user/preferences`,{method:"PUT",headers:{"Content-Type":"application/json","X-WP-Nonce":ze()},credentials:"same-origin",body:JSON.stringify({price_tracker_emails:c.get("price_trackers_emails")==="on",sales_roundup_emails:c.get("sales_roundup_emails")==="on",sales_roundup_frequency:c.get("sales_roundup_frequency"),sales_roundup_types:d,newsletter_subscription:c.get("newsletter_subscription")==="on"})}),h=await l.json();if(!l.ok)throw new Error(h.message||"Failed to save preferences");Z.success("Preferences saved")}catch(l){gt(e,l.message)}finally{je(t,!1)}})}function Bo(r){let e=document.querySelector("[data-roundup-wrapper]");e&&(e.style.display=r?"":"none")}function Yl(){let r=document.querySelector("[data-connected-accounts]");r&&No(r)}async function No(r){let e=[{key:"google",name:"Google",icon:"google"},{key:"facebook",name:"Facebook",icon:"facebook"},{key:"reddit",name:"Reddit",icon:"reddit"}];try{let t=await fetch(`${We()}/user/profile`,{headers:{"X-WP-Nonce":ze()},credentials:"same-origin"});if(!t.ok)throw new Error("Failed to load profile");let i=(await t.json()).profile?.linked_providers||[],n=e.filter(o=>i.includes(o.key));if(n.length===0){r.innerHTML='<p class="connected-accounts-empty">No social accounts connected.</p>';return}r.innerHTML=n.map(o=>`
            <div class="connected-account" data-provider="${o.key}">
                <div class="connected-account-info">
                    <svg class="connected-account-icon" width="20" height="20">
                        <use href="#icon-${o.icon}"></use>
                    </svg>
                    <span class="connected-account-name">${o.name}</span>
                    <span class="connected-account-status">Connected</span>
                </div>
                <button
                    type="button"
                    class="btn btn-sm btn-outline connected-account-disconnect"
                    data-disconnect="${o.key}"
                >
                    Disconnect
                </button>
            </div>
        `).join(""),r.querySelectorAll("[data-disconnect]").forEach(o=>{o.addEventListener("click",()=>Kl(o,r))})}catch(t){console.error("Failed to load connected accounts:",t),r.innerHTML='<p class="connected-accounts-error">Failed to load connected accounts.</p>'}}async function Kl(r,e){let t=r.dataset.disconnect,s=t.charAt(0).toUpperCase()+t.slice(1);if(confirm(`Are you sure you want to disconnect your ${s} account?`)){r.disabled=!0,r.textContent="Disconnecting...";try{let i=await fetch(`${We()}/user/unlink-social`,{method:"POST",headers:{"Content-Type":"application/json","X-WP-Nonce":ze()},credentials:"same-origin",body:JSON.stringify({provider:t})}),n=await i.json();if(!i.ok)throw new Error(n.message||"Failed to disconnect");Z.success(n.message||`${s} account disconnected.`),No(e)}catch(i){Z.error(i.message),r.disabled=!1,r.textContent="Disconnect"}}}function Xl(){let r=document.querySelector("[data-account-logout]");r&&r.addEventListener("click",async()=>{r.disabled=!0;try{let e=await fetch(`${We()}/auth/logout`,{method:"POST",headers:{"X-WP-Nonce":ze()},credentials:"same-origin"});window.location.href=_o()}catch{window.location.href=_o()}})}function gt(r,e){r&&(r.textContent=e,r.hidden=!1)}function qr(r){r&&(r.textContent="",r.hidden=!0)}function je(r,e){r&&(r.disabled=e,r.classList.toggle("is-loading",e))}var We,ze,_o,Uo=P(()=>{Ie();ne();xe();We=()=>te().replace(/\/$/,""),ze=()=>window.erhData?.nonce||"",_o=()=>window.erhData?.siteUrl||"/";document.querySelector("[data-settings]")&&(document.readyState==="loading"?document.addEventListener("DOMContentLoaded",As):As())});var jo={};j(jo,{initAccountTrackers:()=>qs});function qs(){Jl(),he.container&&(Ql(),Ts(),window.addEventListener("priceAlert:saved",id),window.addEventListener("priceAlert:deleted",nd))}function Jl(){he={container:document.querySelector("[data-trackers]"),loading:document.querySelector("[data-trackers-loading]"),tableWrapper:document.querySelector("[data-trackers-table-wrapper]"),tbody:document.querySelector("[data-trackers-body]"),empty:document.querySelector("[data-trackers-empty]"),error:document.querySelector("[data-trackers-error]"),retryBtn:document.querySelector("[data-trackers-retry]"),searchInput:document.querySelector("[data-trackers-search]"),sortBtns:document.querySelectorAll(".trackers-th[data-sort]")}}function Ql(){he.searchInput&&he.searchInput.addEventListener("input",od(r=>{Gt=r.target.value.toLowerCase().trim(),vt()},200)),he.sortBtns.forEach(r=>{r.addEventListener("click",()=>{let e=r.dataset.sort;Vt===e?Ye==="asc"?Ye="desc":Ye==="desc"&&(Vt=null,Ye="asc"):(Vt=e,Ye="asc"),Vo(),vt()})}),he.retryBtn&&he.retryBtn.addEventListener("click",Ts),document.addEventListener("click",r=>{r.target.closest(".trackers-actions")||Pr()}),he.tbody&&he.tbody.addEventListener("click",Zl)}function Zl(r){let e=r.target,t=e.closest("[data-action-toggle]");if(t){r.stopPropagation();let n=t.nextElementSibling,o=n?.classList.contains("is-open");Pr(),!o&&n&&n.classList.add("is-open");return}let s=e.closest('[data-action="edit"]');if(s){let n=s.dataset.trackerId,o=ye.find(a=>String(a.id)===n);o&&td(o);return}let i=e.closest('[data-action="delete"]');if(i){let n=i.dataset.trackerId,o=ye.find(a=>String(a.id)===n);o&&rd(o);return}}async function Ts(){yt("loading");try{let r=await fetch(`${Ho()}/user/trackers`,{headers:{"X-WP-Nonce":Go()},credentials:"same-origin"});if(!r.ok)throw new Error("Failed to load trackers");let e=await r.json();ye=Array.isArray(e)?e:e.trackers||[],ye.length===0?yt("empty"):(yt("table"),Vo(),vt())}catch(r){console.error("Error loading trackers:",r),yt("error")}}function yt(r){he.loading.hidden=r!=="loading",he.tableWrapper.hidden=r!=="table",he.empty.hidden=r!=="empty",he.error.hidden=r!=="error"}function Vo(){he.sortBtns.forEach(r=>{r.dataset.sort===Vt?r.dataset.sortActive=Ye:delete r.dataset.sortActive})}function vt(){if(!he.tbody)return;let r=ye;Gt&&(r=ye.filter(t=>t.product_name?.toLowerCase().includes(Gt)));let e=[...r].sort((t,s)=>{let i,n;switch(Vt){case"name":i=t.product_name?.toLowerCase()||"",n=s.product_name?.toLowerCase()||"";break;case"start_price":i=parseFloat(t.start_price)||0,n=parseFloat(s.start_price)||0;break;case"current_price":i=parseFloat(t.current_price)||0,n=parseFloat(s.current_price)||0;break;default:return 0}return i<n?Ye==="asc"?-1:1:i>n?Ye==="asc"?1:-1:0});e.length===0&&Gt?he.tbody.innerHTML=`
            <tr>
                <td colspan="5" class="trackers-td" style="text-align: center; padding: 40px;">
                    No trackers match "${F(Gt)}"
                </td>
            </tr>
        `:he.tbody.innerHTML=e.map(t=>ed(t)).join("")}function ed(r){let e=r.currency||"USD",t=r.geo||"US",s=Ro[t]||Ro.US,i=(window.erhData?.themeUrl||"")+"/assets/images/countries/"+s,n=r.target_price?`Price ${_(r.target_price,e)}`:`Drop ${_(r.price_drop,e)}`;return`
        <tr class="trackers-row" data-tracker-row="${r.id}">
            <td class="trackers-td trackers-td--product">
                <div class="trackers-product">
                    <img
                        src="${F(r.product_thumbnail||"/wp-content/themes/erh-theme/assets/images/placeholder.svg")}"
                        alt=""
                        class="trackers-product-image"
                        loading="lazy"
                    >
                    <div class="trackers-product-info">
                        <a href="${F(r.product_url||"#")}" class="trackers-product-name">
                            ${F(r.product_name)}
                        </a>
                        <span class="trackers-product-geo"><img src="${F(i)}" alt="" class="trackers-geo-flag"> Tracking ${F(t)} price</span>
                    </div>
                </div>
            </td>
            <td class="trackers-td trackers-td--start">
                <span class="trackers-price">${_(r.start_price,e)}</span>
            </td>
            <td class="trackers-td trackers-td--current">
                <span class="trackers-price">${_(r.current_price,e)}</span>
            </td>
            <td class="trackers-td trackers-td--tracker">
                <span class="trackers-tracker">
                    ${n}
                </span>
            </td>
            <td class="trackers-td trackers-td--actions">
                <div class="trackers-actions">
                    <button type="button" class="trackers-action-btn" data-action-toggle aria-label="Actions">
                        <svg class="icon" aria-hidden="true"><use href="#icon-more-vertical"></use></svg>
                    </button>
                    <div class="trackers-action-menu" data-action-menu>
                        <button type="button" class="trackers-action-menu-item" data-action="edit" data-tracker-id="${r.id}">
                            <svg class="icon" aria-hidden="true"><use href="#icon-edit"></use></svg>
                            Edit
                        </button>
                        <button type="button" class="trackers-action-menu-item trackers-action-menu-item--danger" data-action="delete" data-tracker-id="${r.id}">
                            <svg class="icon" aria-hidden="true"><use href="#icon-trash"></use></svg>
                            Delete
                        </button>
                    </div>
                </div>
            </td>
        </tr>
    `}function Pr(){document.querySelectorAll("[data-action-menu].is-open").forEach(r=>{r.classList.remove("is-open")})}function td(r){Pr(),oe.open({productId:parseInt(r.product_id,10),productName:r.product_name,productImage:r.product_thumbnail,currentPrice:parseFloat(r.live_price||r.current_price),currency:r.currency||"USD"})}function rd(r){Pr(),Tr=r.id,Me&&(Me.destroy(!0),Me=null),Me=le.create({id:"delete-tracker-confirm",title:"Delete price alert?",content:`
            <p class="modal-text">
                Are you sure you want to delete the price alert for <strong>${F(r.product_name)}</strong>?
                You won't receive any more notifications for this product.
            </p>
        `,size:"sm",footerContent:`
            <button type="button" class="btn btn-secondary" data-modal-close>Cancel</button>
            <button type="button" class="btn btn-danger" data-confirm-delete>
                <span class="btn-text">Delete</span>
                <span class="btn-loading" hidden>
                    <svg class="spinner" viewBox="0 0 24 24" width="20" height="20">
                        <circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="3" fill="none" stroke-dasharray="31.4" stroke-linecap="round"/>
                    </svg>
                </span>
            </button>
        `,afterClose:()=>{Me&&(Me.destroy(!0),Me=null),Tr=null}});let e=Me.element.querySelector("[data-confirm-delete]");e&&e.addEventListener("click",sd)}async function sd(){if(!Tr)return;let r=Tr,e=Me?.element.querySelector("[data-confirm-delete]"),t=e?.querySelector(".btn-text"),s=e?.querySelector(".btn-loading");e&&(e.disabled=!0,e.classList.add("is-loading"),t&&(t.style.visibility="hidden"),s&&(s.hidden=!1));try{let i=await fetch(`${Ho()}/user/trackers/${r}`,{method:"DELETE",headers:{"X-WP-Nonce":Go()},credentials:"same-origin"});if(!i.ok){let n=await i.json();throw new Error(n.message||"Failed to delete tracker")}ye=ye.filter(n=>String(n.id)!==String(r)),Me?.close(),ye.length===0?yt("empty"):vt(),Z.success("Price alert deleted")}catch(i){Z.error(i.message),e&&(e.disabled=!1,e.classList.remove("is-loading"),t&&(t.style.visibility=""),s&&(s.hidden=!0))}}function id(r){let{productId:e,tracker:t}=r.detail||{};if(!e)return;let s=ye.findIndex(i=>String(i.product_id)===String(e));s!==-1&&t?(ye[s]={...ye[s],...t},vt()):Ts()}function nd(r){let{productId:e}=r.detail||{};e&&(ye=ye.filter(t=>String(t.product_id)!==String(e)),ye.length===0?yt("empty"):vt())}function od(r,e){let t;return(...s)=>{clearTimeout(t),t=setTimeout(()=>r(...s),e)}}var Ho,Go,Ro,ye,Vt,Ye,Gt,Me,Tr,he,Wo=P(()=>{Ie();Ue();_e();fe();ne();xe();Ho=()=>te().replace(/\/$/,""),Go=()=>window.erhData?.nonce||"",Ro={US:"united-states.svg",GB:"united-kingdom.svg",EU:"european-union.svg",CA:"canada.svg",AU:"australia.svg"},ye=[],Vt="name",Ye="asc",Gt="",Me=null,Tr=null,he={};document.querySelector("[data-trackers]")&&(document.readyState==="loading"?document.addEventListener("DOMContentLoaded",qs):qs())});var Xo={};j(Xo,{initOnboarding:()=>Ps});function Ps(){let r=document.querySelector("[data-onboarding-form]");if(!r)return;let e=r.querySelector("[data-onboarding-error]"),t=r.querySelector("[data-onboarding-submit]"),s=document.querySelector("[data-skip-preferences]"),i=r.querySelector("[data-toggle-categories]"),n=r.querySelector("[data-roundup-categories]");if(i&&n){let o=()=>{n.style.display=i.checked?"":"none"};i.addEventListener("change",o),o()}r.addEventListener("submit",async o=>{o.preventDefault();let a=new FormData(r),c=a.get("redirect")||"/";Ko(t,!0),cd(e);let d=[];r.querySelectorAll("input[data-roundup-type]:checked").forEach(l=>{d.push(l.value)});try{let l={price_tracker_emails:a.get("price_tracker_emails")==="on",sales_roundup_emails:a.get("sales_roundup_emails")==="on",newsletter_subscription:a.get("newsletter_subscription")==="on",sales_roundup_frequency:a.get("sales_roundup_frequency")||"weekly",sales_roundup_types:d.length>0?d:["escooter","ebike","eskate","euc","hoverboard"]},h=await fetch(`${zo()}/user/preferences`,{method:"PUT",headers:{"Content-Type":"application/json","X-WP-Nonce":Yo()},credentials:"same-origin",body:JSON.stringify(l)}),u=await h.json();if(!h.ok)throw new Error(u.message||"Failed to save preferences");Z.success("Preferences saved!"),setTimeout(()=>{window.location.href=c},500)}catch(l){ad(e,l.message),Ko(t,!1)}}),s&&s.addEventListener("click",async o=>{o.preventDefault();try{await fetch(`${zo()}/user/preferences`,{method:"PUT",headers:{"Content-Type":"application/json","X-WP-Nonce":Yo()},credentials:"same-origin",body:JSON.stringify({})})}catch{}window.location.href=s.href})}function Ko(r,e){if(!r)return;r.disabled=e;let t=r.querySelector(".btn-text"),s=r.querySelector(".btn-loading");t&&(t.hidden=e),s&&(s.hidden=!e)}function ad(r,e){r&&(r.textContent=e,r.hidden=!1)}function cd(r){r&&(r.textContent="",r.hidden=!0)}var zo,Yo,Jo=P(()=>{Ie();xe();zo=()=>te().replace(/\/$/,""),Yo=()=>window.erhData?.nonce||"";document.readyState==="loading"?document.addEventListener("DOMContentLoaded",Ps):Ps()});var Zo={};j(Zo,{initCompleteProfile:()=>Ds});function Ds(){let r=document.querySelector("[data-complete-profile-form]");if(!r)return;let e=r.querySelector("[data-email-input]"),t=r.querySelector("[data-password-field]"),s=r.querySelector("[data-error]"),i=r.querySelector("[data-submit-btn]"),n=!1,o;e?.addEventListener("input",()=>{clearTimeout(o),c();let l=e.value.trim();if(!l||!l.includes("@")||!l.includes(".")){t.hidden=!0,n=!1;return}o=setTimeout(async()=>{try{n=(await(await fetch(`${Qo()}/auth/check-email`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:l})})).json()).exists,t.hidden=!n,n&&t.querySelector("input")?.focus()}catch{n=!1,t.hidden=!0}},500)}),r.addEventListener("submit",async l=>{l.preventDefault();let h=new FormData(r),u=h.get("state"),p=h.get("provider"),f=h.get("email")?.trim(),m=n?h.get("password"):null;if(!f){a("Please enter your email address.");return}if(n&&!m){a("Please enter your password to link your account.");return}d(!0),c();try{let g=await fetch(`${Qo()}/auth/social/complete`,{method:"POST",headers:{"Content-Type":"application/json","X-WP-Nonce":ld()},credentials:"same-origin",body:JSON.stringify({state:u,provider:p,email:f,password:m})}),y=await g.json();if(!g.ok)throw new Error(y.message||"Something went wrong");Z.success(y.message||"Success!"),setTimeout(()=>{if(y.needsOnboarding){let v=encodeURIComponent(y.redirect||Is()||"/");window.location.href=`${Is()}/email-preferences/?redirect=${v}`}else window.location.href=y.redirect||Is()||"/"},500)}catch(g){a(g.message),d(!1)}});function a(l){s&&(s.textContent=l,s.hidden=!1)}function c(){s&&(s.textContent="",s.hidden=!0)}function d(l){if(!i)return;i.disabled=l;let h=i.querySelector(".btn-text"),u=i.querySelector(".btn-loading");h&&(h.hidden=l),u&&(u.hidden=!l)}}var Qo,Is,ld,ea=P(()=>{Ie();xe();Qo=()=>te().replace(/\/$/,""),Is=()=>window.erhData?.siteUrl||"",ld=()=>window.erhData?.nonce||"";document.readyState==="loading"?document.addEventListener("DOMContentLoaded",Ds):Ds()});function Fs(){let r=document.querySelector(".menu-toggle"),e=document.getElementById("mobile-menu"),t=document.querySelectorAll(".mobile-nav-item[data-has-submenu]"),s=document.body;if(!r||!e)return null;let i=!1,n=null,o=0;function a(u){let p=u.querySelectorAll('button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])'),f=p[0],m=p[p.length-1];function g(y){y.key==="Tab"&&(y.shiftKey?document.activeElement===f&&(m.focus(),y.preventDefault()):document.activeElement===m&&(f.focus(),y.preventDefault()))}return u.addEventListener("keydown",g),()=>u.removeEventListener("keydown",g)}function c(){i=!0,o=window.scrollY,s.style.top=`-${o}px`,r.classList.add("active"),r.setAttribute("aria-expanded","true"),r.setAttribute("aria-label","Close menu"),e.classList.add("active"),s.classList.add("menu-open"),setTimeout(()=>{let u=e.querySelector(".mobile-nav-link");u&&u.focus()},300),n=a(e)}function d(){i=!1,r.classList.remove("active"),r.setAttribute("aria-expanded","false"),r.setAttribute("aria-label","Open menu"),e.classList.remove("active"),s.classList.remove("menu-open"),s.style.top="",window.scrollTo(0,o),t.forEach(u=>{u.classList.remove("expanded");let p=u.querySelector(".mobile-nav-link");p&&p.setAttribute("aria-expanded","false")}),n&&(n(),n=null),r.focus()}function l(){i?d():c()}function h(u){let p=u.classList.contains("expanded"),f=u.querySelector(".mobile-nav-link");t.forEach(m=>{if(m!==u){m.classList.remove("expanded");let g=m.querySelector(".mobile-nav-link");g&&g.setAttribute("aria-expanded","false")}}),p?(u.classList.remove("expanded"),f.setAttribute("aria-expanded","false")):(u.classList.add("expanded"),f.setAttribute("aria-expanded","true"))}return r.addEventListener("click",l),t.forEach(u=>{let p=u.querySelector(".mobile-nav-link");p&&p.addEventListener("click",f=>{f.preventDefault(),h(u)})}),e.addEventListener("touchmove",u=>{let p=e.scrollTop,f=e.scrollHeight,m=e.clientHeight;p===0&&u.touches[0].clientY>0||p+m>=f&&u.touches[0].clientY<0},{passive:!0}),{open:c,close:d,toggle:l,isOpen:()=>i}}Ir();Dr();var Bs=6;function Ns(){let r=document.querySelector(".search-toggle"),e=document.getElementById("search-dropdown"),t=e?.querySelector(".search-input"),s=e?.querySelector(".search-close"),i=document.querySelector(".search-inline"),n=i?.querySelector(".search-inline-input"),o=e?.querySelector(".search-suggestions"),a=e?.querySelector(".search-results-container");if(!r||!e)return null;let c=!1,d=null,l=[],h=-1,u=!1;function p(){u||(u=!0,bt())}function f(E=!0){c=!0,p(),r.setAttribute("aria-expanded","true"),e.classList.add("active"),E&&setTimeout(()=>{t&&t.focus()},100)}function m(){c=!1,r.setAttribute("aria-expanded","false"),e.classList.remove("active"),v()}function g(){c?(m(),r.focus()):f()}function y(){return i&&getComputedStyle(i).display!=="none"?(n&&n.focus(),!0):!1}function v(){a&&(a.innerHTML="",a.classList.remove("active")),o&&(o.style.display=""),l=[],h=-1}function w(){a&&(a.innerHTML=`
            <div class="search-loading">
                <span class="search-loading-spinner"></span>
                <span>Searching...</span>
            </div>
        `,a.classList.add("active"),o&&(o.style.display="none"))}function b(E){a&&(a.innerHTML=`
            <div class="search-no-results">
                No results for "${qe(E)}"
            </div>
        `,a.classList.add("active"),o&&(o.style.display="none"))}function k(E,S){if(!a)return;l=E.slice(0,Bs);let x=E.length,A='<div class="search-results">';if(l.forEach((U,Y)=>{let I=zt(U),K=U.type==="Product"?"search-result-thumb-wrap search-result-thumb-wrap--product":"search-result-thumb-wrap";A+=`
                <a class="search-result" href="${qe(U.url)}" data-index="${Y}">
                    <div class="${K}">
                        <img class="search-result-thumb" src="${qe(U.thumbnail)}" alt="" loading="lazy">
                    </div>
                    <div class="search-result-content">
                        <span class="search-result-title">${q(U.title,S)}</span>
                        <span class="search-result-meta">
                            <span class="search-result-type">${qe(I.label)}</span>
                        </span>
                    </div>
                </a>
            `}),x>Bs){let Y=`${window.erhData?.siteUrl||""}/search/?q=${encodeURIComponent(S)}`;A+=`
                <a class="search-results-footer btn btn-secondary btn-sm" href="${Y}">
                    View all ${x} results
                </a>
            `}A+="</div>",a.innerHTML=A,a.classList.add("active"),o&&(o.style.display="none"),h=-1}function q(E,S){if(!S)return qe(E);let x=S.toLowerCase().split(/\s+/).filter(U=>U.length>0),A=E;return x.forEach(U=>{let Y=new RegExp(`(${_s(U)})`,"gi");A=A.replace(Y,"<mark>$1</mark>")}),A}async function G(E){if(!E||E.length<2){v();return}w();try{let S=await wt(E);S.length===0?b(E):k(S,E)}catch(S){console.error("[Search] Error:",S),b(E)}}function ee(E){clearTimeout(d),d=setTimeout(()=>G(E),200)}function re(E){let S=a?.querySelectorAll(".search-result");!S||S.length===0||(S.forEach(x=>x.classList.remove("selected")),E<0&&(E=S.length-1),E>=S.length&&(E=0),h=E,S[h]?.classList.add("selected"),S[h]?.scrollIntoView({block:"nearest"}))}function M(E){let S=l.length>0;switch(E.key){case"ArrowDown":S&&(E.preventDefault(),re(h+1));break;case"ArrowUp":S&&(E.preventDefault(),re(h-1));break;case"Enter":if(h>=0&&l[h])E.preventDefault(),window.location.href=l[h].url;else if(E.target.value?.trim()){E.preventDefault();let x=window.erhData?.siteUrl||"";window.location.href=`${x}/search/?q=${encodeURIComponent(E.target.value.trim())}`}break;case"Escape":c&&(E.preventDefault(),m(),r.focus());break}}return r.addEventListener("click",g),s&&s.addEventListener("click",()=>{m(),r.focus()}),t&&(t.addEventListener("input",E=>{let S=E.target.value;n&&(n.value=S),ee(S)}),t.addEventListener("keydown",M)),n&&(n.addEventListener("input",E=>{let S=E.target.value;S.length>=2&&!c&&(f(!1),t&&(t.value=S)),ee(S)}),n.addEventListener("keydown",M),n.addEventListener("focus",()=>{p();let E=n.value;E.length>=2&&(f(!1),t&&(t.value=E),G(E))})),document.addEventListener("click",E=>{c&&!e.contains(E.target)&&!r.contains(E.target)&&!i?.contains(E.target)&&m()}),{open:f,close:m,toggle:g,focusInlineSearch:y,isOpen:()=>c}}function Os(){let r=document.querySelectorAll(".nav-item[data-dropdown]");if(!r.length)return null;let e=null;function t(n){let o=n.querySelector(".nav-link"),a=n.querySelector(".dropdown");e&&e!==n&&s(e),n.classList.add("is-open"),o.setAttribute("aria-expanded","true"),e=n;let c=a.querySelector('a[role="menuitem"]');c&&setTimeout(()=>c.focus(),50)}function s(n){let o=n.querySelector(".nav-link");n.classList.remove("is-open"),o.setAttribute("aria-expanded","false"),e===n&&(e=null)}function i(){r.forEach(n=>{s(n)})}return r.forEach(n=>{let o=n.querySelector(".nav-link"),a=n.querySelector(".dropdown");o.addEventListener("click",c=>{c.preventDefault(),n.classList.contains("is-open")?(s(n),o.focus()):t(n)}),a.addEventListener("keydown",c=>{let d=a.querySelectorAll('a[role="menuitem"]'),l=Array.from(d).indexOf(document.activeElement);switch(c.key){case"ArrowDown":c.preventDefault(),l<d.length-1?d[l+1].focus():d[0].focus();break;case"ArrowUp":c.preventDefault(),l>0?d[l-1].focus():d[d.length-1].focus();break;case"Escape":c.preventDefault(),s(n),o.focus();break;case"Tab":(c.shiftKey&&l===0||!c.shiftKey&&l===d.length-1)&&s(n);break;case"Home":c.preventDefault(),d[0].focus();break;case"End":c.preventDefault(),d[d.length-1].focus();break}}),n.addEventListener("mouseleave",()=>{setTimeout(()=>{n.contains(document.activeElement)||s(n)},100)})}),document.addEventListener("click",n=>{e&&!e.contains(n.target)&&i()}),{closeAll:i,getActive:()=>e}}Fr();function Rs(){let r=document.querySelector(".header");if(!r||document.querySelector("[data-compare-page]"))return null;let e=0,t=!1,s=10,i=200,n=300,o=!1;function a(){if(o){t=!1;return}if(document.body.classList.contains("menu-open")){t=!1;return}let d=window.scrollY,l=r.classList.contains("header--fixed"),h=r.classList.contains("header--hidden"),u=l&&!h;if(d<=0){l&&(r.classList.remove("header--scrolled"),o=!0,setTimeout(()=>{r.classList.remove("header--fixed"),r.classList.remove("header--hidden"),document.body.classList.remove("header-is-fixed"),o=!1},n)),e=d,t=!1;return}if(d<i){l&&h&&(r.classList.remove("header--fixed"),r.classList.remove("header--hidden"),r.classList.remove("header--scrolled"),document.body.classList.remove("header-is-fixed")),e=d,t=!1;return}l||(r.classList.add("header--no-transition"),r.classList.add("header--hidden"),r.classList.add("header--fixed"),r.classList.add("header--scrolled"),document.body.classList.add("header-is-fixed"),requestAnimationFrame(()=>{r.classList.remove("header--no-transition")}));let p=d-e;if(Math.abs(p)<s){t=!1;return}p>0?r.classList.add("header--hidden"):p<0&&r.classList.remove("header--hidden"),e=d,t=!1}function c(){t||(requestAnimationFrame(a),t=!0)}return window.addEventListener("scroll",c,{passive:!0}),a(),{destroy(){window.removeEventListener("scroll",c)}}}ne();Ue();Ie();var Hr={US:{label:"United States (USD)",flag:"united-states.svg"},GB:{label:"United Kingdom (GBP)",flag:"united-kingdom.svg"},EU:{label:"Europe (EUR)",flag:"european-union.svg"},CA:{label:"Canada (CAD)",flag:"canada.svg"},AU:{label:"Australia (AUD)",flag:"australia.svg"}};function Ws(){let r=document.querySelector("[data-region-picker-wrapper]"),e=document.querySelector("[data-region-picker-trigger]"),t=document.querySelector("[data-region-picker]");!r||!e||!t||(z().then(({geo:s})=>{va(s)}),e.addEventListener("click",s=>{s.stopPropagation();let i=!t.hidden;t.hidden=i,e.setAttribute("aria-expanded",String(!i))}),document.addEventListener("click",s=>{r.contains(s.target)||(t.hidden=!0,e.setAttribute("aria-expanded","false"))}),document.addEventListener("keydown",s=>{s.key==="Escape"&&!t.hidden&&(t.hidden=!0,e.setAttribute("aria-expanded","false"),e.focus())}),t.addEventListener("click",async s=>{let i=s.target.closest("[data-region]");if(!i)return;let n=i.dataset.region;t.hidden=!0,e.setAttribute("aria-expanded","false"),ga()?ya(n):await zs(n)}))}function ga(){return window.erhData?.isLoggedIn?window.erhData?.user?.preferences?.sales_roundup_emails===!0:!1}function ya(r){let e=Hr[r]?.label||r,t=le.create({id:"region-change-confirm",title:"Change your region?",content:`
            <p class="modal-text">
                You have deal digest emails enabled. Changing your region to
                <strong>${e}</strong> will also update
                which deals you receive in your email digest.
            </p>
        `,size:"sm",footerContent:`
            <button type="button" class="btn btn-secondary" data-modal-close>Cancel</button>
            <button type="button" class="btn btn-primary" data-confirm-region="${r}">
                Change Region
            </button>
        `}),s=t.element.querySelector("[data-confirm-region]");s&&s.addEventListener("click",async()=>{s.disabled=!0,s.textContent="Updating...",await zs(r),t.close()})}async function zs(r){(await Qt(r)).success?(Z.success("Region updated"),setTimeout(()=>{window.location.reload()},500)):Z.error("Failed to update region. Please try again.")}function va(r){let e=document.querySelector("[data-current-region]"),t=document.querySelector("[data-current-flag]"),s=Hr[r]||Hr.US;if(e&&(e.textContent=s.label),t&&window.erhData?.themeUrl){let i=window.erhData.themeUrl+"/assets/images/countries/";t.src=i+s.flag}}er();Ue();var de={showDelay:200,hideDelay:100,offset:8,viewportPadding:12,animationDuration:150},J=null,Je=null,tr=null,rr=null,Gr=!1;function Ks(){J||(J=document.createElement("div"),J.className="tooltip",J.setAttribute("role","tooltip"),J.setAttribute("aria-hidden","true"),J.innerHTML='<div class="tooltip-content"></div><div class="tooltip-arrow"></div>',document.body.appendChild(J)),document.addEventListener("mouseenter",xa,!0),document.addEventListener("mouseleave",ka,!0),document.addEventListener("focusin",Ca,!0),document.addEventListener("focusout",$a,!0),document.addEventListener("click",Aa,!0),document.addEventListener("touchstart",qa,{passive:!0}),window.addEventListener("scroll",Re,{passive:!0,capture:!0}),window.addEventListener("resize",Re,{passive:!0}),document.addEventListener("keydown",Ta)}function lt(r){return r.getAttribute("data-tooltip-trigger")==="click"||r.closest(".info-trigger")!==null}function xa(r){if(!r.target.closest)return;let e=r.target.closest("[data-tooltip]");e&&!lt(e)&&Xs(e)}function ka(r){if(!r.target.closest)return;let e=r.target.closest("[data-tooltip]");e&&!lt(e)&&Js()}function Ca(r){if(!r.target.closest)return;let e=r.target.closest("[data-tooltip]");e&&!lt(e)&&Xs(e)}function $a(r){if(!r.target.closest)return;let e=r.target.closest("[data-tooltip]");e&&!lt(e)&&Js()}function Aa(r){if(Gr||!r.target.closest)return;let e=r.target.closest("[data-tooltip]");e&&lt(e)?(r.preventDefault(),r.stopPropagation(),Je===e&&J.classList.contains("is-visible")?Re():Vr(e)):J&&J.classList.contains("is-visible")&&lt(Je)&&Re()}function qa(r){if(!r.target.closest)return;let e=r.target.closest("[data-tooltip]");Gr=!0,setTimeout(()=>{Gr=!1},300),e?Je===e&&J.classList.contains("is-visible")?Re():Vr(e):J&&J.classList.contains("is-visible")&&Re()}function Ta(r){r.key==="Escape"&&J.classList.contains("is-visible")&&Re()}function Xs(r){clearTimeout(rr),clearTimeout(tr),tr=setTimeout(()=>{Vr(r)},de.showDelay)}function Js(){clearTimeout(tr),clearTimeout(rr),rr=setTimeout(()=>{Re()},de.hideDelay)}function Vr(r){if(!J||!r)return;let e=r.getAttribute("data-tooltip");if(!e)return;Je=r;let t=J.querySelector(".tooltip-content");t.textContent=e;let s="tooltip-"+Math.random().toString(36).substr(2,9);J.id=s,r.setAttribute("aria-describedby",s);let i=r.getAttribute("data-tooltip-position")||"top";J.style.visibility="hidden",J.classList.add("is-visible"),J.setAttribute("aria-hidden","false");let n=Pa(r,i);J.style.left=`${n.x}px`,J.style.top=`${n.y}px`,J.setAttribute("data-position",n.placement);let o=J.querySelector(".tooltip-arrow");o&&(n.arrowOffset?o.style.setProperty("--arrow-offset",`${n.arrowOffset}px`):o.style.removeProperty("--arrow-offset")),J.style.visibility=""}function Re(){J&&(clearTimeout(tr),clearTimeout(rr),J.classList.remove("is-visible"),J.setAttribute("aria-hidden","true"),Je&&(Je.removeAttribute("aria-describedby"),Je=null))}function Pa(r,e){let t=r.getBoundingClientRect(),s=J.getBoundingClientRect(),i=window.scrollX,n=window.scrollY,o={width:window.innerWidth,height:window.innerHeight},a={top:{x:t.left+(t.width-s.width)/2,y:t.top-s.height-de.offset},bottom:{x:t.left+(t.width-s.width)/2,y:t.bottom+de.offset},left:{x:t.left-s.width-de.offset,y:t.top+(t.height-s.height)/2},right:{x:t.right+de.offset,y:t.top+(t.height-s.height)/2}};function c(f,m){let g=f.x,y=f.y;return m==="top"||m==="bottom"?y>=de.viewportPadding&&y+s.height<=o.height-de.viewportPadding&&g>=de.viewportPadding&&g+s.width<=o.width-de.viewportPadding:g>=de.viewportPadding&&g+s.width<=o.width-de.viewportPadding&&y>=de.viewportPadding&&y+s.height<=o.height-de.viewportPadding}let d=e,l,h;if(c(a[e],e))l=a[e].x,h=a[e].y;else{let m={top:"bottom",bottom:"top",left:"right",right:"left"}[e];if(c(a[m],m))d=m,l=a[m].x,h=a[m].y;else{let g=e==="top"||e==="bottom"?["left","right"]:["top","bottom"],y=!1;for(let v of g)if(c(a[v],v)){d=v,l=a[v].x,h=a[v].y,y=!0;break}y||(l=a[e].x,h=a[e].y,l=Math.max(de.viewportPadding,Math.min(l,o.width-s.width-de.viewportPadding)),h=Math.max(de.viewportPadding,Math.min(h,o.height-s.height-de.viewportPadding)))}}let u=0;if(d==="top"||d==="bottom"){let f=t.left+t.width/2,m=l+s.width/2;u=f-m}else{let f=t.top+t.height/2,m=h+s.height/2;u=f-m}let p=Math.abs(u)>1?u:0;return{x:l+i,y:h+n,placement:d,arrowOffset:p}}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",Ks):Ks();Ie();Ie();(function(){"use strict";let r=Fs(),e=Ns(),t=Os(),s=Yt(),i=Rs();Ws();let n=new URLSearchParams(window.location.search).get("linked");if(n){let l=n.charAt(0).toUpperCase()+n.slice(1);Z.success(`Your ${l} account has been linked.`);let h=window.location.pathname+window.location.hash;window.history.replaceState({},"",h)}(document.querySelector("[data-gallery] .gallery-thumbs")||document.querySelector("[data-gallery] .gallery-video-card"))&&Promise.resolve().then(()=>(zr(),Zs)),document.querySelector("[data-price-intel], [data-alternatives], [data-successor]")&&Promise.resolve().then(()=>(fi(),pi)),document.querySelector("[data-erh-chart]")&&Promise.resolve().then(()=>(ir(),ri)).then(l=>{l.default.autoInit()}),document.querySelector(".sticky-buy-bar")&&Promise.resolve().then(()=>(Ei(),Si)).then(l=>{l.default.init()}),document.querySelector(".toc")&&Promise.resolve().then(()=>(Ci(),ki)).then(l=>{l.initToc(".toc",{offset:100})}),document.querySelector("[data-archive-filters]")&&Promise.resolve().then(()=>(Ai(),$i)),document.querySelector("[data-archive-sort]")&&Promise.resolve().then(()=>(Ti(),qi)),document.querySelector("[data-search-page]")&&Promise.resolve().then(()=>(Ii(),Pi)).then(l=>{l.initSearchPage()}),document.querySelector("[data-calculator]")&&Promise.resolve().then(()=>(Xi(),Ki)).then(l=>{l.initCalculator()}),document.querySelector("[data-contact-form]")&&Promise.resolve().then(()=>(Qi(),Ji)).then(l=>{l.initContactForm()}),document.querySelector(".finder-tabs")&&Promise.resolve().then(()=>(en(),Zi)).then(l=>{l.initFinderTabs()}),document.querySelector("[data-finder-page]")&&Promise.resolve().then(()=>(nn(),sn)).then(l=>{l.initFinder()}),document.getElementById("deals-section")&&Promise.resolve().then(()=>(ln(),cn)).then(l=>{l.initDeals()}),document.querySelector(".hub-deals-tabs")&&Promise.resolve().then(()=>(un(),dn)).then(l=>{l.initDealsTabs({tabsSelector:".hub-deals-tabs",gridSelector:".hub-deals-grid",carouselSelector:".hub-deals-carousel",filterType:"price",filterAttribute:"price"})}),document.querySelector("[data-deals-page]")&&Promise.resolve().then(()=>(fn(),pn)).then(l=>{l.initDealsPage()}),document.querySelector("[data-deals-hub]")&&Promise.resolve().then(()=>(yn(),gn)).then(l=>{l.initDealsHub()}),document.getElementById("comparison-container")&&Promise.resolve().then(()=>(tt(),et)).then(l=>{l.initComparison({containerId:"comparison-container",rightColumnId:"comparison-right-column",submitBtnId:"comparison-submit",categoryPillId:"comparison-category-pill",categoryTextId:"comparison-category-text",categoryClearId:"comparison-category-clear",announcerId:"comparison-announcer",wrapperClass:"comparison-input-wrapper",showCategoryInResults:!0})}),document.getElementById("hub-comparison-container")&&Promise.resolve().then(()=>(tt(),et)).then(l=>{l.initComparison({containerId:"hub-comparison-container",rightColumnId:"hub-comparison-right",submitBtnId:"hub-comparison-submit",categoryPillId:"hub-category-pill",categoryTextId:"hub-category-text",categoryClearId:"hub-category-clear",announcerId:"hub-comparison-announcer",showCategoryInResults:!0,allowDynamicInputs:!0})}),document.getElementById("category-comparison-container")&&Promise.resolve().then(()=>(tt(),et)).then(l=>{let u=document.getElementById("category-comparison-container")?.dataset.categoryFilter||null;l.initComparison({containerId:"category-comparison-container",rightColumnId:"category-comparison-right",submitBtnId:"category-comparison-submit",announcerId:"category-comparison-announcer",categoryFilter:u,showCategoryInResults:!1,allowDynamicInputs:!0})}),document.getElementById("sidebar-comparison")&&Promise.resolve().then(()=>(tt(),et)).then(l=>{let u=document.getElementById("sidebar-comparison")?.dataset.lockedCategory||null;l.initComparison({containerId:"sidebar-comparison",inputsContainerId:"sidebar-comparison-inputs",submitBtnId:"sidebar-comparison-submit",announcerId:"sidebar-comparison-announcer",wrapperClass:"comparison-input-wrapper",categoryFilter:u,showCategoryInResults:!1,allowDynamicInputs:!0})});let o=document.querySelectorAll(".sidebar-comparison--open");if(o.length>0&&Promise.resolve().then(()=>(tt(),et)).then(l=>{o.forEach(h=>{l.initComparison({containerId:h.id,submitBtnSelector:".sidebar-comparison-btn",announcerSelector:'[aria-live="polite"]',wrapperClass:"comparison-input-wrapper",showCategoryInResults:!0,allowDynamicInputs:!1})})}),document.querySelector("[data-compare-page]")&&Promise.resolve().then(()=>(yo(),go)).then(l=>{l.init()}),document.querySelector("[data-product-page]")){Promise.resolve().then(()=>(Lo(),Eo)).then(h=>{});let l=document.querySelector("[data-product-comparison]");l&&Promise.resolve().then(()=>(tt(),et)).then(h=>{let u=l.dataset.lockedCategory||null;h.initComparison({containerId:null,containerSelector:"[data-product-comparison]",submitBtnSelector:"[data-compare-submit]",announcerSelector:"[data-comparison-announcer]",wrapperClass:"comparison-input-wrapper",categoryFilter:u,showCategoryInResults:!1,allowDynamicInputs:!1})})}document.querySelector("[data-similar-products]")&&Promise.resolve().then(()=>(Ao(),$o)).then(l=>{l.initSimilarProducts()}),document.querySelector("[data-listicle-item]")&&Promise.resolve().then(()=>(Po(),To)).then(l=>{l.initListicleItems()}),document.querySelector("[data-buying-guide-table]")&&Promise.resolve().then(()=>(Do(),Io)).then(l=>{l.initBuyingGuideTables()}),document.querySelector(".account-page")&&(Promise.resolve().then(()=>Fo()),Promise.resolve().then(()=>Uo()),Promise.resolve().then(()=>(Wo(),jo))),document.querySelector("[data-onboarding]")&&Promise.resolve().then(()=>(Jo(),Xo)),document.querySelector("[data-complete-profile]")&&Promise.resolve().then(()=>(ea(),Zo)),document.addEventListener("keydown",l=>{l.key==="Escape"&&(e?.isOpen()&&(e.close(),document.querySelector(".search-toggle")?.focus()),r?.isOpen()&&r.close()),(l.metaKey||l.ctrlKey)&&l.key==="k"&&(l.preventDefault(),e?.focusInlineSearch()||e?.isOpen()||e?.toggle())});let a;window.addEventListener("resize",()=>{clearTimeout(a),a=setTimeout(()=>{window.innerWidth>820&&r?.isOpen()&&r.close(),window.innerWidth>960&&e?.isOpen()&&e.close()},100)});let c=document.querySelector(".search-toggle"),d=document.querySelector(".menu-toggle");c&&r&&c.addEventListener("click",()=>{r.isOpen()&&r.close()}),d&&e&&d.addEventListener("click",()=>{e.isOpen()&&e.close()})})();
